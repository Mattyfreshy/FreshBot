2023-06-01 20:35:33,617: root: INFO: FreshTrading : Executing the initialize lifecycle method
2023-06-01 20:35:34,258: root: INFO: Current backtesting datetime 2020-01-02 08:30:00-05:00
2023-06-01 20:35:34,259: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,259: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,259: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,260: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,260: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,267: root: ERROR: 'Close'
2023-06-01 20:35:34,270: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,270: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,271: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,271: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,271: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,272: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,272: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,272: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,272: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,273: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,273: root: ERROR: 'Close'
2023-06-01 20:35:34,273: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,273: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,274: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,274: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,274: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,274: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,275: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,275: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,275: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,275: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,276: root: ERROR: 'Close'
2023-06-01 20:35:34,276: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,276: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,276: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,276: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,277: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,277: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,278: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,278: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,278: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,278: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,278: root: ERROR: 'Close'
2023-06-01 20:35:34,279: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,279: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,279: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,279: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,280: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,280: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,280: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,280: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,281: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,281: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,282: root: ERROR: 'Close'
2023-06-01 20:35:34,282: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,282: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,282: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,283: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,283: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,283: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,284: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,284: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,284: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,284: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,285: root: ERROR: 'Close'
2023-06-01 20:35:34,285: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,285: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,286: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,287: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,287: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,287: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,288: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,288: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,288: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,288: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,289: root: ERROR: 'Close'
2023-06-01 20:35:34,289: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,289: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,290: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,290: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,290: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,290: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,291: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,291: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,291: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,291: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,292: root: ERROR: 'Close'
2023-06-01 20:35:34,292: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,292: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,292: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,292: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,293: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,293: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,293: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,293: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,294: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,294: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,294: root: ERROR: 'Close'
2023-06-01 20:35:34,295: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,295: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,295: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,295: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,296: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,296: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,296: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,296: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,297: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,297: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,297: root: ERROR: 'Close'
2023-06-01 20:35:34,298: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,298: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,298: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,299: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,299: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,299: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,300: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,300: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,300: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,300: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,301: root: ERROR: 'Close'
2023-06-01 20:35:34,301: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,301: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,302: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,302: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,302: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,303: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,303: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,303: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,303: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,304: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,304: root: ERROR: 'Close'
2023-06-01 20:35:34,304: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,304: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,305: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,305: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,305: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,306: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,306: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,306: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,306: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,307: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,307: root: ERROR: 'Close'
2023-06-01 20:35:34,307: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,307: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,308: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,308: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,308: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,308: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,309: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,309: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,309: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,309: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,310: root: ERROR: 'Close'
2023-06-01 20:35:34,310: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,310: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,311: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,311: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,311: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,311: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,312: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,312: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,312: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,312: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,313: root: ERROR: 'Close'
2023-06-01 20:35:34,313: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,313: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,313: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,313: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,314: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,314: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,315: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,315: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,315: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,315: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,316: root: ERROR: 'Close'
2023-06-01 20:35:34,316: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,316: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,317: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,317: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,317: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,318: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,318: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,318: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,319: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,319: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,319: root: ERROR: 'Close'
2023-06-01 20:35:34,320: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,320: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,320: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,320: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,321: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,321: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,321: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,321: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,322: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,322: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,322: root: ERROR: 'Close'
2023-06-01 20:35:34,322: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,323: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,323: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,323: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,323: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,324: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,324: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,324: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,324: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,325: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,325: root: ERROR: 'Close'
2023-06-01 20:35:34,325: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,325: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,326: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,326: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,326: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,327: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,327: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,327: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,327: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,327: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,328: root: ERROR: 'Close'
2023-06-01 20:35:34,328: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,328: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,329: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,329: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,329: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,329: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,330: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,330: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,330: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,330: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,331: root: ERROR: 'Close'
2023-06-01 20:35:34,331: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,331: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,332: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,332: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,332: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,332: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,333: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,333: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,333: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,333: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,334: root: ERROR: 'Close'
2023-06-01 20:35:34,334: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,334: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,335: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,335: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,336: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,336: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,337: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,337: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,337: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,337: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,338: root: ERROR: 'Close'
2023-06-01 20:35:34,338: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,338: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,339: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,339: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,339: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,339: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,340: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,340: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,340: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,340: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,341: root: ERROR: 'Close'
2023-06-01 20:35:34,341: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,341: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,342: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,342: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,342: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,342: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,343: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,343: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,343: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,343: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,344: root: ERROR: 'Close'
2023-06-01 20:35:34,344: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,345: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,345: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,345: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,346: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,346: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,346: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,346: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,347: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,347: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,348: root: ERROR: 'Close'
2023-06-01 20:35:34,348: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,348: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,349: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,349: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,349: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,350: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,350: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,350: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,350: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,351: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,351: root: ERROR: 'Close'
2023-06-01 20:35:34,352: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,352: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,353: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,353: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,353: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,353: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,354: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,354: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,354: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,354: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,355: root: ERROR: 'Close'
2023-06-01 20:35:34,355: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,355: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,356: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,356: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,356: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,356: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,357: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,357: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,357: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,357: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,358: root: ERROR: 'Close'
2023-06-01 20:35:34,358: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,358: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,358: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,358: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,359: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,359: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,359: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,359: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,360: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,360: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,360: root: ERROR: 'Close'
2023-06-01 20:35:34,360: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,361: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,361: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,361: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,362: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,362: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,362: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,362: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,363: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,363: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,363: root: ERROR: 'Close'
2023-06-01 20:35:34,363: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,364: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,364: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,364: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,364: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,365: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,365: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,365: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,366: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,366: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,366: root: ERROR: 'Close'
2023-06-01 20:35:34,366: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,367: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,367: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,367: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,368: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,368: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,369: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,369: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,369: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,369: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,370: root: ERROR: 'Close'
2023-06-01 20:35:34,370: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,370: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,370: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,371: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,371: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,371: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,372: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,372: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,372: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,372: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,373: root: ERROR: 'Close'
2023-06-01 20:35:34,373: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,373: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,373: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,373: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,374: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,374: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,374: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,375: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,375: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,375: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,375: root: ERROR: 'Close'
2023-06-01 20:35:34,376: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,376: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,376: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,376: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,377: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,377: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,377: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,377: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,378: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,378: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,378: root: ERROR: 'Close'
2023-06-01 20:35:34,378: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,378: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,379: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,379: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,379: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,380: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,380: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,380: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,380: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,380: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,381: root: ERROR: 'Close'
2023-06-01 20:35:34,381: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,381: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,382: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,382: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,382: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,383: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,383: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,383: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,383: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,384: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,384: root: ERROR: 'Close'
2023-06-01 20:35:34,384: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,385: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,385: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,385: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,386: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,386: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,387: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,387: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,387: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,387: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,388: root: ERROR: 'Close'
2023-06-01 20:35:34,388: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,388: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,389: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,389: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,389: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,389: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,390: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,390: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,390: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,390: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,391: root: ERROR: 'Close'
2023-06-01 20:35:34,391: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,391: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,391: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,392: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,392: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,392: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,393: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,393: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,393: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,393: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,394: root: ERROR: 'Close'
2023-06-01 20:35:34,394: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,394: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,394: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,394: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,395: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,395: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,395: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,395: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,396: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,396: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,396: root: ERROR: 'Close'
2023-06-01 20:35:34,396: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,397: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,397: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,397: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,397: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,398: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,398: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,398: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,398: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,399: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,399: root: ERROR: 'Close'
2023-06-01 20:35:34,399: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,399: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,400: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,400: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,401: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,401: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,401: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,402: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,402: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,402: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,403: root: ERROR: 'Close'
2023-06-01 20:35:34,403: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,403: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,403: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,403: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,404: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,404: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,404: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,404: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,405: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,405: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,405: root: ERROR: 'Close'
2023-06-01 20:35:34,406: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,406: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,406: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,406: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,406: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,407: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,407: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,407: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,407: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,408: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,408: root: ERROR: 'Close'
2023-06-01 20:35:34,408: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,408: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,409: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,409: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,409: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,409: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,410: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,410: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,410: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,410: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,411: root: ERROR: 'Close'
2023-06-01 20:35:34,411: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,411: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,412: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,412: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,412: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,412: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,413: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,413: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,413: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,413: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,414: root: ERROR: 'Close'
2023-06-01 20:35:34,414: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,414: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,415: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,415: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,415: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,416: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,416: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,416: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,416: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,416: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,417: root: ERROR: 'Close'
2023-06-01 20:35:34,417: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,417: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,418: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,418: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,418: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,419: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,419: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,419: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,419: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,420: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,420: root: ERROR: 'Close'
2023-06-01 20:35:34,420: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,420: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,421: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,421: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,421: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,422: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,422: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,422: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,422: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,422: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,423: root: ERROR: 'Close'
2023-06-01 20:35:34,423: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,423: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,424: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,424: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,424: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,424: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,425: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,425: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,425: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,425: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,426: root: ERROR: 'Close'
2023-06-01 20:35:34,426: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,426: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,426: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,427: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,427: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,427: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,428: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,428: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,428: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,428: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,429: root: ERROR: 'Close'
2023-06-01 20:35:34,429: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,429: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,429: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,429: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,430: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,430: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,430: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,430: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,431: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,431: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,431: root: ERROR: 'Close'
2023-06-01 20:35:34,432: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,432: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,433: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,433: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,433: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,434: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,434: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,434: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,434: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,435: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,435: root: ERROR: 'Close'
2023-06-01 20:35:34,435: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,435: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,436: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,436: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,436: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,437: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,437: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,437: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,437: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,437: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,438: root: ERROR: 'Close'
2023-06-01 20:35:34,438: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,438: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,439: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,439: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,439: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,439: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,440: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,440: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,440: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,440: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,441: root: ERROR: 'Close'
2023-06-01 20:35:34,441: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,441: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,441: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,441: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,442: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,442: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,442: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,442: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,443: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,443: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,443: root: ERROR: 'Close'
2023-06-01 20:35:34,443: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,444: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,444: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,444: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,444: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,445: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,445: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,445: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,445: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,445: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,446: root: ERROR: 'Close'
2023-06-01 20:35:34,446: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,446: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,447: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,447: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,447: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,447: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,448: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,448: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,448: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,448: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,449: root: ERROR: 'Close'
2023-06-01 20:35:34,449: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,449: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,450: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,450: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,451: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,451: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,451: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,452: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,452: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,452: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,453: root: ERROR: 'Close'
2023-06-01 20:35:34,453: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,453: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,453: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,453: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,454: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,454: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,455: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,455: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,455: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,455: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,455: root: ERROR: 'Close'
2023-06-01 20:35:34,456: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,456: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,456: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,456: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,457: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,457: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,457: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,457: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,458: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,458: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,458: root: ERROR: 'Close'
2023-06-01 20:35:34,458: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,459: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,459: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,459: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,460: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,460: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,460: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,460: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,461: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,461: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,461: root: ERROR: 'Close'
2023-06-01 20:35:34,461: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,461: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,462: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,462: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,462: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,462: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,463: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,463: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,463: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,463: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,464: root: ERROR: 'Close'
2023-06-01 20:35:34,464: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,464: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,465: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,465: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,465: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,466: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,466: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,466: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,466: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,467: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,467: root: ERROR: 'Close'
2023-06-01 20:35:34,468: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,468: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,469: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,469: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,469: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,470: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,470: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,470: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,470: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,470: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,471: root: ERROR: 'Close'
2023-06-01 20:35:34,471: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,471: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,472: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,472: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,472: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,472: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,473: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,473: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,473: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,473: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,474: root: ERROR: 'Close'
2023-06-01 20:35:34,474: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,474: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,475: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,475: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,475: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,475: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,476: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,476: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,476: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,476: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,477: root: ERROR: 'Close'
2023-06-01 20:35:34,477: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,477: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,477: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,477: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,478: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,478: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,479: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,479: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,479: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,479: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,482: root: ERROR: 'Close'
2023-06-01 20:35:34,483: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,485: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,487: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,487: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,488: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,489: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,489: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,489: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,490: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,490: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,491: root: ERROR: 'Close'
2023-06-01 20:35:34,491: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,491: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,492: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,492: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,493: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,493: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,493: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,493: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,494: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,494: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,495: root: ERROR: 'Close'
2023-06-01 20:35:34,495: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,496: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,496: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,496: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,497: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,497: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,498: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,498: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,498: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,498: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,499: root: ERROR: 'Close'
2023-06-01 20:35:34,499: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,502: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,503: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,503: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,504: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,504: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,504: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,504: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,505: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,505: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,506: root: ERROR: 'Close'
2023-06-01 20:35:34,506: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,508: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,509: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,509: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,509: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,509: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,510: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,510: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,510: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,510: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,511: root: ERROR: 'Close'
2023-06-01 20:35:34,511: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,513: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,514: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,514: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,514: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,515: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,515: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,515: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,516: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,516: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,517: root: ERROR: 'Close'
2023-06-01 20:35:34,517: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,519: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,520: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,520: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,520: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,521: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,521: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,521: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,521: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,522: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,522: root: ERROR: 'Close'
2023-06-01 20:35:34,523: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,524: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,525: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,525: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,525: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,526: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,526: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,526: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,526: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,527: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,527: root: ERROR: 'Close'
2023-06-01 20:35:34,527: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,528: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,528: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,528: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,529: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,529: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,530: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,530: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,530: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,530: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,531: root: ERROR: 'Close'
2023-06-01 20:35:34,531: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,532: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,534: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,535: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,537: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,538: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,538: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,538: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,539: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,539: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,539: root: ERROR: 'Close'
2023-06-01 20:35:34,540: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,540: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,541: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,541: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,541: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,542: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,542: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,542: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,542: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,543: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,543: root: ERROR: 'Close'
2023-06-01 20:35:34,543: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,544: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,544: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,544: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,545: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,545: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,545: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,545: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,546: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,546: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,546: root: ERROR: 'Close'
2023-06-01 20:35:34,546: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,547: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,547: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,547: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,547: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,548: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,548: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,548: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,548: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,549: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,549: root: ERROR: 'Close'
2023-06-01 20:35:34,549: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,549: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,550: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,550: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,550: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,551: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,551: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,551: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,552: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,552: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,553: root: ERROR: 'Close'
2023-06-01 20:35:34,553: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,553: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,554: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,554: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,554: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,554: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,555: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,555: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,555: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,555: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,556: root: ERROR: 'Close'
2023-06-01 20:35:34,556: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,556: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,556: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,556: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,557: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,557: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,557: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,557: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,558: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,558: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,558: root: ERROR: 'Close'
2023-06-01 20:35:34,559: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,559: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,559: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,559: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,559: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,560: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,560: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,560: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,560: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,561: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,561: root: ERROR: 'Close'
2023-06-01 20:35:34,561: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,561: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,562: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,562: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,562: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,562: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,563: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,563: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,563: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,563: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,564: root: ERROR: 'Close'
2023-06-01 20:35:34,564: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,564: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,565: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,565: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,565: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,566: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,566: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,566: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,566: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,567: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,567: root: ERROR: 'Close'
2023-06-01 20:35:34,567: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,568: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,568: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,568: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,569: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,569: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,569: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,569: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,570: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,570: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,570: root: ERROR: 'Close'
2023-06-01 20:35:34,570: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,571: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,571: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,571: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,571: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,572: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,572: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,572: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,572: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,572: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,573: root: ERROR: 'Close'
2023-06-01 20:35:34,573: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,573: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,574: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,574: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,574: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,574: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,575: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,575: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,575: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,575: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,576: root: ERROR: 'Close'
2023-06-01 20:35:34,576: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,576: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,576: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,577: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,577: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,577: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,578: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,578: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,578: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,578: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,579: root: ERROR: 'Close'
2023-06-01 20:35:34,579: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,579: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,579: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,579: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,580: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,580: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,581: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,581: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,581: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,581: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,582: root: ERROR: 'Close'
2023-06-01 20:35:34,582: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,582: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,582: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,582: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,583: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,583: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,584: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,584: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,584: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,584: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,585: root: ERROR: 'Close'
2023-06-01 20:35:34,585: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,585: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,586: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,586: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,586: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,587: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,587: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,587: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,587: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,588: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,588: root: ERROR: 'Close'
2023-06-01 20:35:34,588: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,588: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,589: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,589: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,589: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,589: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,590: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,590: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,590: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,590: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,591: root: ERROR: 'Close'
2023-06-01 20:35:34,591: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,591: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,591: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,591: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,592: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,592: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,592: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,592: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,593: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,593: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,593: root: ERROR: 'Close'
2023-06-01 20:35:34,594: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,594: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,594: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,594: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,595: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,595: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,595: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,595: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,596: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,596: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,596: root: ERROR: 'Close'
2023-06-01 20:35:34,596: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,596: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,597: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,597: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,597: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,598: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,598: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,598: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,598: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,599: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,599: root: ERROR: 'Close'
2023-06-01 20:35:34,599: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,599: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,600: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,600: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,600: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,601: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,601: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,601: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,602: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,602: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,603: root: ERROR: 'Close'
2023-06-01 20:35:34,603: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,603: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,604: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,604: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,604: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,604: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,605: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,605: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,605: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,605: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,606: root: ERROR: 'Close'
2023-06-01 20:35:34,606: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,606: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,606: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,606: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,607: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,607: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,607: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,607: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,608: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,608: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,608: root: ERROR: 'Close'
2023-06-01 20:35:34,609: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,609: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,609: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,609: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,609: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,610: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,610: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,610: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,610: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,611: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,611: root: ERROR: 'Close'
2023-06-01 20:35:34,611: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,611: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,612: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,612: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,612: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,612: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,613: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,613: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,613: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,613: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,614: root: ERROR: 'Close'
2023-06-01 20:35:34,614: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,614: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,614: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,614: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,615: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,615: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,616: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,616: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,616: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,616: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,617: root: ERROR: 'Close'
2023-06-01 20:35:34,617: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,617: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,617: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,618: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,618: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,618: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,619: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,619: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,619: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,620: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,620: root: ERROR: 'Close'
2023-06-01 20:35:34,620: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,621: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,621: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,621: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,621: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,622: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,622: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,622: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,622: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,623: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,623: root: ERROR: 'Close'
2023-06-01 20:35:34,623: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,623: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,624: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,624: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,624: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,625: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,625: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,625: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,625: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,625: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,626: root: ERROR: 'Close'
2023-06-01 20:35:34,626: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,626: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,627: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,627: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,627: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,627: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,628: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,628: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,628: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,628: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,629: root: ERROR: 'Close'
2023-06-01 20:35:34,629: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,629: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,629: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,629: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,630: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,630: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,630: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,630: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,631: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,631: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,631: root: ERROR: 'Close'
2023-06-01 20:35:34,632: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,632: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,632: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,632: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,633: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,633: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,633: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,633: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,634: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,634: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,635: root: ERROR: 'Close'
2023-06-01 20:35:34,635: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,635: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,636: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,636: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,636: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,637: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,637: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,637: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,637: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,637: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,638: root: ERROR: 'Close'
2023-06-01 20:35:34,638: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,638: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,639: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,639: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,639: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,640: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,640: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,640: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,640: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,640: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,641: root: ERROR: 'Close'
2023-06-01 20:35:34,641: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,641: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,642: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,642: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,642: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,642: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,643: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,643: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,643: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,643: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,644: root: ERROR: 'Close'
2023-06-01 20:35:34,644: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,644: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,644: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,644: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,645: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,645: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,645: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,645: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,646: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,646: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,646: root: ERROR: 'Close'
2023-06-01 20:35:34,646: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,646: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,647: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,647: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,647: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,648: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,648: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,648: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,649: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,649: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,649: root: ERROR: 'Close'
2023-06-01 20:35:34,649: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,649: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,650: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,650: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,651: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,651: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,651: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,651: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,652: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,652: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,653: root: ERROR: 'Close'
2023-06-01 20:35:34,653: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,653: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,653: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,654: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,654: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,654: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,655: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,655: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,655: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,655: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,656: root: ERROR: 'Close'
2023-06-01 20:35:34,656: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,656: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,656: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,656: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,657: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,657: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,657: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,657: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,658: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,658: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,658: root: ERROR: 'Close'
2023-06-01 20:35:34,658: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,659: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,659: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,659: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,659: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,660: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,660: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,660: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,660: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,660: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,661: root: ERROR: 'Close'
2023-06-01 20:35:34,661: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,661: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,662: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,662: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,662: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,662: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,663: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,663: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,663: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,663: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,664: root: ERROR: 'Close'
2023-06-01 20:35:34,664: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,664: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,665: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,665: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,665: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,665: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,666: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,666: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,666: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,666: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,667: root: ERROR: 'Close'
2023-06-01 20:35:34,668: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,668: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,669: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,669: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,669: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,669: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,670: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,670: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,670: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,670: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,671: root: ERROR: 'Close'
2023-06-01 20:35:34,671: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,671: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,671: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,672: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,672: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,672: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,673: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,673: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,673: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,673: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,673: root: ERROR: 'Close'
2023-06-01 20:35:34,674: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,674: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,674: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,674: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,675: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,675: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,675: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,675: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,676: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,676: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,676: root: ERROR: 'Close'
2023-06-01 20:35:34,676: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,676: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,677: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,677: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,677: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,678: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,678: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,678: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,678: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,678: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,679: root: ERROR: 'Close'
2023-06-01 20:35:34,679: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,679: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,680: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,680: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,680: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,680: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,681: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,681: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,681: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,681: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,682: root: ERROR: 'Close'
2023-06-01 20:35:34,682: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,682: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,683: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,683: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,683: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,683: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,684: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,684: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,684: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,684: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,685: root: ERROR: 'Close'
2023-06-01 20:35:34,685: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,685: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,686: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,686: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,686: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,686: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,687: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,687: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,687: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,687: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,688: root: ERROR: 'Close'
2023-06-01 20:35:34,688: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,688: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,688: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,688: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,689: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,689: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,689: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,689: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,690: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,690: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,690: root: ERROR: 'Close'
2023-06-01 20:35:34,690: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,691: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,691: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,691: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,691: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,692: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,692: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,692: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,692: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,692: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,693: root: ERROR: 'Close'
2023-06-01 20:35:34,693: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,693: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,694: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,694: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,694: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,694: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,695: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,695: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,695: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,695: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,696: root: ERROR: 'Close'
2023-06-01 20:35:34,696: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,696: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,696: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,696: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,697: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,697: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,697: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,697: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,698: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,698: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,698: root: ERROR: 'Close'
2023-06-01 20:35:34,699: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,699: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,699: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,699: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,700: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,700: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,701: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,701: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,701: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,701: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,702: root: ERROR: 'Close'
2023-06-01 20:35:34,702: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,702: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,703: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,703: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,703: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,703: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,704: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,704: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,704: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,704: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,705: root: ERROR: 'Close'
2023-06-01 20:35:34,705: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,705: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,706: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,706: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,706: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,706: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,707: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,707: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,707: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,707: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,708: root: ERROR: 'Close'
2023-06-01 20:35:34,708: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,708: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,708: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,708: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,709: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,709: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,709: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,709: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,710: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,710: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,710: root: ERROR: 'Close'
2023-06-01 20:35:34,711: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,711: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,711: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,711: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,712: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,712: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,712: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,712: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,713: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,713: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,713: root: ERROR: 'Close'
2023-06-01 20:35:34,713: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,714: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,714: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,714: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,714: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,715: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,715: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,715: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,715: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,716: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,716: root: ERROR: 'Close'
2023-06-01 20:35:34,716: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,716: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,717: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,717: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,717: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,718: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,718: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,718: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,719: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,719: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,720: root: ERROR: 'Close'
2023-06-01 20:35:34,720: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,720: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,720: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,720: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,721: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,721: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,721: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,721: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,722: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,722: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,722: root: ERROR: 'Close'
2023-06-01 20:35:34,723: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,723: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,723: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,723: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,724: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,724: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,724: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,724: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,725: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,725: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,725: root: ERROR: 'Close'
2023-06-01 20:35:34,725: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,725: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,726: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,726: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,726: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,727: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,727: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,727: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,727: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,727: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,728: root: ERROR: 'Close'
2023-06-01 20:35:34,728: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,728: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,728: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,729: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,729: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,729: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,730: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,730: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,730: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,730: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,730: root: ERROR: 'Close'
2023-06-01 20:35:34,731: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,731: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,731: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,731: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,732: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,732: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,733: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,733: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,733: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,733: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,734: root: ERROR: 'Close'
2023-06-01 20:35:34,734: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,734: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,735: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,735: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,735: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,735: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,736: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,736: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,736: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,736: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,737: root: ERROR: 'Close'
2023-06-01 20:35:34,737: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,737: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,738: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,738: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,738: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,738: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,739: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,739: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,739: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,739: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,740: root: ERROR: 'Close'
2023-06-01 20:35:34,740: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,740: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,740: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,740: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,741: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,741: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,741: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,741: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,742: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,742: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,742: root: ERROR: 'Close'
2023-06-01 20:35:34,742: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,742: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,743: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,743: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,743: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,744: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,744: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,744: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,744: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,744: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,745: root: ERROR: 'Close'
2023-06-01 20:35:34,745: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,745: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,746: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,746: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,746: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,746: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,747: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,747: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,747: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,747: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,748: root: ERROR: 'Close'
2023-06-01 20:35:34,748: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,748: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,749: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,749: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,749: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,750: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,750: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,750: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,750: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,750: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,751: root: ERROR: 'Close'
2023-06-01 20:35:34,751: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,751: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,752: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,752: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,752: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,752: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,753: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,753: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,753: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,753: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,754: root: ERROR: 'Close'
2023-06-01 20:35:34,754: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,754: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,755: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,755: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,755: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,755: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,756: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,756: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,756: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,756: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,757: root: ERROR: 'Close'
2023-06-01 20:35:34,757: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,757: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,757: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,757: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,758: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,758: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,758: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,758: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,759: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,759: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,759: root: ERROR: 'Close'
2023-06-01 20:35:34,759: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,759: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,760: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,760: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,760: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,761: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,761: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,761: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,761: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,761: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,762: root: ERROR: 'Close'
2023-06-01 20:35:34,762: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,762: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,763: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,763: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,763: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,763: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,764: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,764: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,764: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,764: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,765: root: ERROR: 'Close'
2023-06-01 20:35:34,765: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,765: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,766: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,766: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,766: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,767: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,767: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,767: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,767: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,768: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,768: root: ERROR: 'Close'
2023-06-01 20:35:34,768: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,768: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,769: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,769: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,769: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,770: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,770: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,770: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,770: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,770: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,771: root: ERROR: 'Close'
2023-06-01 20:35:34,771: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,771: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,772: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,772: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,772: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,772: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,773: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,773: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,773: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,773: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,774: root: ERROR: 'Close'
2023-06-01 20:35:34,774: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,774: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,774: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,774: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,775: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,775: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,775: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,775: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,776: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,776: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,776: root: ERROR: 'Close'
2023-06-01 20:35:34,776: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,776: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,777: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,777: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,777: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,778: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,778: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,778: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,778: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,778: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,779: root: ERROR: 'Close'
2023-06-01 20:35:34,779: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,779: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,780: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,780: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,780: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,780: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,781: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,781: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,781: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,781: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,782: root: ERROR: 'Close'
2023-06-01 20:35:34,782: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,782: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,783: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,783: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,783: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,784: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,784: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,784: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,785: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,785: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,785: root: ERROR: 'Close'
2023-06-01 20:35:34,785: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,786: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,786: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,786: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,786: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,787: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,787: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,787: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,787: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,788: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,788: root: ERROR: 'Close'
2023-06-01 20:35:34,788: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,788: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,789: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,789: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,789: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,789: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,790: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,790: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,790: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,790: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,791: root: ERROR: 'Close'
2023-06-01 20:35:34,791: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,791: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,791: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,792: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,792: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,792: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,792: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,793: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,793: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,793: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,793: root: ERROR: 'Close'
2023-06-01 20:35:34,794: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,794: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,794: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,794: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,795: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,795: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,795: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,795: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,796: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,796: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,796: root: ERROR: 'Close'
2023-06-01 20:35:34,796: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,796: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,797: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,797: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,797: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,797: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,798: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,798: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,798: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,798: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,799: root: ERROR: 'Close'
2023-06-01 20:35:34,799: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,799: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,800: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,800: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,800: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,800: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,801: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,801: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,802: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,802: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,803: root: ERROR: 'Close'
2023-06-01 20:35:34,803: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,804: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,806: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,806: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,806: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,807: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,807: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,807: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,808: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,808: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,808: root: ERROR: 'Close'
2023-06-01 20:35:34,809: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,810: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,811: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,811: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,811: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,812: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,812: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,812: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,813: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,813: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,813: root: ERROR: 'Close'
2023-06-01 20:35:34,813: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,814: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,815: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,815: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,815: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,815: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,816: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,816: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,816: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,816: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,817: root: ERROR: 'Close'
2023-06-01 20:35:34,817: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,825: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,826: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,826: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,827: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,827: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,828: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,828: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,828: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,828: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,829: root: ERROR: 'Close'
2023-06-01 20:35:34,829: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,831: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,832: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,832: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,832: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,833: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,833: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,833: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,834: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,834: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,835: root: ERROR: 'Close'
2023-06-01 20:35:34,835: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,838: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,839: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,840: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,840: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,840: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,841: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,841: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,841: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,842: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,842: root: ERROR: 'Close'
2023-06-01 20:35:34,842: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,845: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,846: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,846: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,846: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,846: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,847: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,847: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,847: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,847: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,848: root: ERROR: 'Close'
2023-06-01 20:35:34,848: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,849: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,850: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,850: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,851: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,851: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,851: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,851: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,852: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,852: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,853: root: ERROR: 'Close'
2023-06-01 20:35:34,863: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,864: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,864: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,864: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,865: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,865: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,866: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,866: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,866: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,866: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,867: root: ERROR: 'Close'
2023-06-01 20:35:34,867: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,868: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,870: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,870: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,871: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,871: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,872: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,872: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,872: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,873: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,873: root: ERROR: 'Close'
2023-06-01 20:35:34,874: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,874: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,874: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,874: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,875: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,875: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,876: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,876: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,876: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,876: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,877: root: ERROR: 'Close'
2023-06-01 20:35:34,877: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,877: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,878: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,878: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,878: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,878: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,879: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,879: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,879: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,879: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,880: root: ERROR: 'Close'
2023-06-01 20:35:34,880: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,880: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,880: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,880: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,881: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,881: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,882: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,882: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,882: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,882: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,883: root: ERROR: 'Close'
2023-06-01 20:35:34,883: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,883: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,884: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,884: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,884: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,885: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,885: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,885: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,885: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,885: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,886: root: ERROR: 'Close'
2023-06-01 20:35:34,886: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,886: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,887: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,887: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,887: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,887: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,888: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,888: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,888: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,888: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,889: root: ERROR: 'Close'
2023-06-01 20:35:34,889: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,889: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,889: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,889: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,890: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,890: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,890: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,890: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,891: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,891: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,891: root: ERROR: 'Close'
2023-06-01 20:35:34,892: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,892: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,892: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,892: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,893: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,893: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,893: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,893: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,894: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,894: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,894: root: ERROR: 'Close'
2023-06-01 20:35:34,894: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,894: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,895: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,895: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,895: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,896: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,896: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,896: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,896: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,896: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,897: root: ERROR: 'Close'
2023-06-01 20:35:34,897: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,897: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,898: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,898: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,898: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,898: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,899: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,899: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,899: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,899: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,900: root: ERROR: 'Close'
2023-06-01 20:35:34,900: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,900: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,901: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,901: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,902: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,902: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,903: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,903: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,903: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,903: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,904: root: ERROR: 'Close'
2023-06-01 20:35:34,904: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,904: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,904: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,904: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,905: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,905: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,905: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,905: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,906: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,906: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,906: root: ERROR: 'Close'
2023-06-01 20:35:34,906: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,907: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,907: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,907: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,908: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,908: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,908: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,908: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,909: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,909: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,909: root: ERROR: 'Close'
2023-06-01 20:35:34,909: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,909: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,910: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,910: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,910: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,910: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,911: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,911: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,911: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,911: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,912: root: ERROR: 'Close'
2023-06-01 20:35:34,912: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,912: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,912: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,913: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,913: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,913: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,914: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,914: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,914: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,914: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,914: root: ERROR: 'Close'
2023-06-01 20:35:34,915: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,915: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,915: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,915: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,916: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,916: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,917: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,917: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,917: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,917: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,918: root: ERROR: 'Close'
2023-06-01 20:35:34,918: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,918: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,919: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,919: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,919: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,919: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,920: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,920: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,920: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,920: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,921: root: ERROR: 'Close'
2023-06-01 20:35:34,921: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,921: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,921: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,921: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,922: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,922: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,922: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,922: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,923: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,923: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,923: root: ERROR: 'Close'
2023-06-01 20:35:34,923: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,924: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,924: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,924: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,924: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,925: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,925: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,925: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,925: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,926: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,926: root: ERROR: 'Close'
2023-06-01 20:35:34,926: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,926: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,927: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,927: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,927: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,927: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,928: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,928: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,928: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,928: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,929: root: ERROR: 'Close'
2023-06-01 20:35:34,929: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,929: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,929: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,929: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,930: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,930: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,930: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,930: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,931: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,931: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,931: root: ERROR: 'Close'
2023-06-01 20:35:34,932: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,932: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,933: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,933: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,933: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,933: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,934: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,934: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,934: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,934: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,935: root: ERROR: 'Close'
2023-06-01 20:35:34,935: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,935: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,936: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,936: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,936: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,936: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,937: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,937: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,937: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,937: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,938: root: ERROR: 'Close'
2023-06-01 20:35:34,938: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,938: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,938: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,938: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,939: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,939: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,939: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,939: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,940: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,940: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,940: root: ERROR: 'Close'
2023-06-01 20:35:34,940: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,941: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,941: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,941: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,941: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,942: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,942: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,942: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,942: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,943: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,943: root: ERROR: 'Close'
2023-06-01 20:35:34,943: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,943: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,944: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,944: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,944: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,944: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,945: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,945: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,945: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,945: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,946: root: ERROR: 'Close'
2023-06-01 20:35:34,946: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,946: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,946: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,946: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,947: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,947: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,947: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,947: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,948: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,948: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,949: root: ERROR: 'Close'
2023-06-01 20:35:34,949: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,949: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,950: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,950: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,950: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,950: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,951: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,951: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,951: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,951: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,952: root: ERROR: 'Close'
2023-06-01 20:35:34,952: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,952: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,953: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,953: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,953: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,953: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,954: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,954: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,954: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,954: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,955: root: ERROR: 'Close'
2023-06-01 20:35:34,955: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,955: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,955: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,955: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,956: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,956: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,956: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,956: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,957: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,957: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,957: root: ERROR: 'Close'
2023-06-01 20:35:34,957: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,958: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,958: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,958: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,958: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,959: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,959: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,959: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,959: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,959: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,960: root: ERROR: 'Close'
2023-06-01 20:35:34,960: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,960: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,961: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,961: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,961: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,961: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,962: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,962: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,962: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,962: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,963: root: ERROR: 'Close'
2023-06-01 20:35:34,963: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,963: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,963: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,963: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,964: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,964: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,964: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,964: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,965: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,965: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,965: root: ERROR: 'Close'
2023-06-01 20:35:34,966: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,966: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,966: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,966: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,967: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,967: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,968: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,968: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,968: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,968: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,969: root: ERROR: 'Close'
2023-06-01 20:35:34,969: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,969: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,970: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,970: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,970: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,971: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,971: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,971: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,971: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,971: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,972: root: ERROR: 'Close'
2023-06-01 20:35:34,972: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,972: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,973: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,973: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,973: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,973: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,974: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,974: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,974: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,974: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,975: root: ERROR: 'Close'
2023-06-01 20:35:34,975: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,975: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,976: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,976: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,976: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,976: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,977: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,977: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,977: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,977: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,977: root: ERROR: 'Close'
2023-06-01 20:35:34,978: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,978: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,978: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,978: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,979: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,979: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,979: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,979: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,980: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,980: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,980: root: ERROR: 'Close'
2023-06-01 20:35:34,980: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,981: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,981: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,981: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,982: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,982: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,982: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,982: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,983: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,983: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,983: root: ERROR: 'Close'
2023-06-01 20:35:34,984: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,984: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,985: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,985: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,985: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,985: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,986: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,986: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,986: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,986: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,987: root: ERROR: 'Close'
2023-06-01 20:35:34,987: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,987: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,988: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,988: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,988: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,988: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,989: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,989: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,989: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,989: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,990: root: ERROR: 'Close'
2023-06-01 20:35:34,990: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,990: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,990: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,990: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,991: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,991: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,991: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,991: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,992: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,992: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,992: root: ERROR: 'Close'
2023-06-01 20:35:34,993: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,993: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,993: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,993: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,994: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,994: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,994: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,994: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,995: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,995: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,995: root: ERROR: 'Close'
2023-06-01 20:35:34,995: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,995: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,996: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,996: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:34,996: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:34,997: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:34,997: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:34,997: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:34,997: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:34,997: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:34,998: root: ERROR: 'Close'
2023-06-01 20:35:34,998: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:34,998: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:34,999: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:34,999: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,000: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,000: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,000: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,000: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,001: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,001: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,001: root: ERROR: 'Close'
2023-06-01 20:35:35,002: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,002: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,002: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,002: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,003: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,003: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,003: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,003: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,004: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,004: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,004: root: ERROR: 'Close'
2023-06-01 20:35:35,004: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,005: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,005: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,005: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,005: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,006: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,006: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,006: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,006: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,007: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,007: root: ERROR: 'Close'
2023-06-01 20:35:35,007: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,007: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,008: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,008: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,008: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,008: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,009: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,009: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,009: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,009: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,010: root: ERROR: 'Close'
2023-06-01 20:35:35,010: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,010: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,010: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,010: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,011: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,011: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,011: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,011: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,012: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,012: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,012: root: ERROR: 'Close'
2023-06-01 20:35:35,012: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,013: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,013: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,013: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,013: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,014: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,014: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,014: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,015: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,015: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,015: root: ERROR: 'Close'
2023-06-01 20:35:35,015: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,016: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,016: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,016: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,017: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,017: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,017: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,017: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,018: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,018: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,019: root: ERROR: 'Close'
2023-06-01 20:35:35,019: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,019: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,019: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,020: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,020: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,020: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,021: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,021: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,021: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,021: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,022: root: ERROR: 'Close'
2023-06-01 20:35:35,022: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,022: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,022: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,022: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,023: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,023: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,023: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,023: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,024: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,024: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,024: root: ERROR: 'Close'
2023-06-01 20:35:35,024: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,025: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,025: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,025: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,025: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,026: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,026: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,026: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,026: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,027: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,027: root: ERROR: 'Close'
2023-06-01 20:35:35,027: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,027: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,028: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,028: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,028: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,028: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,029: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,029: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,029: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,029: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,030: root: ERROR: 'Close'
2023-06-01 20:35:35,030: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,030: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,030: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,030: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,031: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,031: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,032: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,032: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,032: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,032: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,033: root: ERROR: 'Close'
2023-06-01 20:35:35,033: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,033: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,034: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,034: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,034: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,035: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,035: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,035: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,036: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,036: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,036: root: ERROR: 'Close'
2023-06-01 20:35:35,036: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,037: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,037: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,037: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,037: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,038: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,038: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,038: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,039: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,039: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,039: root: ERROR: 'Close'
2023-06-01 20:35:35,039: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,039: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,040: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,040: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,040: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,040: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,041: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,041: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,041: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,041: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,042: root: ERROR: 'Close'
2023-06-01 20:35:35,042: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,042: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,042: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,043: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,043: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,043: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,043: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,044: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,044: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,044: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,044: root: ERROR: 'Close'
2023-06-01 20:35:35,045: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,045: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,045: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,045: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,045: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,046: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,046: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,046: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,047: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,047: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,047: root: ERROR: 'Close'
2023-06-01 20:35:35,047: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,047: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,048: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,048: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,048: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,049: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,049: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,049: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,050: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,050: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,050: root: ERROR: 'Close'
2023-06-01 20:35:35,051: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,051: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,051: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,051: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,052: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,052: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,053: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,053: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,053: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,053: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,054: root: ERROR: 'Close'
2023-06-01 20:35:35,054: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,054: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,054: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,054: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,055: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,055: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,055: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,056: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,056: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,056: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,056: root: ERROR: 'Close'
2023-06-01 20:35:35,057: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,057: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,057: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,057: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,058: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,058: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,058: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,058: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,059: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,059: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,059: root: ERROR: 'Close'
2023-06-01 20:35:35,059: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,059: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,060: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,060: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,060: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,060: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,061: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,061: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,061: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,061: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,062: root: ERROR: 'Close'
2023-06-01 20:35:35,062: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,062: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,062: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,062: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,063: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,063: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,063: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,063: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,064: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,064: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,064: root: ERROR: 'Close'
2023-06-01 20:35:35,064: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,065: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,065: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,065: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,066: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,066: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,066: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,066: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,067: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,067: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,068: root: ERROR: 'Close'
2023-06-01 20:35:35,068: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,068: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,068: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,069: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,069: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,069: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,070: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,070: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,070: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,070: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,071: root: ERROR: 'Close'
2023-06-01 20:35:35,071: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,071: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,071: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,071: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,072: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,072: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,072: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,072: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,073: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,073: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,073: root: ERROR: 'Close'
2023-06-01 20:35:35,074: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,074: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,074: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,074: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,075: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,075: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,075: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,075: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,076: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,076: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,076: root: ERROR: 'Close'
2023-06-01 20:35:35,076: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,076: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,077: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,077: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,077: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,077: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,078: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,078: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,078: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,078: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,079: root: ERROR: 'Close'
2023-06-01 20:35:35,079: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,079: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,079: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,080: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,080: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,080: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,080: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,080: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,081: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,081: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,081: root: ERROR: 'Close'
2023-06-01 20:35:35,082: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,082: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,083: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,083: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,083: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,084: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,084: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,084: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,084: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,085: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,085: root: ERROR: 'Close'
2023-06-01 20:35:35,085: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,085: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,086: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,086: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,086: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,087: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,087: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,087: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,087: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,088: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,088: root: ERROR: 'Close'
2023-06-01 20:35:35,088: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,088: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,089: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,089: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,089: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,089: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,090: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,090: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,090: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,090: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,091: root: ERROR: 'Close'
2023-06-01 20:35:35,091: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,091: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,091: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,091: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,092: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,092: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,092: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,092: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,093: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,093: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,093: root: ERROR: 'Close'
2023-06-01 20:35:35,093: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,094: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,094: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,094: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,094: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,095: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,095: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,095: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,095: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,096: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,096: root: ERROR: 'Close'
2023-06-01 20:35:35,096: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,096: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,097: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,097: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,097: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,098: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,098: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,098: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,098: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,099: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,099: root: ERROR: 'Close'
2023-06-01 20:35:35,099: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,099: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,100: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,100: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,100: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,101: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,101: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,101: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,102: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,102: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,102: root: ERROR: 'Close'
2023-06-01 20:35:35,103: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,103: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,103: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,103: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,104: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,104: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,104: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,104: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,105: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,105: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,105: root: ERROR: 'Close'
2023-06-01 20:35:35,106: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,106: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,106: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,106: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,106: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,107: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,107: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,107: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,107: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,108: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,108: root: ERROR: 'Close'
2023-06-01 20:35:35,108: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,108: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,109: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,109: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,109: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,109: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,110: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,110: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,110: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,110: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,111: root: ERROR: 'Close'
2023-06-01 20:35:35,111: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,111: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,111: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,111: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,112: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,112: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,112: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,112: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,113: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,113: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,113: root: ERROR: 'Close'
2023-06-01 20:35:35,113: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,114: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,114: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,114: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,115: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,115: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,115: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,115: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,116: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,116: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,116: root: ERROR: 'Close'
2023-06-01 20:35:35,117: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,117: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,117: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,117: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,118: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,118: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,119: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,119: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,119: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,119: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,120: root: ERROR: 'Close'
2023-06-01 20:35:35,120: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,120: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,121: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,121: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,121: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,121: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,122: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,122: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,122: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,122: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,123: root: ERROR: 'Close'
2023-06-01 20:35:35,123: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,123: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,123: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,123: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,124: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,124: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,124: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,125: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,125: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,125: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,125: root: ERROR: 'Close'
2023-06-01 20:35:35,126: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,126: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,126: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,126: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,127: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,127: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,127: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,127: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,128: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,128: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,128: root: ERROR: 'Close'
2023-06-01 20:35:35,128: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,128: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,129: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,129: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,129: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,129: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,130: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,130: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,130: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,130: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,131: root: ERROR: 'Close'
2023-06-01 20:35:35,131: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,131: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,132: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,132: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,132: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,132: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,133: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,133: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,133: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,134: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,134: root: ERROR: 'Close'
2023-06-01 20:35:35,135: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,135: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,135: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,135: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,136: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,136: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,136: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,136: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,137: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,137: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,137: root: ERROR: 'Close'
2023-06-01 20:35:35,137: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,138: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,138: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,138: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,138: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,139: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,139: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,139: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,139: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,139: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,140: root: ERROR: 'Close'
2023-06-01 20:35:35,140: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,140: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,141: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,141: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,141: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,141: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,142: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,142: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,142: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,142: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,143: root: ERROR: 'Close'
2023-06-01 20:35:35,143: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,143: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,143: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,143: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,144: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,144: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,144: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,144: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,145: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,145: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,145: root: ERROR: 'Close'
2023-06-01 20:35:35,145: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,146: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,146: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,146: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,147: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,147: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,147: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,147: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,148: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,148: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,148: root: ERROR: 'Close'
2023-06-01 20:35:35,148: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,149: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,149: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,149: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,150: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,150: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,151: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,151: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,151: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,151: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,152: root: ERROR: 'Close'
2023-06-01 20:35:35,152: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,153: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,154: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,154: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,155: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,155: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,155: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,155: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,156: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,156: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,157: root: ERROR: 'Close'
2023-06-01 20:35:35,157: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,158: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,159: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,159: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,159: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,159: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,160: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,160: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,160: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,161: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,161: root: ERROR: 'Close'
2023-06-01 20:35:35,161: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,162: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,163: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,163: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,163: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,164: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,164: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,164: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,165: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,165: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,165: root: ERROR: 'Close'
2023-06-01 20:35:35,165: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,167: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,170: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,170: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,171: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,171: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,172: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,172: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,172: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,173: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,173: root: ERROR: 'Close'
2023-06-01 20:35:35,173: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,175: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,176: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,176: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,176: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,176: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,177: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,177: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,177: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,177: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,178: root: ERROR: 'Close'
2023-06-01 20:35:35,178: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,179: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,181: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,181: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,181: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,181: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,182: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,182: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,182: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,182: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,183: root: ERROR: 'Close'
2023-06-01 20:35:35,183: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,186: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,187: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,187: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,188: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,188: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,189: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,189: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,190: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,190: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,191: root: ERROR: 'Close'
2023-06-01 20:35:35,191: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,191: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,192: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,192: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,193: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,193: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,193: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,193: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,194: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,194: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,195: root: ERROR: 'Close'
2023-06-01 20:35:35,195: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,195: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,195: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,195: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,196: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,196: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,197: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,197: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,197: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,197: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,198: root: ERROR: 'Close'
2023-06-01 20:35:35,198: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,198: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,199: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,199: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,200: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,200: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,200: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,200: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,201: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,201: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,202: root: ERROR: 'Close'
2023-06-01 20:35:35,202: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,202: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,203: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,203: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,204: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,204: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,205: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,205: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,205: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,205: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,206: root: ERROR: 'Close'
2023-06-01 20:35:35,206: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,207: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,207: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,207: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,208: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,208: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,208: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,208: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,209: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,209: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,210: root: ERROR: 'Close'
2023-06-01 20:35:35,210: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,210: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,211: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,211: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,211: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,212: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,212: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,212: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,213: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,213: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,213: root: ERROR: 'Close'
2023-06-01 20:35:35,213: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,213: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,214: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,214: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,214: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,215: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,215: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,215: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,216: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,216: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,216: root: ERROR: 'Close'
2023-06-01 20:35:35,217: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,217: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,218: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,218: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,218: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,218: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,219: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,219: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,219: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,219: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,220: root: ERROR: 'Close'
2023-06-01 20:35:35,220: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,220: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,221: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,221: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,221: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,221: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,222: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,222: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,222: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,222: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,223: root: ERROR: 'Close'
2023-06-01 20:35:35,223: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,223: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,224: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,224: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,224: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,225: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,225: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,225: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,225: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,226: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,226: root: ERROR: 'Close'
2023-06-01 20:35:35,226: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,226: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,227: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,227: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,227: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,228: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,228: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,228: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,228: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,228: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,229: root: ERROR: 'Close'
2023-06-01 20:35:35,229: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,229: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,230: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,230: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,230: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,230: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,231: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,231: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,231: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,231: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,232: root: ERROR: 'Close'
2023-06-01 20:35:35,232: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,232: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,233: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,233: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,233: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,234: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,234: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,234: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,235: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,235: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,236: root: ERROR: 'Close'
2023-06-01 20:35:35,236: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,236: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,237: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,237: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,238: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,238: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,238: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,238: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,239: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,239: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,239: root: ERROR: 'Close'
2023-06-01 20:35:35,240: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,240: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,240: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,240: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,241: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,241: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,241: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,241: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,242: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,242: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,242: root: ERROR: 'Close'
2023-06-01 20:35:35,242: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,243: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,243: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,243: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,243: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,244: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,244: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,244: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,244: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,244: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,245: root: ERROR: 'Close'
2023-06-01 20:35:35,245: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,245: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,246: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,246: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,246: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,246: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,247: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,247: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,247: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,247: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,248: root: ERROR: 'Close'
2023-06-01 20:35:35,248: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,248: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,249: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,249: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,249: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,250: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,250: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,250: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,250: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,251: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,251: root: ERROR: 'Close'
2023-06-01 20:35:35,251: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,251: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,252: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,252: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,252: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,253: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,253: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,253: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,253: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,253: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,254: root: ERROR: 'Close'
2023-06-01 20:35:35,254: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,254: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,255: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,255: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,255: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,255: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,256: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,256: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,256: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,256: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,257: root: ERROR: 'Close'
2023-06-01 20:35:35,257: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,257: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,257: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,257: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,258: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,258: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,258: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,258: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,259: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,259: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,259: root: ERROR: 'Close'
2023-06-01 20:35:35,259: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,259: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,260: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,260: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,260: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,260: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,261: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,261: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,261: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,261: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,262: root: ERROR: 'Close'
2023-06-01 20:35:35,262: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,262: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,262: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,262: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,263: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,263: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,263: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,263: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,264: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,264: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,264: root: ERROR: 'Close'
2023-06-01 20:35:35,265: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,265: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,265: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,265: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,266: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,266: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,266: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,267: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,267: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,267: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,268: root: ERROR: 'Close'
2023-06-01 20:35:35,268: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,268: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,269: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,269: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,269: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,269: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,270: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,270: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,270: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,270: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,271: root: ERROR: 'Close'
2023-06-01 20:35:35,271: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,271: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,271: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,271: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,272: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,272: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,272: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,272: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,273: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,273: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,273: root: ERROR: 'Close'
2023-06-01 20:35:35,273: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,274: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,274: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,274: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,274: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,275: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,275: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,275: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,275: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,276: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,276: root: ERROR: 'Close'
2023-06-01 20:35:35,276: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,276: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,277: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,277: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,277: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,277: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,278: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,278: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,278: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,278: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,279: root: ERROR: 'Close'
2023-06-01 20:35:35,279: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,279: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,279: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,279: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,280: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,280: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,281: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,281: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,281: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,281: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,282: root: ERROR: 'Close'
2023-06-01 20:35:35,282: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,282: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,283: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,283: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,283: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,284: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,284: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,284: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,284: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,285: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,285: root: ERROR: 'Close'
2023-06-01 20:35:35,285: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,285: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,286: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,286: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,286: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,286: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,287: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,287: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,287: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,287: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,288: root: ERROR: 'Close'
2023-06-01 20:35:35,288: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,288: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,288: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,289: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,289: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,289: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,290: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,290: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,290: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,290: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,290: root: ERROR: 'Close'
2023-06-01 20:35:35,291: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,291: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,291: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,291: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,292: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,292: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,292: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,292: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,292: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,293: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,293: root: ERROR: 'Close'
2023-06-01 20:35:35,293: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,293: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,294: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,294: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,294: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,294: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,295: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,295: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,295: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,295: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,296: root: ERROR: 'Close'
2023-06-01 20:35:35,296: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,296: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,296: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,297: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,297: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,297: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,298: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,298: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,298: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,298: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,299: root: ERROR: 'Close'
2023-06-01 20:35:35,299: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,299: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,299: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,300: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,300: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,300: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,301: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,301: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,301: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,302: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,302: root: ERROR: 'Close'
2023-06-01 20:35:35,302: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,303: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,303: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,303: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,303: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,304: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,304: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,304: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,304: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,304: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,305: root: ERROR: 'Close'
2023-06-01 20:35:35,305: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,305: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,306: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,306: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,306: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,306: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,307: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,307: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,307: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,307: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,308: root: ERROR: 'Close'
2023-06-01 20:35:35,308: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,308: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,308: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,308: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,309: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,309: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,309: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,309: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,310: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,310: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,310: root: ERROR: 'Close'
2023-06-01 20:35:35,310: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,311: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,311: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,311: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,311: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,312: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,312: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,312: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,312: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,313: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,313: root: ERROR: 'Close'
2023-06-01 20:35:35,313: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,313: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,314: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,314: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,314: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,314: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,315: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,315: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,315: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,315: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,316: root: ERROR: 'Close'
2023-06-01 20:35:35,316: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,316: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,317: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,317: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,317: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,318: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,318: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,318: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,319: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,319: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,319: root: ERROR: 'Close'
2023-06-01 20:35:35,320: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,320: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,320: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,320: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,321: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,321: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,321: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,321: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,322: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,322: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,322: root: ERROR: 'Close'
2023-06-01 20:35:35,322: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,322: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,323: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,323: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,323: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,324: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,324: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,324: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,324: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,324: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,325: root: ERROR: 'Close'
2023-06-01 20:35:35,325: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,325: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,326: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,326: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,326: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,326: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,327: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,327: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,327: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,327: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,328: root: ERROR: 'Close'
2023-06-01 20:35:35,328: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,328: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,328: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,329: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,329: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,329: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,330: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,330: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,330: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,330: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,331: root: ERROR: 'Close'
2023-06-01 20:35:35,331: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,331: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,331: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,331: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,332: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,332: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,333: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,333: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,333: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,333: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,334: root: ERROR: 'Close'
2023-06-01 20:35:35,334: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,334: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,335: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,335: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,335: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,336: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,336: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,336: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,336: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,337: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,337: root: ERROR: 'Close'
2023-06-01 20:35:35,337: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,337: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,338: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,338: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,338: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,339: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,339: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,339: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,339: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,339: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,340: root: ERROR: 'Close'
2023-06-01 20:35:35,340: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,340: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,341: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,341: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,341: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,341: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,342: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,342: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,342: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,342: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,343: root: ERROR: 'Close'
2023-06-01 20:35:35,343: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,343: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,343: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,343: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,344: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,344: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,344: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,344: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,345: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,345: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,345: root: ERROR: 'Close'
2023-06-01 20:35:35,345: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,345: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,346: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,346: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,346: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,347: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,347: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,347: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,347: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,348: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,348: root: ERROR: 'Close'
2023-06-01 20:35:35,349: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,349: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,349: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,349: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,350: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,350: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,350: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,350: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,351: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,351: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,351: root: ERROR: 'Close'
2023-06-01 20:35:35,352: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,352: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,352: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,352: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,352: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,353: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,353: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,353: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,353: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,354: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,354: root: ERROR: 'Close'
2023-06-01 20:35:35,354: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,354: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,355: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,355: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,355: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,355: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,356: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,356: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,356: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,356: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,357: root: ERROR: 'Close'
2023-06-01 20:35:35,357: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,357: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,357: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,358: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,358: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,358: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,359: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,359: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,359: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,359: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,359: root: ERROR: 'Close'
2023-06-01 20:35:35,360: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,360: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,360: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,360: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,361: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,361: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,361: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,361: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,362: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,362: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,362: root: ERROR: 'Close'
2023-06-01 20:35:35,362: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,362: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,363: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,363: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,363: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,363: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,364: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,364: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,364: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,364: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,365: root: ERROR: 'Close'
2023-06-01 20:35:35,365: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,365: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,366: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,366: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,367: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,367: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,367: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,367: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,368: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,368: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,368: root: ERROR: 'Close'
2023-06-01 20:35:35,368: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,369: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,369: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,369: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,370: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,370: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,370: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,370: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,371: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,371: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,371: root: ERROR: 'Close'
2023-06-01 20:35:35,371: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,372: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,372: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,372: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,372: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,373: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,373: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,373: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,373: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,374: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,374: root: ERROR: 'Close'
2023-06-01 20:35:35,374: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,374: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,375: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,375: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,375: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,375: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,376: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,376: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,376: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,376: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,377: root: ERROR: 'Close'
2023-06-01 20:35:35,377: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,377: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,377: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,377: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,378: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,378: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,378: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,378: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,379: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,379: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,379: root: ERROR: 'Close'
2023-06-01 20:35:35,379: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,380: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,380: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,380: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,381: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,381: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,381: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,381: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,382: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,382: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,382: root: ERROR: 'Close'
2023-06-01 20:35:35,382: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,383: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,383: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,383: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,383: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,384: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,384: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,384: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,385: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,385: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,386: root: ERROR: 'Close'
2023-06-01 20:35:35,386: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,386: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,386: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,386: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,387: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,387: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,387: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,387: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,388: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,388: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,388: root: ERROR: 'Close'
2023-06-01 20:35:35,389: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,389: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,389: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,389: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,390: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,390: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,390: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,390: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,391: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,391: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,391: root: ERROR: 'Close'
2023-06-01 20:35:35,391: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,391: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,392: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,392: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,392: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,392: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,393: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,393: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,393: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,393: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,394: root: ERROR: 'Close'
2023-06-01 20:35:35,394: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,394: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,394: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,394: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,395: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,395: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,395: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,396: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,396: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,396: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,396: root: ERROR: 'Close'
2023-06-01 20:35:35,397: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,397: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,397: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,397: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,398: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,398: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,398: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,398: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,399: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,399: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,399: root: ERROR: 'Close'
2023-06-01 20:35:35,400: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,400: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,400: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,400: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,401: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,401: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,402: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,402: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,402: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,402: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,403: root: ERROR: 'Close'
2023-06-01 20:35:35,403: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,403: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,404: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,404: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,404: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,404: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,405: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,405: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,405: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,405: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,406: root: ERROR: 'Close'
2023-06-01 20:35:35,406: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,406: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,406: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,406: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,407: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,407: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,407: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,407: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,408: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,408: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,408: root: ERROR: 'Close'
2023-06-01 20:35:35,409: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,409: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,409: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,409: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,409: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,410: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,410: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,410: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,410: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,411: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,411: root: ERROR: 'Close'
2023-06-01 20:35:35,411: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,411: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,412: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,412: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,412: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,412: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,413: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,413: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,413: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,413: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,414: root: ERROR: 'Close'
2023-06-01 20:35:35,414: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,414: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,415: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,415: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,415: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,415: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,416: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,416: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,416: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,416: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,417: root: ERROR: 'Close'
2023-06-01 20:35:35,417: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,417: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,418: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,418: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,418: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,419: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,419: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,419: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,420: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,420: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,420: root: ERROR: 'Close'
2023-06-01 20:35:35,420: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,421: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,421: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,421: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,421: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,422: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,422: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,422: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,422: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,423: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,423: root: ERROR: 'Close'
2023-06-01 20:35:35,423: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,423: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,424: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,424: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,424: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,424: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,425: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,425: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,425: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,425: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,426: root: ERROR: 'Close'
2023-06-01 20:35:35,426: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,426: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,426: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,426: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,427: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,427: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,427: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,427: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,428: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,428: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,428: root: ERROR: 'Close'
2023-06-01 20:35:35,429: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,429: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,429: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,429: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,430: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,430: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,430: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,430: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,431: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,431: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,431: root: ERROR: 'Close'
2023-06-01 20:35:35,432: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,432: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,432: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,432: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,433: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,433: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,434: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,434: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,434: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,434: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,435: root: ERROR: 'Close'
2023-06-01 20:35:35,435: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,435: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,436: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,436: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,436: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,436: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,437: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,437: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,437: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,437: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,438: root: ERROR: 'Close'
2023-06-01 20:35:35,438: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,438: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,439: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,439: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,439: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,439: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,440: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,440: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,440: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,440: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,440: root: ERROR: 'Close'
2023-06-01 20:35:35,441: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,441: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,441: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,441: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,442: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,442: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,442: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,442: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,442: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,443: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,443: root: ERROR: 'Close'
2023-06-01 20:35:35,443: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,443: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,444: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,444: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,444: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,444: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,445: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,445: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,445: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,445: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,446: root: ERROR: 'Close'
2023-06-01 20:35:35,446: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,446: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,446: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,446: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,447: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,447: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,447: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,447: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,448: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,448: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,449: root: ERROR: 'Close'
2023-06-01 20:35:35,449: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,449: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,450: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,450: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,450: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,450: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,451: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,451: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,451: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,451: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,452: root: ERROR: 'Close'
2023-06-01 20:35:35,452: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,452: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,453: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,453: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,453: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,453: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,454: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,454: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,454: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,454: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,455: root: ERROR: 'Close'
2023-06-01 20:35:35,455: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,455: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,455: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,455: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,456: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,456: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,456: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,456: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,457: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,457: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,457: root: ERROR: 'Close'
2023-06-01 20:35:35,457: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,458: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,458: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,458: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,458: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,459: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,459: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,459: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,459: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,460: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,460: root: ERROR: 'Close'
2023-06-01 20:35:35,460: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,460: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,461: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,461: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,461: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,461: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,462: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,462: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,462: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,462: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,463: root: ERROR: 'Close'
2023-06-01 20:35:35,463: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,463: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,463: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,463: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,464: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,464: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,464: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,464: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,465: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,465: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,466: root: ERROR: 'Close'
2023-06-01 20:35:35,466: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,469: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,470: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,470: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,471: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,471: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,472: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,472: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,472: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,472: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,473: root: ERROR: 'Close'
2023-06-01 20:35:35,473: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,473: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,474: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,474: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,474: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,474: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,475: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,475: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,475: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,475: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,476: root: ERROR: 'Close'
2023-06-01 20:35:35,476: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,477: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,477: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,477: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,478: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,478: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,478: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,479: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,479: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,479: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,481: root: ERROR: 'Close'
2023-06-01 20:35:35,482: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,482: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,483: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,483: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,484: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,484: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,484: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,484: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,485: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,485: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,485: root: ERROR: 'Close'
2023-06-01 20:35:35,486: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,488: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,489: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,490: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,490: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,490: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,491: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,491: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,491: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,491: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,492: root: ERROR: 'Close'
2023-06-01 20:35:35,492: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,493: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,495: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,495: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,496: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,496: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,496: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,497: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,497: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,497: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,498: root: ERROR: 'Close'
2023-06-01 20:35:35,498: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,500: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,502: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,502: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,503: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,503: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,504: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,504: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,504: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,504: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,505: root: ERROR: 'Close'
2023-06-01 20:35:35,505: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,506: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,507: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,507: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,508: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,508: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,509: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,509: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,509: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,509: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,510: root: ERROR: 'Close'
2023-06-01 20:35:35,510: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,510: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,511: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,511: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,511: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,512: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,512: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,512: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,513: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,513: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,513: root: ERROR: 'Close'
2023-06-01 20:35:35,514: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,514: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,514: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,514: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,515: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,515: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,516: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,516: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,516: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,516: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,517: root: ERROR: 'Close'
2023-06-01 20:35:35,517: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,519: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,521: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,521: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,522: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,522: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,522: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,522: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,523: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,523: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,524: root: ERROR: 'Close'
2023-06-01 20:35:35,524: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,524: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,525: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,525: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,525: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,525: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,526: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,526: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,526: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,526: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,527: root: ERROR: 'Close'
2023-06-01 20:35:35,527: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,527: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,528: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,529: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,529: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,529: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,530: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,530: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,530: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,530: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,531: root: ERROR: 'Close'
2023-06-01 20:35:35,531: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,531: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,532: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,532: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,532: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,532: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,533: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,533: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,533: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,533: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,534: root: ERROR: 'Close'
2023-06-01 20:35:35,534: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,534: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,535: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,535: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,535: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,536: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,536: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,536: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,536: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,537: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,537: root: ERROR: 'Close'
2023-06-01 20:35:35,537: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,537: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,538: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,538: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,538: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,539: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,539: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,539: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,539: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,539: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,540: root: ERROR: 'Close'
2023-06-01 20:35:35,540: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,540: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,541: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,541: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,541: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,541: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,542: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,542: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,542: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,542: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,543: root: ERROR: 'Close'
2023-06-01 20:35:35,543: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,543: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,543: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,543: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,544: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,544: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,544: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,544: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,545: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,545: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,545: root: ERROR: 'Close'
2023-06-01 20:35:35,546: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,546: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,546: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,546: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,546: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,547: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,547: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,547: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,548: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,548: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,548: root: ERROR: 'Close'
2023-06-01 20:35:35,548: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,549: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,550: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,550: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,550: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,550: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,551: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,551: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,551: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,551: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,552: root: ERROR: 'Close'
2023-06-01 20:35:35,552: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,552: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,553: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,553: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,553: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,553: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,554: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,554: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,554: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,554: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,555: root: ERROR: 'Close'
2023-06-01 20:35:35,555: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,555: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,555: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,555: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,556: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,556: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,556: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,556: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,557: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,557: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,557: root: ERROR: 'Close'
2023-06-01 20:35:35,558: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,558: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,558: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,558: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,558: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,559: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,559: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,559: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,560: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,560: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,560: root: ERROR: 'Close'
2023-06-01 20:35:35,560: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,560: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,561: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,561: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,561: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,561: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,562: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,562: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,562: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,562: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,563: root: ERROR: 'Close'
2023-06-01 20:35:35,563: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,563: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,564: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,564: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,564: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,564: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,565: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,565: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,565: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,565: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,566: root: ERROR: 'Close'
2023-06-01 20:35:35,566: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,566: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,566: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,567: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,567: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,567: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,568: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,568: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,568: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,568: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,569: root: ERROR: 'Close'
2023-06-01 20:35:35,569: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,570: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,570: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,570: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,570: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,571: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,571: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,571: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,571: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,572: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,572: root: ERROR: 'Close'
2023-06-01 20:35:35,572: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,572: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,573: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,573: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,573: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,573: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,574: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,574: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,574: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,574: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,575: root: ERROR: 'Close'
2023-06-01 20:35:35,575: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,575: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,575: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,576: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,576: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,576: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,577: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,577: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,577: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,577: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,578: root: ERROR: 'Close'
2023-06-01 20:35:35,578: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,578: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,578: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,578: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,579: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,579: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,579: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,579: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,580: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,580: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,580: root: ERROR: 'Close'
2023-06-01 20:35:35,580: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,581: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,581: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,581: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,582: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,582: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,582: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,582: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,583: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,583: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,583: root: ERROR: 'Close'
2023-06-01 20:35:35,584: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,584: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,584: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,584: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,585: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,585: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,586: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,586: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,587: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,587: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,587: root: ERROR: 'Close'
2023-06-01 20:35:35,587: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,588: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,588: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,588: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,589: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,589: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,589: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,589: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,590: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,590: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,590: root: ERROR: 'Close'
2023-06-01 20:35:35,590: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,590: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,591: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,591: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,591: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,592: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,592: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,592: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,592: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,592: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,593: root: ERROR: 'Close'
2023-06-01 20:35:35,593: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,593: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,594: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,594: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,594: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,594: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,595: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,595: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,595: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,595: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,596: root: ERROR: 'Close'
2023-06-01 20:35:35,596: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,596: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,596: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,596: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,597: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,597: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,597: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,597: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,598: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,598: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,599: root: ERROR: 'Close'
2023-06-01 20:35:35,599: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,599: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,599: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,600: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,600: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,600: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,601: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,601: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,601: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,602: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,602: root: ERROR: 'Close'
2023-06-01 20:35:35,602: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,603: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,603: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,603: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,603: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,604: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,604: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,604: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,604: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,605: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,605: root: ERROR: 'Close'
2023-06-01 20:35:35,605: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,605: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,606: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,606: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,606: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,606: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,607: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,607: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,607: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,607: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,608: root: ERROR: 'Close'
2023-06-01 20:35:35,608: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,608: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,609: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,609: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,609: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,609: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,610: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,610: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,610: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,610: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,611: root: ERROR: 'Close'
2023-06-01 20:35:35,611: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,611: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,612: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,612: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,612: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,612: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,613: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,613: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,613: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,613: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,614: root: ERROR: 'Close'
2023-06-01 20:35:35,614: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,614: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,614: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,614: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,615: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,615: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,616: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,616: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,616: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,616: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,617: root: ERROR: 'Close'
2023-06-01 20:35:35,617: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,617: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,618: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,618: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,618: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,619: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,619: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,619: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,620: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,620: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,620: root: ERROR: 'Close'
2023-06-01 20:35:35,621: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,621: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,621: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,621: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,622: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,622: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,622: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,622: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,623: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,623: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,623: root: ERROR: 'Close'
2023-06-01 20:35:35,623: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,623: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,624: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,624: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,624: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,625: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,625: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,625: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,625: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,626: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,626: root: ERROR: 'Close'
2023-06-01 20:35:35,626: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,626: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,627: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,627: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,627: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,627: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,628: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,628: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,628: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,628: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,629: root: ERROR: 'Close'
2023-06-01 20:35:35,629: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,629: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,629: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,629: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,630: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,630: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,630: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,630: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,631: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,631: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,631: root: ERROR: 'Close'
2023-06-01 20:35:35,632: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,632: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,632: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,632: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,633: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,633: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,634: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,634: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,634: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,634: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,635: root: ERROR: 'Close'
2023-06-01 20:35:35,635: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,636: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,636: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,636: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,637: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,637: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,638: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,638: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,638: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,638: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,639: root: ERROR: 'Close'
2023-06-01 20:35:35,639: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,639: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,639: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,639: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,640: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,640: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,641: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,641: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,641: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,641: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,642: root: ERROR: 'Close'
2023-06-01 20:35:35,642: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,642: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,642: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,642: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,643: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,643: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,643: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,643: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,644: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,644: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,644: root: ERROR: 'Close'
2023-06-01 20:35:35,644: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,644: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,645: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,645: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,645: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,645: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,646: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,646: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,646: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,646: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,647: root: ERROR: 'Close'
2023-06-01 20:35:35,647: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,647: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,647: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,647: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,648: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,648: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,649: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,649: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,649: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,649: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,650: root: ERROR: 'Close'
2023-06-01 20:35:35,650: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,650: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,651: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,651: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,651: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,652: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,652: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,652: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,653: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,653: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,654: root: ERROR: 'Close'
2023-06-01 20:35:35,654: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,654: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,654: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,654: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,655: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,655: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,655: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,656: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,656: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,656: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,656: root: ERROR: 'Close'
2023-06-01 20:35:35,657: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,657: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,657: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,657: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,658: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,658: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,658: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,658: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,659: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,659: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,659: root: ERROR: 'Close'
2023-06-01 20:35:35,659: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,660: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,660: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,660: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,660: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,661: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,661: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,661: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,661: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,662: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,662: root: ERROR: 'Close'
2023-06-01 20:35:35,662: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,662: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,663: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,663: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,663: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,663: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,664: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,664: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,664: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,665: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,665: root: ERROR: 'Close'
2023-06-01 20:35:35,665: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,666: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,666: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,666: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,667: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,667: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,667: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,668: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,668: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,668: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,669: root: ERROR: 'Close'
2023-06-01 20:35:35,669: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,669: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,670: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,670: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,670: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,671: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,671: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,671: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,671: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,671: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,672: root: ERROR: 'Close'
2023-06-01 20:35:35,672: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,672: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,673: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,673: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,673: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,673: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,674: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,674: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,674: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,674: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,675: root: ERROR: 'Close'
2023-06-01 20:35:35,675: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,675: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,675: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,675: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,676: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,676: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,676: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,676: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,677: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,677: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,677: root: ERROR: 'Close'
2023-06-01 20:35:35,678: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,678: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,678: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,678: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,679: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,679: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,679: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,679: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,680: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,680: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,680: root: ERROR: 'Close'
2023-06-01 20:35:35,680: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,680: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,681: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,681: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,681: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,682: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,682: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,682: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,682: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,682: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,683: root: ERROR: 'Close'
2023-06-01 20:35:35,683: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,683: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,684: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,684: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,684: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,685: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,685: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,685: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,686: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,686: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,687: root: ERROR: 'Close'
2023-06-01 20:35:35,687: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,687: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,687: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,687: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,688: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,688: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,688: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,688: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,689: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,689: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,689: root: ERROR: 'Close'
2023-06-01 20:35:35,689: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,690: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,690: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,690: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,690: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,691: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,691: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,691: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,691: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,691: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,692: root: ERROR: 'Close'
2023-06-01 20:35:35,692: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,692: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,693: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,693: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,693: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,693: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,694: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,694: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,694: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,694: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,695: root: ERROR: 'Close'
2023-06-01 20:35:35,695: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,695: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,695: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,695: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,696: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,696: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,696: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,696: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,697: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,697: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,697: root: ERROR: 'Close'
2023-06-01 20:35:35,697: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,698: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,698: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,698: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,698: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,699: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,699: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,699: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,700: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,700: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,701: root: ERROR: 'Close'
2023-06-01 20:35:35,701: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,701: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,702: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,702: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,702: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,702: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,703: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,703: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,703: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,703: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,704: root: ERROR: 'Close'
2023-06-01 20:35:35,704: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,704: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,704: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,705: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,705: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,705: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,705: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,705: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,706: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,706: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,706: root: ERROR: 'Close'
2023-06-01 20:35:35,707: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,707: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,707: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,707: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,708: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,708: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,708: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,708: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,708: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,709: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,709: root: ERROR: 'Close'
2023-06-01 20:35:35,709: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,709: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,710: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,710: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,710: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,710: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,711: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,711: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,711: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,711: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,712: root: ERROR: 'Close'
2023-06-01 20:35:35,712: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,712: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,712: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,712: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,713: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,713: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,713: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,713: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,714: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,714: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,714: root: ERROR: 'Close'
2023-06-01 20:35:35,714: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,715: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,715: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,715: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,716: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,716: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,717: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,717: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,717: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,717: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,718: root: ERROR: 'Close'
2023-06-01 20:35:35,718: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,718: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,719: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,719: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,719: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,719: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,720: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,720: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,720: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,720: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,721: root: ERROR: 'Close'
2023-06-01 20:35:35,721: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,721: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,721: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,721: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,722: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,722: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,722: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,722: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,723: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,723: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,723: root: ERROR: 'Close'
2023-06-01 20:35:35,723: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,724: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,724: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,724: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,724: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,725: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,725: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,725: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,725: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,726: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,726: root: ERROR: 'Close'
2023-06-01 20:35:35,726: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,726: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,727: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,727: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,727: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,727: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,728: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,728: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,728: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,728: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,729: root: ERROR: 'Close'
2023-06-01 20:35:35,729: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,729: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,729: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,729: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,730: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,730: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,730: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,731: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,731: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,731: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,732: root: ERROR: 'Close'
2023-06-01 20:35:35,732: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,732: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,733: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,733: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,733: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,733: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,734: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,734: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,734: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,734: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,735: root: ERROR: 'Close'
2023-06-01 20:35:35,735: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,735: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,736: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,736: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,736: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,736: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,737: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,737: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,737: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,737: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,738: root: ERROR: 'Close'
2023-06-01 20:35:35,738: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,738: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,738: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,739: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,739: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,739: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,740: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,740: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,740: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,740: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,741: root: ERROR: 'Close'
2023-06-01 20:35:35,741: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,741: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,741: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,741: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,742: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,742: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,742: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,742: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,743: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,743: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,743: root: ERROR: 'Close'
2023-06-01 20:35:35,743: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,743: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,744: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,744: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,744: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,744: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,745: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,745: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,745: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,745: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,746: root: ERROR: 'Close'
2023-06-01 20:35:35,746: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,746: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,746: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,746: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,747: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,747: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,747: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,747: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,748: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,748: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,748: root: ERROR: 'Close'
2023-06-01 20:35:35,749: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,749: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,750: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,750: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,750: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,750: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,751: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,751: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,751: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,751: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,752: root: ERROR: 'Close'
2023-06-01 20:35:35,752: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,752: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,752: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,752: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,753: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,753: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,753: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,753: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,754: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,754: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,754: root: ERROR: 'Close'
2023-06-01 20:35:35,754: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,755: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,755: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,755: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,755: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,756: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,756: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,756: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,756: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,757: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,757: root: ERROR: 'Close'
2023-06-01 20:35:35,757: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,757: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,758: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,758: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,758: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,758: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,759: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,759: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,759: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,759: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,760: root: ERROR: 'Close'
2023-06-01 20:35:35,760: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,760: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,760: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,760: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,761: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,761: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,761: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,761: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,762: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,762: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,762: root: ERROR: 'Close'
2023-06-01 20:35:35,762: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,762: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,763: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,763: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,763: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,763: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,764: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,764: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,764: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,764: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,765: root: ERROR: 'Close'
2023-06-01 20:35:35,765: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,765: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,766: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,766: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,766: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,767: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,767: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,767: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,768: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,768: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,768: root: ERROR: 'Close'
2023-06-01 20:35:35,769: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,769: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,769: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,769: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,770: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,770: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,770: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,770: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,771: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,771: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,771: root: ERROR: 'Close'
2023-06-01 20:35:35,771: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,772: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,772: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,772: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,772: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,773: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,773: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,773: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,773: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,773: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,774: root: ERROR: 'Close'
2023-06-01 20:35:35,774: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,774: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,775: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,775: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,775: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,775: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,776: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,776: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,776: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,776: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,777: root: ERROR: 'Close'
2023-06-01 20:35:35,777: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,777: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,777: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,777: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,778: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,778: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,778: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,778: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,779: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,779: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,779: root: ERROR: 'Close'
2023-06-01 20:35:35,779: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,780: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,780: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,780: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,780: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,781: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,781: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,781: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,782: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,782: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,783: root: ERROR: 'Close'
2023-06-01 20:35:35,783: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,783: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,783: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,783: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,784: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,784: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,784: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,785: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,785: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,785: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,785: root: ERROR: 'Close'
2023-06-01 20:35:35,786: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,786: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,786: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,786: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,787: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,787: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,787: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,787: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,788: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,788: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,788: root: ERROR: 'Close'
2023-06-01 20:35:35,788: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,788: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,789: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,789: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,789: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,790: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,790: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,790: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,790: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,790: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,791: root: ERROR: 'Close'
2023-06-01 20:35:35,791: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,791: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,791: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,792: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,792: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,792: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,793: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,793: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,793: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,793: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,793: root: ERROR: 'Close'
2023-06-01 20:35:35,794: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,794: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,794: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,794: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,795: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,795: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,795: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,795: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,796: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,796: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,796: root: ERROR: 'Close'
2023-06-01 20:35:35,796: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,796: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,797: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,797: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,797: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,797: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,798: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,798: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,798: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,798: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,799: root: ERROR: 'Close'
2023-06-01 20:35:35,799: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,799: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,800: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,800: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,800: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,801: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,801: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,801: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,802: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,802: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,803: root: ERROR: 'Close'
2023-06-01 20:35:35,803: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,804: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,805: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,805: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,805: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,805: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,806: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,806: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,806: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,806: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,807: root: ERROR: 'Close'
2023-06-01 20:35:35,807: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,810: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,810: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,810: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,811: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,811: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,812: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,812: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,812: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,812: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,813: root: ERROR: 'Close'
2023-06-01 20:35:35,813: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,818: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,821: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,821: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,822: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,822: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,823: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,823: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,824: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,824: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,824: root: ERROR: 'Close'
2023-06-01 20:35:35,825: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,827: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,827: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,828: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,828: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,828: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,829: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,829: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,829: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,829: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,830: root: ERROR: 'Close'
2023-06-01 20:35:35,830: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,834: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,836: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,836: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,836: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,837: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,837: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,837: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,838: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,838: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,838: root: ERROR: 'Close'
2023-06-01 20:35:35,838: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,841: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,842: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,842: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,843: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,843: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,844: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,844: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,844: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,844: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,845: root: ERROR: 'Close'
2023-06-01 20:35:35,845: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,846: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,846: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,846: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,847: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,847: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,848: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,848: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,848: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,848: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,849: root: ERROR: 'Close'
2023-06-01 20:35:35,849: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,849: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,850: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,850: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,851: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,851: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,851: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,851: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,852: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,852: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,853: root: ERROR: 'Close'
2023-06-01 20:35:35,853: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,853: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,854: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,854: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,854: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,855: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,855: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,855: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,855: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,856: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,856: root: ERROR: 'Close'
2023-06-01 20:35:35,857: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,857: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,857: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,857: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,858: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,858: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,859: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,859: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,859: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,859: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,860: root: ERROR: 'Close'
2023-06-01 20:35:35,860: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,861: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,862: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,862: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,863: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,863: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,863: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,863: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,864: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,864: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,865: root: ERROR: 'Close'
2023-06-01 20:35:35,865: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,865: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,867: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,867: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,867: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,868: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,868: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,868: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,869: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,869: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,869: root: ERROR: 'Close'
2023-06-01 20:35:35,870: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,870: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,870: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,870: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,871: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,871: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,872: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,872: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,872: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,872: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,873: root: ERROR: 'Close'
2023-06-01 20:35:35,873: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,873: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,873: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,873: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,874: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,874: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,874: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,875: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,875: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,875: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,875: root: ERROR: 'Close'
2023-06-01 20:35:35,876: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,876: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,876: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,876: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,877: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,877: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,877: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,877: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,878: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,878: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,878: root: ERROR: 'Close'
2023-06-01 20:35:35,879: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,879: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,879: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,879: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,880: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,880: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,880: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,880: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,881: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,881: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,881: root: ERROR: 'Close'
2023-06-01 20:35:35,881: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,882: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,882: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,882: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,883: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,883: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,884: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,884: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,884: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,884: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,885: root: ERROR: 'Close'
2023-06-01 20:35:35,885: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,885: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,885: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,886: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,886: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,886: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,887: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,887: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,887: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,887: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,888: root: ERROR: 'Close'
2023-06-01 20:35:35,888: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,888: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,888: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,888: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,889: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,889: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,889: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,889: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,890: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,890: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,890: root: ERROR: 'Close'
2023-06-01 20:35:35,890: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,891: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,891: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,891: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,892: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,892: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,892: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,892: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,893: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,893: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,893: root: ERROR: 'Close'
2023-06-01 20:35:35,893: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,893: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,894: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,894: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,894: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,895: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,895: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,895: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,895: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,895: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,896: root: ERROR: 'Close'
2023-06-01 20:35:35,896: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,896: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,897: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,897: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,897: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,898: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,898: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,898: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,898: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,899: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,899: root: ERROR: 'Close'
2023-06-01 20:35:35,899: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,899: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,900: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,900: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,900: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,901: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,901: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,901: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,902: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,902: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,902: root: ERROR: 'Close'
2023-06-01 20:35:35,902: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,903: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,903: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,903: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,903: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,904: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,904: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,904: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,904: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,905: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,905: root: ERROR: 'Close'
2023-06-01 20:35:35,905: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,905: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,906: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,906: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,906: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,906: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,907: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,907: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,907: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,907: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,908: root: ERROR: 'Close'
2023-06-01 20:35:35,908: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,908: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,908: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,909: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,909: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,909: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,910: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,910: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,910: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,910: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,910: root: ERROR: 'Close'
2023-06-01 20:35:35,911: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,911: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,911: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,911: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,911: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,912: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,912: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,912: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,912: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,913: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,913: root: ERROR: 'Close'
2023-06-01 20:35:35,913: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,913: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,914: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,914: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,914: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,915: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,915: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,915: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,916: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,916: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,916: root: ERROR: 'Close'
2023-06-01 20:35:35,916: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,917: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,917: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,917: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,918: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,918: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,918: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,918: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,919: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,919: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,919: root: ERROR: 'Close'
2023-06-01 20:35:35,919: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,919: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,920: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,920: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,920: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,920: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,921: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,921: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,921: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,921: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,922: root: ERROR: 'Close'
2023-06-01 20:35:35,922: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,922: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,922: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,922: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,923: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,923: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,923: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,923: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,924: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,924: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,924: root: ERROR: 'Close'
2023-06-01 20:35:35,924: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,924: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,925: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,925: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,925: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,925: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,926: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,926: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,926: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,926: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,927: root: ERROR: 'Close'
2023-06-01 20:35:35,927: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,927: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,927: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,927: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,928: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,928: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,928: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,928: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,929: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,929: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,929: root: ERROR: 'Close'
2023-06-01 20:35:35,929: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,929: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,930: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,930: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,930: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,931: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,931: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,931: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,932: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,932: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,932: root: ERROR: 'Close'
2023-06-01 20:35:35,933: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,933: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,933: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,933: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,934: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,934: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,934: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,934: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,935: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,935: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,935: root: ERROR: 'Close'
2023-06-01 20:35:35,936: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,936: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,936: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,936: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,937: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,937: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,937: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,937: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,938: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,938: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,938: root: ERROR: 'Close'
2023-06-01 20:35:35,938: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,939: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,939: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,939: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,940: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,940: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,940: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,940: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,940: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,941: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,941: root: ERROR: 'Close'
2023-06-01 20:35:35,941: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,941: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,942: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,942: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,942: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,942: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,943: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,943: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,943: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,943: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,944: root: ERROR: 'Close'
2023-06-01 20:35:35,944: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,944: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,945: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,945: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,945: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,945: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,946: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,946: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,946: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,946: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,946: root: ERROR: 'Close'
2023-06-01 20:35:35,947: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,947: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,947: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,947: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,948: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,948: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,949: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,949: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,949: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,949: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,950: root: ERROR: 'Close'
2023-06-01 20:35:35,950: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,950: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,951: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,951: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,951: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,951: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,952: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,952: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,952: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,952: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,953: root: ERROR: 'Close'
2023-06-01 20:35:35,953: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,953: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,953: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,954: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,954: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,954: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,955: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,955: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,955: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,955: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,956: root: ERROR: 'Close'
2023-06-01 20:35:35,956: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,956: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,956: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,956: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,957: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,957: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,957: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,957: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,958: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,958: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,958: root: ERROR: 'Close'
2023-06-01 20:35:35,959: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,959: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,959: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,959: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,960: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,960: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,960: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,960: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,961: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,961: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,961: root: ERROR: 'Close'
2023-06-01 20:35:35,961: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,962: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,962: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,962: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,962: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,963: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,963: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,963: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,963: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,963: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,964: root: ERROR: 'Close'
2023-06-01 20:35:35,964: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,964: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,965: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,965: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,966: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,966: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,966: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,966: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,967: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,967: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,967: root: ERROR: 'Close'
2023-06-01 20:35:35,968: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,968: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,969: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,969: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,969: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,969: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,970: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,970: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,970: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,970: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,971: root: ERROR: 'Close'
2023-06-01 20:35:35,971: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,971: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,972: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,972: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,972: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,972: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,973: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,973: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,973: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,973: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,974: root: ERROR: 'Close'
2023-06-01 20:35:35,974: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,974: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,974: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,975: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,975: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,975: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,976: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,976: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,976: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,976: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,977: root: ERROR: 'Close'
2023-06-01 20:35:35,977: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,977: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,977: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,977: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,978: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,978: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,978: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,978: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,979: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,979: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,979: root: ERROR: 'Close'
2023-06-01 20:35:35,979: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,979: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,980: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,980: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,980: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,981: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,981: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,981: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,982: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,982: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,983: root: ERROR: 'Close'
2023-06-01 20:35:35,983: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,983: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,983: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,983: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,984: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,984: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,985: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,985: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,986: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,986: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,986: root: ERROR: 'Close'
2023-06-01 20:35:35,986: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,987: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,987: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,987: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,987: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,988: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,988: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,988: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,988: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,989: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,989: root: ERROR: 'Close'
2023-06-01 20:35:35,989: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,989: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,990: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,990: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,990: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,990: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,991: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,991: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,991: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,991: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,992: root: ERROR: 'Close'
2023-06-01 20:35:35,992: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,992: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,993: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,993: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,993: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,993: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,994: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,994: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,994: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,994: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,995: root: ERROR: 'Close'
2023-06-01 20:35:35,995: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,995: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,995: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,995: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,996: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,996: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:35,996: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:35,996: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:35,997: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:35,997: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:35,997: root: ERROR: 'Close'
2023-06-01 20:35:35,998: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:35,998: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:35,999: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:35,999: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:35,999: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:35,999: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,000: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,000: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,000: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,000: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,001: root: ERROR: 'Close'
2023-06-01 20:35:36,001: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,001: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,002: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,002: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,003: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,003: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,003: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,003: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,004: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,004: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,004: root: ERROR: 'Close'
2023-06-01 20:35:36,005: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,005: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,005: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,005: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,006: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,006: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,007: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,007: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,007: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,007: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,008: root: ERROR: 'Close'
2023-06-01 20:35:36,008: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,008: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,009: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,009: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,010: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,010: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,010: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,010: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,011: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,011: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,012: root: ERROR: 'Close'
2023-06-01 20:35:36,012: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,012: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,013: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,013: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,014: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,014: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,014: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,015: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,015: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,015: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,016: root: ERROR: 'Close'
2023-06-01 20:35:36,016: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,017: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,018: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,019: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,019: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,019: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,020: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,020: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,020: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,021: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,021: root: ERROR: 'Close'
2023-06-01 20:35:36,021: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,022: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,022: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,022: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,023: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,023: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,023: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,023: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,024: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,024: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,025: root: ERROR: 'Close'
2023-06-01 20:35:36,025: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,026: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,026: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,026: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,027: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,027: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,027: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,027: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,028: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,028: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,028: root: ERROR: 'Close'
2023-06-01 20:35:36,029: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,029: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,029: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,029: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,030: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,030: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,031: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,031: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,031: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,031: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,032: root: ERROR: 'Close'
2023-06-01 20:35:36,032: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,033: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,034: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,034: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,035: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,035: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,037: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,037: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,037: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,037: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,038: root: ERROR: 'Close'
2023-06-01 20:35:36,038: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,038: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,039: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,039: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,040: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,040: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,040: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,040: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,041: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,041: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,041: root: ERROR: 'Close'
2023-06-01 20:35:36,042: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,042: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,042: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,043: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,043: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,043: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,044: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,044: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,044: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,044: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,045: root: ERROR: 'Close'
2023-06-01 20:35:36,045: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,045: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,045: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,045: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,046: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,046: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,047: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,047: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,047: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,047: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,048: root: ERROR: 'Close'
2023-06-01 20:35:36,048: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,048: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,049: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,049: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,049: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,050: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,050: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,050: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,050: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,051: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,051: root: ERROR: 'Close'
2023-06-01 20:35:36,051: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,051: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,052: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,052: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,052: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,053: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,053: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,053: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,053: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,054: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,054: root: ERROR: 'Close'
2023-06-01 20:35:36,054: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,054: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,055: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,055: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,055: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,056: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,056: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,056: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,056: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,056: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,057: root: ERROR: 'Close'
2023-06-01 20:35:36,057: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,057: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,058: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,058: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,058: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,058: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,059: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,059: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,059: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,059: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,060: root: ERROR: 'Close'
2023-06-01 20:35:36,060: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,060: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,060: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,060: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,061: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,061: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,061: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,061: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,062: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,062: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,062: root: ERROR: 'Close'
2023-06-01 20:35:36,062: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,062: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,063: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,063: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,063: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,064: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,064: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,064: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,064: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,065: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,065: root: ERROR: 'Close'
2023-06-01 20:35:36,066: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,066: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,067: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,067: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,067: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,067: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,068: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,068: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,068: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,068: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,069: root: ERROR: 'Close'
2023-06-01 20:35:36,069: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,069: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,070: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,070: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,070: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,070: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,071: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,071: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,071: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,071: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,072: root: ERROR: 'Close'
2023-06-01 20:35:36,072: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,072: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,072: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,072: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,073: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,073: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,073: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,073: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,074: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,074: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,074: root: ERROR: 'Close'
2023-06-01 20:35:36,074: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,075: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,075: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,075: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,076: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,076: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,076: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,076: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,077: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,077: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,077: root: ERROR: 'Close'
2023-06-01 20:35:36,077: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,077: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,078: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,078: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,078: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,078: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,079: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,079: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,079: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,079: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,080: root: ERROR: 'Close'
2023-06-01 20:35:36,080: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,080: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,081: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,081: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,081: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,082: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,082: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,082: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,082: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,083: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,083: root: ERROR: 'Close'
2023-06-01 20:35:36,083: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,083: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,084: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,084: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,084: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,085: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,085: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,085: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,086: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,086: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,086: root: ERROR: 'Close'
2023-06-01 20:35:36,086: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,087: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,087: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,087: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,088: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,088: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,088: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,088: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,089: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,089: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,089: root: ERROR: 'Close'
2023-06-01 20:35:36,089: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,090: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,090: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,090: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,090: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,091: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,091: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,091: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,091: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,092: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,092: root: ERROR: 'Close'
2023-06-01 20:35:36,092: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,092: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,093: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,093: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,093: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,093: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,094: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,094: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,094: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,094: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,095: root: ERROR: 'Close'
2023-06-01 20:35:36,095: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,095: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,095: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,095: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,096: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,096: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,096: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,096: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,097: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,097: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,098: root: ERROR: 'Close'
2023-06-01 20:35:36,098: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,098: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,099: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,099: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,099: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,099: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,100: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,100: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,100: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,100: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,101: root: ERROR: 'Close'
2023-06-01 20:35:36,101: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,101: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,102: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,102: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,103: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,103: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,103: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,103: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,104: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,104: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,104: root: ERROR: 'Close'
2023-06-01 20:35:36,104: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,105: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,105: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,105: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,105: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,106: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,106: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,106: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,106: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,107: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,107: root: ERROR: 'Close'
2023-06-01 20:35:36,107: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,107: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,108: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,108: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,108: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,108: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,109: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,109: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,109: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,109: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,110: root: ERROR: 'Close'
2023-06-01 20:35:36,110: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,110: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,110: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,110: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,111: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,111: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,111: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,111: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,112: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,112: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,112: root: ERROR: 'Close'
2023-06-01 20:35:36,112: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,113: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,113: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,113: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,113: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,114: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,114: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,114: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,115: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,115: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,116: root: ERROR: 'Close'
2023-06-01 20:35:36,116: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,116: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,117: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,117: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,117: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,117: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,118: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,118: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,118: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,118: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,119: root: ERROR: 'Close'
2023-06-01 20:35:36,119: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,119: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,119: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,119: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,120: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,120: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,121: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,121: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,121: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,121: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,121: root: ERROR: 'Close'
2023-06-01 20:35:36,122: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,122: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,122: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,122: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,123: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,123: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,123: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,123: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,124: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,124: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,124: root: ERROR: 'Close'
2023-06-01 20:35:36,124: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,124: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,125: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,125: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,125: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,125: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,126: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,126: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,126: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,126: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,127: root: ERROR: 'Close'
2023-06-01 20:35:36,127: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,127: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,127: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,127: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,128: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,128: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,128: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,128: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,129: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,129: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,129: root: ERROR: 'Close'
2023-06-01 20:35:36,130: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,130: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,130: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,130: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,131: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,131: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,132: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,132: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,132: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,133: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,134: root: ERROR: 'Close'
2023-06-01 20:35:36,134: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,134: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,135: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,135: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,136: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,136: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,136: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,136: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,137: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,137: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,137: root: ERROR: 'Close'
2023-06-01 20:35:36,138: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,138: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,138: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,138: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,139: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,139: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,139: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,139: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,140: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,140: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,140: root: ERROR: 'Close'
2023-06-01 20:35:36,140: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,140: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,141: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,141: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,141: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,141: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,142: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,142: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,142: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,142: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,143: root: ERROR: 'Close'
2023-06-01 20:35:36,143: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,143: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,143: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,144: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,144: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,144: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,145: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,145: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,145: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,145: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,145: root: ERROR: 'Close'
2023-06-01 20:35:36,146: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,146: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,146: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,146: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,147: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,147: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,147: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,148: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,148: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,148: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,149: root: ERROR: 'Close'
2023-06-01 20:35:36,149: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,149: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,149: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,150: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,150: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,150: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,151: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,151: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,151: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,151: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,152: root: ERROR: 'Close'
2023-06-01 20:35:36,152: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,152: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,153: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,153: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,153: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,153: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,154: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,154: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,154: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,155: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,155: root: ERROR: 'Close'
2023-06-01 20:35:36,155: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,156: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,158: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,158: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,159: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,159: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,160: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,160: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,160: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,161: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,161: root: ERROR: 'Close'
2023-06-01 20:35:36,161: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,163: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,165: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,165: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,165: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,166: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,166: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,166: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,167: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,167: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,167: root: ERROR: 'Close'
2023-06-01 20:35:36,168: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,169: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,170: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,170: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,170: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,171: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,171: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,171: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,172: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,172: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,172: root: ERROR: 'Close'
2023-06-01 20:35:36,173: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,174: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,176: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,176: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,176: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,177: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,177: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,177: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,178: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,178: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,179: root: ERROR: 'Close'
2023-06-01 20:35:36,179: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,180: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,181: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,181: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,181: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,182: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,182: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,182: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,182: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,182: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,183: root: ERROR: 'Close'
2023-06-01 20:35:36,183: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,185: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,187: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,187: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,187: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,188: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,188: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,188: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,189: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,189: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,189: root: ERROR: 'Close'
2023-06-01 20:35:36,190: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,191: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,193: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,193: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,193: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,194: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,194: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,194: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,194: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,195: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,195: root: ERROR: 'Close'
2023-06-01 20:35:36,195: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,197: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,198: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,198: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,198: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,199: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,199: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,199: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,200: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,200: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,200: root: ERROR: 'Close'
2023-06-01 20:35:36,201: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,201: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,201: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,201: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,202: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,202: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,203: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,203: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,203: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,203: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,204: root: ERROR: 'Close'
2023-06-01 20:35:36,204: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,205: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,206: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,206: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,206: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,207: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,207: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,207: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,208: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,208: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,208: root: ERROR: 'Close'
2023-06-01 20:35:36,209: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,209: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,210: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,210: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,210: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,210: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,211: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,211: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,211: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,211: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,212: root: ERROR: 'Close'
2023-06-01 20:35:36,212: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,212: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,214: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,214: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,214: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,215: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,215: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,215: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,216: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,216: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,216: root: ERROR: 'Close'
2023-06-01 20:35:36,217: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,217: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,218: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,218: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,218: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,218: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,219: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,219: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,219: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,220: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,220: root: ERROR: 'Close'
2023-06-01 20:35:36,220: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,220: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,221: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,221: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,221: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,222: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,222: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,222: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,222: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,222: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,223: root: ERROR: 'Close'
2023-06-01 20:35:36,223: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,223: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,224: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,224: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,224: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,224: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,225: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,225: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,225: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,225: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,226: root: ERROR: 'Close'
2023-06-01 20:35:36,226: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,226: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,226: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,226: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,227: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,227: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,227: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,227: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,228: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,228: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,228: root: ERROR: 'Close'
2023-06-01 20:35:36,228: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,229: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,229: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,229: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,229: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,230: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,230: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,230: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,230: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,231: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,231: root: ERROR: 'Close'
2023-06-01 20:35:36,231: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,231: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,232: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,232: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,233: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,233: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,233: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,233: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,234: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,234: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,235: root: ERROR: 'Close'
2023-06-01 20:35:36,235: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,235: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,236: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,236: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,236: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,236: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,237: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,237: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,237: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,237: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,238: root: ERROR: 'Close'
2023-06-01 20:35:36,238: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,238: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,238: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,239: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,239: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,239: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,240: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,240: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,240: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,240: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,241: root: ERROR: 'Close'
2023-06-01 20:35:36,241: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,241: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,241: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,241: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,242: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,242: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,242: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,242: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,243: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,243: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,243: root: ERROR: 'Close'
2023-06-01 20:35:36,243: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,243: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,244: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,244: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,244: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,245: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,245: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,245: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,245: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,246: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,246: root: ERROR: 'Close'
2023-06-01 20:35:36,246: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,246: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,247: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,247: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,248: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,248: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,248: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,248: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,249: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,249: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,250: root: ERROR: 'Close'
2023-06-01 20:35:36,250: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,250: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,250: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,250: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,251: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,251: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,252: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,252: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,252: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,252: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,253: root: ERROR: 'Close'
2023-06-01 20:35:36,253: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,253: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,254: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,254: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,254: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,254: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,255: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,255: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,255: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,255: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,256: root: ERROR: 'Close'
2023-06-01 20:35:36,256: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,256: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,256: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,256: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,257: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,257: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,257: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,257: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,258: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,258: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,258: root: ERROR: 'Close'
2023-06-01 20:35:36,258: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,259: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,259: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,259: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,259: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,260: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,260: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,260: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,260: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,261: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,261: root: ERROR: 'Close'
2023-06-01 20:35:36,261: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,261: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,262: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,262: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,262: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,262: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,263: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,263: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,263: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,263: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,264: root: ERROR: 'Close'
2023-06-01 20:35:36,264: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,264: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,265: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,265: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,265: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,266: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,266: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,266: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,266: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,267: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,267: root: ERROR: 'Close'
2023-06-01 20:35:36,268: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,268: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,268: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,268: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,269: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,269: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,269: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,269: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,270: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,270: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,270: root: ERROR: 'Close'
2023-06-01 20:35:36,271: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,271: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,271: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,271: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,271: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,272: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,272: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,272: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,272: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,273: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,273: root: ERROR: 'Close'
2023-06-01 20:35:36,273: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,273: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,274: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,274: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,274: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,274: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,275: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,275: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,275: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,275: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,276: root: ERROR: 'Close'
2023-06-01 20:35:36,276: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,276: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,276: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,276: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,277: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,277: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,277: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,277: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,278: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,278: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,278: root: ERROR: 'Close'
2023-06-01 20:35:36,278: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,279: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,279: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,279: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,279: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,280: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,280: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,280: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,280: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,280: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,281: root: ERROR: 'Close'
2023-06-01 20:35:36,281: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,281: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,282: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,282: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,283: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,283: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,283: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,283: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,284: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,284: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,284: root: ERROR: 'Close'
2023-06-01 20:35:36,285: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,285: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,285: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,285: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,286: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,286: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,286: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,286: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,287: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,287: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,287: root: ERROR: 'Close'
2023-06-01 20:35:36,287: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,288: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,288: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,288: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,288: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,289: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,289: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,289: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,289: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,289: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,290: root: ERROR: 'Close'
2023-06-01 20:35:36,290: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,290: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,291: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,291: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,291: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,291: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,292: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,292: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,292: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,292: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,293: root: ERROR: 'Close'
2023-06-01 20:35:36,293: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,293: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,293: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,293: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,294: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,294: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,294: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,294: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,295: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,295: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,295: root: ERROR: 'Close'
2023-06-01 20:35:36,295: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,296: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,296: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,296: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,296: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,297: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,297: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,297: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,297: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,298: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,298: root: ERROR: 'Close'
2023-06-01 20:35:36,298: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,299: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,299: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,299: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,300: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,300: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,300: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,300: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,301: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,301: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,301: root: ERROR: 'Close'
2023-06-01 20:35:36,301: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,302: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,302: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,302: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,303: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,303: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,303: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,303: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,304: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,304: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,304: root: ERROR: 'Close'
2023-06-01 20:35:36,304: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,305: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,305: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,305: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,305: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,306: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,306: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,306: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,306: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,306: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,307: root: ERROR: 'Close'
2023-06-01 20:35:36,307: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,307: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,308: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,308: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,308: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,308: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,309: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,309: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,309: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,309: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,310: root: ERROR: 'Close'
2023-06-01 20:35:36,310: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,310: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,310: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,310: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,311: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,311: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,311: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,311: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,312: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,312: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,312: root: ERROR: 'Close'
2023-06-01 20:35:36,312: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,313: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,313: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,313: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,314: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,314: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,314: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,314: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,315: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,315: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,316: root: ERROR: 'Close'
2023-06-01 20:35:36,316: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,316: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,317: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,317: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,317: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,317: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,318: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,318: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,318: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,318: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,319: root: ERROR: 'Close'
2023-06-01 20:35:36,319: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,319: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,319: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,319: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,320: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,320: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,320: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,320: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,321: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,321: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,321: root: ERROR: 'Close'
2023-06-01 20:35:36,322: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,322: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,322: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,322: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,322: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,323: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,323: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,323: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,324: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,324: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,324: root: ERROR: 'Close'
2023-06-01 20:35:36,324: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,324: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,325: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,325: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,325: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,326: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,326: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,326: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,326: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,327: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,327: root: ERROR: 'Close'
2023-06-01 20:35:36,327: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,327: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,328: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,328: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,328: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,328: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,329: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,329: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,329: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,329: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,330: root: ERROR: 'Close'
2023-06-01 20:35:36,330: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,330: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,330: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,331: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,331: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,331: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,332: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,332: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,332: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,332: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,333: root: ERROR: 'Close'
2023-06-01 20:35:36,333: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,333: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,334: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,334: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,334: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,335: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,335: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,335: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,336: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,336: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,336: root: ERROR: 'Close'
2023-06-01 20:35:36,337: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,337: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,337: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,337: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,338: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,338: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,338: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,338: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,339: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,339: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,339: root: ERROR: 'Close'
2023-06-01 20:35:36,339: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,339: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,340: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,340: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,340: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,340: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,341: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,341: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,341: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,341: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,342: root: ERROR: 'Close'
2023-06-01 20:35:36,342: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,342: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,342: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,342: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,343: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,343: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,343: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,343: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,344: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,344: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,344: root: ERROR: 'Close'
2023-06-01 20:35:36,344: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,345: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,345: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,345: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,345: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,346: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,346: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,346: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,346: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,346: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,347: root: ERROR: 'Close'
2023-06-01 20:35:36,347: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,348: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,348: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,348: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,349: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,349: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,350: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,350: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,350: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,350: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,351: root: ERROR: 'Close'
2023-06-01 20:35:36,351: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,351: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,352: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,352: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,352: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,353: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,353: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,353: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,353: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,354: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,354: root: ERROR: 'Close'
2023-06-01 20:35:36,354: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,354: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,355: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,355: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,355: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,356: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,356: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,356: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,356: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,356: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,357: root: ERROR: 'Close'
2023-06-01 20:35:36,357: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,357: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,358: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,358: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,358: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,358: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,359: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,359: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,359: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,359: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,360: root: ERROR: 'Close'
2023-06-01 20:35:36,360: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,360: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,360: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,360: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,361: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,361: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,361: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,361: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,362: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,362: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,362: root: ERROR: 'Close'
2023-06-01 20:35:36,362: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,362: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,363: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,363: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,363: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,364: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,364: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,364: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,364: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,364: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,365: root: ERROR: 'Close'
2023-06-01 20:35:36,365: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,366: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,366: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,366: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,367: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,367: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,367: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,367: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,368: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,368: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,368: root: ERROR: 'Close'
2023-06-01 20:35:36,369: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,369: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,369: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,369: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,370: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,370: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,370: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,370: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,371: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,371: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,371: root: ERROR: 'Close'
2023-06-01 20:35:36,371: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,371: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,372: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,372: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,372: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,373: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,373: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,373: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,373: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,373: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,374: root: ERROR: 'Close'
2023-06-01 20:35:36,374: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,374: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,375: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,375: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,375: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,375: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,376: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,376: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,376: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,376: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,377: root: ERROR: 'Close'
2023-06-01 20:35:36,377: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,377: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,377: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,377: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,378: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,378: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,378: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,378: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,379: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,379: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,379: root: ERROR: 'Close'
2023-06-01 20:35:36,380: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,380: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,380: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,380: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,381: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,381: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,381: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,381: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,382: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,382: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,383: root: ERROR: 'Close'
2023-06-01 20:35:36,383: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,383: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,384: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,384: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,384: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,384: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,385: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,385: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,385: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,385: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,386: root: ERROR: 'Close'
2023-06-01 20:35:36,386: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,386: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,386: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,387: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,387: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,387: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,388: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,388: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,388: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,388: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,388: root: ERROR: 'Close'
2023-06-01 20:35:36,389: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,389: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,389: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,389: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,390: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,390: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,390: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,390: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,390: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,391: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,391: root: ERROR: 'Close'
2023-06-01 20:35:36,391: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,391: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,392: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,392: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,392: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,392: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,393: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,393: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,393: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,393: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,394: root: ERROR: 'Close'
2023-06-01 20:35:36,394: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,394: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,394: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,394: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,395: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,395: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,395: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,395: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,396: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,396: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,396: root: ERROR: 'Close'
2023-06-01 20:35:36,396: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,397: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,397: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,397: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,398: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,398: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,398: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,398: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,399: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,399: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,399: root: ERROR: 'Close'
2023-06-01 20:35:36,400: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,400: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,400: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,400: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,401: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,401: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,402: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,402: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,402: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,402: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,403: root: ERROR: 'Close'
2023-06-01 20:35:36,403: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,403: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,403: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,403: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,404: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,404: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,404: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,404: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,405: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,405: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,405: root: ERROR: 'Close'
2023-06-01 20:35:36,405: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,406: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,406: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,406: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,406: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,407: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,407: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,407: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,407: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,407: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,408: root: ERROR: 'Close'
2023-06-01 20:35:36,408: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,408: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,409: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,409: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,409: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,409: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,410: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,410: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,410: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,410: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,411: root: ERROR: 'Close'
2023-06-01 20:35:36,411: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,411: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,411: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,411: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,412: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,412: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,412: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,412: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,413: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,413: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,413: root: ERROR: 'Close'
2023-06-01 20:35:36,413: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,413: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,414: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,414: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,415: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,415: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,416: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,416: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,416: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,416: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,417: root: ERROR: 'Close'
2023-06-01 20:35:36,417: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,417: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,417: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,418: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,418: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,418: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,419: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,419: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,419: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,419: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,420: root: ERROR: 'Close'
2023-06-01 20:35:36,420: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,420: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,421: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,421: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,421: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,421: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,422: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,422: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,422: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,422: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,423: root: ERROR: 'Close'
2023-06-01 20:35:36,423: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,423: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,423: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,423: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,424: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,424: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,424: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,424: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,425: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,425: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,425: root: ERROR: 'Close'
2023-06-01 20:35:36,425: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,426: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,426: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,426: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,426: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,427: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,427: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,427: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,427: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,427: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,428: root: ERROR: 'Close'
2023-06-01 20:35:36,428: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,428: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,429: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,429: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,429: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,429: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,430: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,430: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,430: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,431: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,431: root: ERROR: 'Close'
2023-06-01 20:35:36,431: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,432: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,432: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,432: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,432: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,433: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,433: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,433: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,434: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,434: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,434: root: ERROR: 'Close'
2023-06-01 20:35:36,435: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,435: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,435: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,435: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,436: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,436: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,436: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,436: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,437: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,437: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,437: root: ERROR: 'Close'
2023-06-01 20:35:36,437: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,438: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,438: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,438: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,438: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,439: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,439: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,439: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,439: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,439: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,440: root: ERROR: 'Close'
2023-06-01 20:35:36,440: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,440: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,441: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,441: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,441: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,441: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,442: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,442: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,442: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,442: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,443: root: ERROR: 'Close'
2023-06-01 20:35:36,443: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,443: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,443: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,443: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,444: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,444: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,444: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,444: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,445: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,445: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,445: root: ERROR: 'Close'
2023-06-01 20:35:36,445: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,445: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,446: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,446: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,446: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,447: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,447: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,447: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,447: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,448: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,448: root: ERROR: 'Close'
2023-06-01 20:35:36,449: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,449: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,449: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,450: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,450: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,450: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,451: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,451: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,451: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,451: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,452: root: ERROR: 'Close'
2023-06-01 20:35:36,452: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,452: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,452: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,452: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,453: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,453: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,453: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,453: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,454: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,454: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,454: root: ERROR: 'Close'
2023-06-01 20:35:36,454: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,455: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,455: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,455: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,456: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,456: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,456: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,456: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,457: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,457: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,457: root: ERROR: 'Close'
2023-06-01 20:35:36,457: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,457: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,458: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,458: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,458: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,459: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,459: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,459: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,459: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,459: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,460: root: ERROR: 'Close'
2023-06-01 20:35:36,460: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,460: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,461: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,461: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,461: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,461: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,462: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,462: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,462: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,462: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,463: root: ERROR: 'Close'
2023-06-01 20:35:36,463: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,465: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,467: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,467: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,468: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,468: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,469: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,469: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,469: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,469: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,470: root: ERROR: 'Close'
2023-06-01 20:35:36,470: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,472: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,474: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,474: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,474: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,475: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,475: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,475: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,475: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,476: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,476: root: ERROR: 'Close'
2023-06-01 20:35:36,476: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,477: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,478: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,478: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,479: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,479: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,479: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,479: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,480: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,480: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,481: root: ERROR: 'Close'
2023-06-01 20:35:36,481: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,484: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,485: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,485: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,485: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,486: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,486: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,486: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,487: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,487: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,487: root: ERROR: 'Close'
2023-06-01 20:35:36,488: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,489: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,491: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,491: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,491: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,492: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,492: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,492: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,492: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,493: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,493: root: ERROR: 'Close'
2023-06-01 20:35:36,494: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,494: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,497: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,497: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,497: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,498: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,498: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,498: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,498: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,499: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,499: root: ERROR: 'Close'
2023-06-01 20:35:36,499: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,501: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,502: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,502: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,503: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,503: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,503: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,503: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,504: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,504: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,505: root: ERROR: 'Close'
2023-06-01 20:35:36,505: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,506: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,507: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,507: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,507: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,508: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,508: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,508: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,509: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,509: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,509: root: ERROR: 'Close'
2023-06-01 20:35:36,509: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,510: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,510: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,510: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,511: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,511: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,511: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,511: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,512: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,512: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,513: root: ERROR: 'Close'
2023-06-01 20:35:36,513: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,513: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,515: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,516: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,516: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,517: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,517: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,517: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,517: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,518: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,518: root: ERROR: 'Close'
2023-06-01 20:35:36,518: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,519: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,520: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,520: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,521: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,521: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,522: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,522: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,522: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,522: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,523: root: ERROR: 'Close'
2023-06-01 20:35:36,523: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,524: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,524: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,525: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,525: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,525: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,526: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,526: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,526: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,526: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,527: root: ERROR: 'Close'
2023-06-01 20:35:36,527: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,527: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,528: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,528: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,528: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,528: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,529: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,529: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,529: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,529: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,530: root: ERROR: 'Close'
2023-06-01 20:35:36,530: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,530: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,530: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,531: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,531: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,531: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,532: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,532: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,532: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,532: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,533: root: ERROR: 'Close'
2023-06-01 20:35:36,533: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,533: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,534: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,534: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,534: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,535: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,535: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,535: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,536: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,536: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,536: root: ERROR: 'Close'
2023-06-01 20:35:36,536: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,537: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,537: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,537: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,537: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,538: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,538: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,538: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,538: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,539: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,539: root: ERROR: 'Close'
2023-06-01 20:35:36,539: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,539: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,540: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,540: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,540: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,541: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,541: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,541: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,541: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,541: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,542: root: ERROR: 'Close'
2023-06-01 20:35:36,542: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,542: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,543: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,543: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,543: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,543: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,544: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,544: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,544: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,544: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,545: root: ERROR: 'Close'
2023-06-01 20:35:36,545: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,545: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,545: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,545: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,546: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,546: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,546: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,546: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,547: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,547: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,547: root: ERROR: 'Close'
2023-06-01 20:35:36,547: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,548: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,548: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,548: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,549: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,549: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,550: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,550: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,550: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,550: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,551: root: ERROR: 'Close'
2023-06-01 20:35:36,551: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,551: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,552: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,552: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,552: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,552: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,553: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,553: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,553: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,553: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,554: root: ERROR: 'Close'
2023-06-01 20:35:36,554: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,554: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,554: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,554: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,555: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,555: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,555: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,555: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,556: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,556: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,556: root: ERROR: 'Close'
2023-06-01 20:35:36,556: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,557: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,557: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,557: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,557: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,558: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,558: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,558: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,558: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,559: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,559: root: ERROR: 'Close'
2023-06-01 20:35:36,559: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,559: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,560: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,560: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,560: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,560: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,561: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,561: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,561: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,561: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,562: root: ERROR: 'Close'
2023-06-01 20:35:36,562: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,562: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,562: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,562: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,563: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,563: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,563: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,563: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,564: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,564: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,564: root: ERROR: 'Close'
2023-06-01 20:35:36,565: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,565: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,565: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,565: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,566: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,566: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,567: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,567: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,567: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,567: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,568: root: ERROR: 'Close'
2023-06-01 20:35:36,568: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,568: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,569: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,569: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,569: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,569: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,570: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,570: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,570: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,570: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,571: root: ERROR: 'Close'
2023-06-01 20:35:36,571: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,571: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,572: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,572: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,572: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,572: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,573: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,573: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,573: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,573: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,574: root: ERROR: 'Close'
2023-06-01 20:35:36,574: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,574: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,574: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,574: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,575: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,575: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,575: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,575: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,576: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,576: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,576: root: ERROR: 'Close'
2023-06-01 20:35:36,576: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,577: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,577: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,577: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,578: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,578: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,578: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,578: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,579: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,579: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,579: root: ERROR: 'Close'
2023-06-01 20:35:36,579: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,579: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,580: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,580: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,580: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,580: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,581: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,581: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,581: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,581: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,582: root: ERROR: 'Close'
2023-06-01 20:35:36,582: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,582: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,583: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,583: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,583: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,584: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,584: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,584: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,585: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,585: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,585: root: ERROR: 'Close'
2023-06-01 20:35:36,585: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,586: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,586: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,586: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,586: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,587: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,587: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,587: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,587: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,587: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,588: root: ERROR: 'Close'
2023-06-01 20:35:36,588: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,588: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,589: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,589: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,589: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,589: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,590: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,590: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,590: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,590: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,591: root: ERROR: 'Close'
2023-06-01 20:35:36,591: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,591: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,591: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,591: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,592: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,592: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,592: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,592: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,593: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,593: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,593: root: ERROR: 'Close'
2023-06-01 20:35:36,593: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,594: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,594: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,594: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,594: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,595: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,595: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,595: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,595: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,595: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,596: root: ERROR: 'Close'
2023-06-01 20:35:36,596: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,596: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,597: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,597: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,597: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,597: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,598: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,598: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,598: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,599: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,599: root: ERROR: 'Close'
2023-06-01 20:35:36,599: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,599: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,600: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,600: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,600: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,601: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,601: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,601: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,602: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,602: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,602: root: ERROR: 'Close'
2023-06-01 20:35:36,603: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,603: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,603: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,603: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,604: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,604: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,604: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,604: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,605: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,605: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,605: root: ERROR: 'Close'
2023-06-01 20:35:36,605: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,605: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,606: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,606: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,606: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,607: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,607: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,607: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,607: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,607: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,608: root: ERROR: 'Close'
2023-06-01 20:35:36,608: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,608: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,609: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,609: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,609: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,609: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,610: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,610: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,610: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,610: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,611: root: ERROR: 'Close'
2023-06-01 20:35:36,611: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,611: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,611: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,611: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,612: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,612: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,612: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,612: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,613: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,613: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,613: root: ERROR: 'Close'
2023-06-01 20:35:36,613: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,614: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,614: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,614: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,615: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,615: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,616: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,616: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,616: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,616: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,617: root: ERROR: 'Close'
2023-06-01 20:35:36,617: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,617: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,618: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,618: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,618: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,618: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,619: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,619: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,619: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,619: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,620: root: ERROR: 'Close'
2023-06-01 20:35:36,620: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,620: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,621: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,621: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,621: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,621: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,622: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,622: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,622: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,622: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,623: root: ERROR: 'Close'
2023-06-01 20:35:36,623: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,623: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,623: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,624: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,624: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,624: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,624: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,624: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,625: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,625: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,625: root: ERROR: 'Close'
2023-06-01 20:35:36,626: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,626: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,626: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,626: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,627: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,627: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,627: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,627: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,628: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,628: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,628: root: ERROR: 'Close'
2023-06-01 20:35:36,628: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,628: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,629: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,629: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,629: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,630: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,630: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,630: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,631: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,631: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,631: root: ERROR: 'Close'
2023-06-01 20:35:36,632: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,632: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,632: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,632: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,633: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,633: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,633: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,633: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,634: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,634: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,635: root: ERROR: 'Close'
2023-06-01 20:35:36,635: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,635: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,636: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,636: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,636: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,636: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,637: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,637: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,637: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,637: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,638: root: ERROR: 'Close'
2023-06-01 20:35:36,638: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,638: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,638: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,638: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,639: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,639: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,639: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,639: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,640: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,640: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,640: root: ERROR: 'Close'
2023-06-01 20:35:36,640: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,641: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,641: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,641: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,642: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,642: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,642: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,642: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,643: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,643: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,643: root: ERROR: 'Close'
2023-06-01 20:35:36,643: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,643: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,644: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,644: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,644: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,645: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,645: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,645: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,645: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,645: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,646: root: ERROR: 'Close'
2023-06-01 20:35:36,646: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,646: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,647: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,647: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,647: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,648: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,648: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,648: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,649: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,649: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,649: root: ERROR: 'Close'
2023-06-01 20:35:36,650: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,650: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,650: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,651: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,651: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,651: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,652: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,652: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,652: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,652: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,653: root: ERROR: 'Close'
2023-06-01 20:35:36,653: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,653: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,654: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,654: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,654: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,654: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,655: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,655: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,655: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,655: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,656: root: ERROR: 'Close'
2023-06-01 20:35:36,656: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,656: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,657: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,657: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,657: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,657: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,658: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,658: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,658: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,658: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,659: root: ERROR: 'Close'
2023-06-01 20:35:36,659: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,659: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,660: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,660: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,660: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,660: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,661: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,661: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,661: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,661: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,662: root: ERROR: 'Close'
2023-06-01 20:35:36,662: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,662: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,662: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,662: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,663: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,663: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,664: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,664: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,664: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,664: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,665: root: ERROR: 'Close'
2023-06-01 20:35:36,665: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,665: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,666: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,666: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,666: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,667: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,667: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,667: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,667: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,668: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,668: root: ERROR: 'Close'
2023-06-01 20:35:36,668: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,669: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,669: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,670: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,670: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,670: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,671: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,671: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,671: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,671: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,672: root: ERROR: 'Close'
2023-06-01 20:35:36,672: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,672: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,673: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,673: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,673: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,673: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,674: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,674: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,674: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,674: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,675: root: ERROR: 'Close'
2023-06-01 20:35:36,675: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,675: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,676: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,676: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,677: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,677: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,678: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,678: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,678: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,678: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,679: root: ERROR: 'Close'
2023-06-01 20:35:36,679: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,679: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,680: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,680: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,681: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,681: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,682: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,682: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,682: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,682: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,683: root: ERROR: 'Close'
2023-06-01 20:35:36,683: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,683: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,684: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,684: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,684: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,684: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,685: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,685: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,685: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,685: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,686: root: ERROR: 'Close'
2023-06-01 20:35:36,687: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,687: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,687: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,687: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,688: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,688: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,689: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,689: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,689: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,689: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,690: root: ERROR: 'Close'
2023-06-01 20:35:36,690: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,690: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,691: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,691: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,691: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,692: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,692: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,692: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,692: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,693: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,693: root: ERROR: 'Close'
2023-06-01 20:35:36,693: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,694: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,694: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,694: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,694: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,695: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,695: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,695: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,696: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,696: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,696: root: ERROR: 'Close'
2023-06-01 20:35:36,696: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,697: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,698: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,698: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,698: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,699: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,699: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,699: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,700: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,700: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,700: root: ERROR: 'Close'
2023-06-01 20:35:36,701: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,701: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,702: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,702: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,703: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,703: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,704: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,704: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,704: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,704: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,705: root: ERROR: 'Close'
2023-06-01 20:35:36,705: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,705: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,706: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,706: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,706: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,706: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,707: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,707: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,707: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,707: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,708: root: ERROR: 'Close'
2023-06-01 20:35:36,708: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,708: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,708: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,708: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,709: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,709: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,709: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,709: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,710: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,710: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,710: root: ERROR: 'Close'
2023-06-01 20:35:36,711: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,711: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,711: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,711: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,711: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,712: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,712: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,712: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,712: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,712: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,713: root: ERROR: 'Close'
2023-06-01 20:35:36,713: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,713: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,714: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,714: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,714: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,715: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,715: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,715: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,716: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,716: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,716: root: ERROR: 'Close'
2023-06-01 20:35:36,716: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,717: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,718: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,718: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,718: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,719: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,719: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,719: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,719: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,720: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,720: root: ERROR: 'Close'
2023-06-01 20:35:36,720: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,720: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,721: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,721: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,721: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,722: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,722: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,722: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,722: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,722: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,723: root: ERROR: 'Close'
2023-06-01 20:35:36,723: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,723: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,724: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,724: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,724: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,724: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,725: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,725: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,725: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,725: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,726: root: ERROR: 'Close'
2023-06-01 20:35:36,726: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,726: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,726: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,726: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,727: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,727: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,727: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,727: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,728: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,728: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,728: root: ERROR: 'Close'
2023-06-01 20:35:36,728: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,729: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,729: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,729: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,729: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,730: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,730: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,730: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,731: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,731: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,731: root: ERROR: 'Close'
2023-06-01 20:35:36,732: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,732: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,732: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,732: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,733: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,733: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,734: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,734: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,734: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,734: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,735: root: ERROR: 'Close'
2023-06-01 20:35:36,735: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,735: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,736: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,736: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,736: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,736: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,737: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,737: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,737: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,737: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,738: root: ERROR: 'Close'
2023-06-01 20:35:36,738: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,738: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,738: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,738: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,739: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,739: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,739: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,739: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,740: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,740: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,740: root: ERROR: 'Close'
2023-06-01 20:35:36,741: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,741: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,741: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,741: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,742: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,742: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,742: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,742: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,743: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,743: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,743: root: ERROR: 'Close'
2023-06-01 20:35:36,743: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,744: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,744: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,744: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,744: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,745: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,745: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,745: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,745: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,746: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,746: root: ERROR: 'Close'
2023-06-01 20:35:36,746: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,746: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,747: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,747: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,747: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,748: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,748: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,748: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,749: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,749: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,749: root: ERROR: 'Close'
2023-06-01 20:35:36,749: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,750: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,750: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,751: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,751: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,751: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,752: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,752: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,752: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,752: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,753: root: ERROR: 'Close'
2023-06-01 20:35:36,753: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,753: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,754: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,754: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,754: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,754: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,755: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,755: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,755: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,755: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,756: root: ERROR: 'Close'
2023-06-01 20:35:36,756: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,756: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,756: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,756: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,757: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,757: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,757: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,757: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,758: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,758: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,758: root: ERROR: 'Close'
2023-06-01 20:35:36,758: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,759: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,759: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,759: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,759: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,760: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,760: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,760: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,760: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,761: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,761: root: ERROR: 'Close'
2023-06-01 20:35:36,761: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,761: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,762: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,762: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,762: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,762: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,763: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,763: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,763: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,763: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,764: root: ERROR: 'Close'
2023-06-01 20:35:36,764: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,764: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,765: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,765: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,765: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,766: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,766: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,766: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,766: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,767: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,767: root: ERROR: 'Close'
2023-06-01 20:35:36,767: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,768: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,768: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,769: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,769: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,769: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,770: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,770: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,770: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,770: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,771: root: ERROR: 'Close'
2023-06-01 20:35:36,771: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,771: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,771: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,772: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,772: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,772: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,773: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,773: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,773: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,773: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,774: root: ERROR: 'Close'
2023-06-01 20:35:36,774: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,774: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,774: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,774: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,775: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,775: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,775: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,775: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,776: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,776: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,776: root: ERROR: 'Close'
2023-06-01 20:35:36,776: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,777: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,777: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,777: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,777: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,778: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,778: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,778: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,778: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,779: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,779: root: ERROR: 'Close'
2023-06-01 20:35:36,779: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,779: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,780: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,780: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,780: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,780: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,781: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,781: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,781: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,782: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,782: root: ERROR: 'Close'
2023-06-01 20:35:36,782: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,783: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,783: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,783: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,784: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,784: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,784: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,784: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,785: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,785: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,785: root: ERROR: 'Close'
2023-06-01 20:35:36,785: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,786: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,786: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,786: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,786: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,787: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,787: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,787: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,787: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,788: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,788: root: ERROR: 'Close'
2023-06-01 20:35:36,788: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,788: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:35:36,789: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:35:36,789: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:35:36,789: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:35:36,789: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:35:36,790: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:35:36,790: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:35:36,790: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:35:36,790: root: INFO: FreshTrading : Executing the on_abrupt_closing event method
2023-06-01 20:35:36,790: root: INFO: Trading finished
2023-06-01 20:35:36,791: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:35:36,791: root: ERROR: 'Close'
2023-06-01 20:35:36,791: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'].tolist()[-1]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:35:36,792: backtest_stats: INFO: Backtest took 0:00:03.177664 for a speed of 0.000
2023-06-01 20:35:36,792: root: WARNING: Cannot plot returns because the strategy returns are missing
2023-06-01 20:35:36,792: root: WARNING: Cannot create a tearsheet because the strategy returns are missing
