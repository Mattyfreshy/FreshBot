2023-06-01 20:33:55,539: root: INFO: FreshTrading : Executing the initialize lifecycle method
2023-06-01 20:33:56,171: root: INFO: Current backtesting datetime 2020-01-02 08:30:00-05:00
2023-06-01 20:33:56,171: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,171: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,172: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,172: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,172: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,178: root: ERROR: 'Close'
2023-06-01 20:33:56,182: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,182: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,182: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,183: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,183: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,183: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,184: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,184: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,184: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,184: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,185: root: ERROR: 'Close'
2023-06-01 20:33:56,185: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,185: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,186: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,186: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,187: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,187: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,187: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,187: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,188: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,188: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,189: root: ERROR: 'Close'
2023-06-01 20:33:56,189: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,189: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,189: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,189: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,190: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,190: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,190: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,190: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,191: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,191: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,191: root: ERROR: 'Close'
2023-06-01 20:33:56,192: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,192: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,192: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,192: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,193: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,193: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,193: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,193: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,194: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,194: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,194: root: ERROR: 'Close'
2023-06-01 20:33:56,194: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,194: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,195: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,195: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,195: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,196: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,196: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,196: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,196: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,196: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,197: root: ERROR: 'Close'
2023-06-01 20:33:56,197: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,197: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,198: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,198: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,198: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,199: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,199: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,199: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,199: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,200: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,200: root: ERROR: 'Close'
2023-06-01 20:33:56,200: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,200: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,201: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,201: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,201: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,202: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,203: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,203: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,203: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,204: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,204: root: ERROR: 'Close'
2023-06-01 20:33:56,204: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,204: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,205: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,205: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,206: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,206: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,206: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,206: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,207: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,207: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,207: root: ERROR: 'Close'
2023-06-01 20:33:56,208: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,208: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,208: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,208: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,209: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,209: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,209: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,209: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,210: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,210: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,210: root: ERROR: 'Close'
2023-06-01 20:33:56,211: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,211: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,211: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,211: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,212: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,212: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,212: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,212: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,213: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,213: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,213: root: ERROR: 'Close'
2023-06-01 20:33:56,213: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,214: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,214: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,214: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,214: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,215: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,215: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,215: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,215: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,216: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,216: root: ERROR: 'Close'
2023-06-01 20:33:56,216: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,217: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,217: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,217: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,218: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,218: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,218: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,218: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,219: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,219: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,220: root: ERROR: 'Close'
2023-06-01 20:33:56,220: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,220: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,221: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,221: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,222: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,222: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,222: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,222: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,223: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,223: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,223: root: ERROR: 'Close'
2023-06-01 20:33:56,223: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,224: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,224: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,224: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,225: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,225: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,225: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,225: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,226: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,226: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,226: root: ERROR: 'Close'
2023-06-01 20:33:56,226: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,226: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,227: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,227: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,227: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,228: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,228: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,228: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,228: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,228: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,229: root: ERROR: 'Close'
2023-06-01 20:33:56,229: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,229: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,230: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,230: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,230: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,230: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,231: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,231: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,231: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,231: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,232: root: ERROR: 'Close'
2023-06-01 20:33:56,232: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,232: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,232: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,232: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,233: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,233: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,234: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,234: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,234: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,234: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,235: root: ERROR: 'Close'
2023-06-01 20:33:56,235: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,235: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,236: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,236: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,237: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,237: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,237: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,238: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,238: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,238: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,239: root: ERROR: 'Close'
2023-06-01 20:33:56,239: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,239: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,239: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,239: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,240: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,240: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,241: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,241: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,241: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,241: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,241: root: ERROR: 'Close'
2023-06-01 20:33:56,242: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,242: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,242: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,242: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,243: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,243: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,243: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,243: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,244: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,244: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,244: root: ERROR: 'Close'
2023-06-01 20:33:56,244: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,245: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,245: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,245: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,245: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,246: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,246: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,246: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,246: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,246: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,247: root: ERROR: 'Close'
2023-06-01 20:33:56,247: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,247: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,248: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,248: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,248: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,249: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,249: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,249: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,250: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,250: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,250: root: ERROR: 'Close'
2023-06-01 20:33:56,250: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,251: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,251: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,252: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,252: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,252: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,253: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,253: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,253: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,253: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,254: root: ERROR: 'Close'
2023-06-01 20:33:56,254: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,254: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,255: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,255: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,256: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,256: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,256: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,256: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,257: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,257: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,257: root: ERROR: 'Close'
2023-06-01 20:33:56,257: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,258: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,258: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,258: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,258: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,259: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,259: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,259: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,259: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,259: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,260: root: ERROR: 'Close'
2023-06-01 20:33:56,260: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,260: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,261: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,261: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,261: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,262: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,262: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,262: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,262: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,262: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,263: root: ERROR: 'Close'
2023-06-01 20:33:56,263: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,263: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,264: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,264: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,264: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,264: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,265: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,265: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,265: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,265: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,266: root: ERROR: 'Close'
2023-06-01 20:33:56,266: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,266: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,267: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,267: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,267: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,268: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,268: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,268: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,269: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,269: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,269: root: ERROR: 'Close'
2023-06-01 20:33:56,269: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,269: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,270: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,270: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,270: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,271: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,271: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,271: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,272: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,272: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,272: root: ERROR: 'Close'
2023-06-01 20:33:56,272: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,272: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,273: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,273: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,273: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,274: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,274: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,274: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,274: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,274: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,275: root: ERROR: 'Close'
2023-06-01 20:33:56,275: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,275: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,276: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,276: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,276: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,276: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,277: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,277: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,277: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,277: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,278: root: ERROR: 'Close'
2023-06-01 20:33:56,278: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,278: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,278: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,278: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,279: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,279: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,279: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,280: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,280: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,280: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,280: root: ERROR: 'Close'
2023-06-01 20:33:56,281: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,281: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,281: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,281: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,282: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,282: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,282: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,282: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,283: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,283: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,284: root: ERROR: 'Close'
2023-06-01 20:33:56,284: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,284: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,285: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,285: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,285: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,286: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,286: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,286: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,287: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,287: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,287: root: ERROR: 'Close'
2023-06-01 20:33:56,288: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,288: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,288: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,288: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,289: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,289: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,289: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,289: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,290: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,290: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,290: root: ERROR: 'Close'
2023-06-01 20:33:56,290: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,291: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,291: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,291: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,292: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,292: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,292: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,292: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,293: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,293: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,293: root: ERROR: 'Close'
2023-06-01 20:33:56,293: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,294: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,294: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,294: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,294: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,295: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,295: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,295: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,295: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,296: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,296: root: ERROR: 'Close'
2023-06-01 20:33:56,296: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,296: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,297: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,297: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,297: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,297: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,298: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,298: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,298: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,298: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,299: root: ERROR: 'Close'
2023-06-01 20:33:56,299: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,299: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,300: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,300: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,300: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,301: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,301: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,301: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,301: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,302: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,302: root: ERROR: 'Close'
2023-06-01 20:33:56,303: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,303: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,304: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,304: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,304: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,304: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,305: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,305: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,305: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,305: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,306: root: ERROR: 'Close'
2023-06-01 20:33:56,306: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,306: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,307: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,307: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,307: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,307: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,308: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,308: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,308: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,308: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,309: root: ERROR: 'Close'
2023-06-01 20:33:56,309: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,309: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,310: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,310: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,310: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,310: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,311: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,311: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,311: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,311: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,312: root: ERROR: 'Close'
2023-06-01 20:33:56,312: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,312: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,312: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,312: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,313: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,313: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,313: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,313: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,314: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,314: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,314: root: ERROR: 'Close'
2023-06-01 20:33:56,315: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,315: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,315: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,315: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,316: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,316: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,316: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,316: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,317: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,317: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,318: root: ERROR: 'Close'
2023-06-01 20:33:56,318: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,318: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,319: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,319: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,319: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,320: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,320: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,320: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,321: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,321: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,321: root: ERROR: 'Close'
2023-06-01 20:33:56,321: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,322: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,322: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,322: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,322: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,323: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,323: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,323: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,323: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,324: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,324: root: ERROR: 'Close'
2023-06-01 20:33:56,324: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,324: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,325: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,325: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,325: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,326: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,326: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,326: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,326: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,327: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,327: root: ERROR: 'Close'
2023-06-01 20:33:56,327: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,327: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,328: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,328: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,328: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,328: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,329: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,329: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,329: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,329: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,330: root: ERROR: 'Close'
2023-06-01 20:33:56,330: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,330: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,331: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,331: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,331: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,331: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,332: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,332: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,332: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,332: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,333: root: ERROR: 'Close'
2023-06-01 20:33:56,333: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,333: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,334: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,334: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,334: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,334: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,335: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,335: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,335: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,335: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,336: root: ERROR: 'Close'
2023-06-01 20:33:56,336: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,337: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,337: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,337: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,338: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,338: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,339: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,339: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,339: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,339: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,340: root: ERROR: 'Close'
2023-06-01 20:33:56,340: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,340: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,340: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,341: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,341: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,341: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,342: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,342: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,342: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,342: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,342: root: ERROR: 'Close'
2023-06-01 20:33:56,343: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,343: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,343: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,343: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,344: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,344: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,344: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,344: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,345: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,345: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,345: root: ERROR: 'Close'
2023-06-01 20:33:56,345: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,346: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,346: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,346: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,346: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,347: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,347: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,347: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,347: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,348: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,348: root: ERROR: 'Close'
2023-06-01 20:33:56,348: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,348: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,349: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,349: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,349: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,350: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,350: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,350: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,350: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,351: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,351: root: ERROR: 'Close'
2023-06-01 20:33:56,351: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,351: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,352: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,352: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,353: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,353: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,354: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,354: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,354: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,354: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,355: root: ERROR: 'Close'
2023-06-01 20:33:56,355: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,355: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,356: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,356: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,356: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,356: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,357: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,357: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,357: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,357: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,358: root: ERROR: 'Close'
2023-06-01 20:33:56,358: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,358: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,358: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,358: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,359: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,359: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,360: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,360: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,360: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,360: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,360: root: ERROR: 'Close'
2023-06-01 20:33:56,361: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,361: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,361: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,361: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,362: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,362: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,363: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,363: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,363: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,363: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,363: root: ERROR: 'Close'
2023-06-01 20:33:56,364: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,364: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,364: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,364: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,365: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,365: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,365: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,365: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,366: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,366: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,367: root: ERROR: 'Close'
2023-06-01 20:33:56,367: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,367: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,367: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,367: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,368: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,368: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,369: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,369: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,369: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,369: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,370: root: ERROR: 'Close'
2023-06-01 20:33:56,370: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,370: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,371: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,371: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,371: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,372: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,372: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,372: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,372: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,373: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,373: root: ERROR: 'Close'
2023-06-01 20:33:56,373: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,373: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,374: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,374: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,374: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,375: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,375: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,375: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,375: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,375: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,376: root: ERROR: 'Close'
2023-06-01 20:33:56,376: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,376: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,377: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,377: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,377: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,377: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,378: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,378: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,378: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,378: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,379: root: ERROR: 'Close'
2023-06-01 20:33:56,379: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,379: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,379: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,379: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,380: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,380: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,380: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,380: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,381: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,381: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,382: root: ERROR: 'Close'
2023-06-01 20:33:56,382: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,382: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,382: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,382: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,383: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,383: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,384: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,384: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,384: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,384: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,385: root: ERROR: 'Close'
2023-06-01 20:33:56,385: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,385: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,386: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,386: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,386: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,387: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,387: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,387: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,387: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,388: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,388: root: ERROR: 'Close'
2023-06-01 20:33:56,388: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,388: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,389: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,389: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,389: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,390: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,390: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,390: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,390: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,390: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,391: root: ERROR: 'Close'
2023-06-01 20:33:56,391: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,391: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,392: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,392: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,392: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,392: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,393: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,393: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,393: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,394: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,394: root: ERROR: 'Close'
2023-06-01 20:33:56,395: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,396: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,398: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,398: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,400: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,401: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,401: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,401: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,401: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,402: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,402: root: ERROR: 'Close'
2023-06-01 20:33:56,403: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,404: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,405: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,405: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,406: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,407: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,407: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,407: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,408: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,408: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,409: root: ERROR: 'Close'
2023-06-01 20:33:56,409: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,410: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,411: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,411: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,412: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,412: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,412: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,412: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,413: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,413: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,414: root: ERROR: 'Close'
2023-06-01 20:33:56,414: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,414: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,415: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,415: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,415: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,416: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,416: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,416: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,416: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,417: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,417: root: ERROR: 'Close'
2023-06-01 20:33:56,417: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,420: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,420: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,420: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,421: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,421: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,421: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,421: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,422: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,422: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,423: root: ERROR: 'Close'
2023-06-01 20:33:56,423: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,426: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,427: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,427: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,427: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,428: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,428: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,428: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,429: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,429: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,430: root: ERROR: 'Close'
2023-06-01 20:33:56,430: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,435: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,436: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,436: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,436: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,437: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,437: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,437: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,438: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,438: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,439: root: ERROR: 'Close'
2023-06-01 20:33:56,439: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,439: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,440: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,440: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,441: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,441: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,442: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,442: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,443: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,443: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,444: root: ERROR: 'Close'
2023-06-01 20:33:56,444: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,444: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,445: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,445: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,445: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,445: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,446: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,446: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,446: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,446: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,447: root: ERROR: 'Close'
2023-06-01 20:33:56,448: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,448: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,448: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,448: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,449: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,449: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,450: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,450: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,450: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,450: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,451: root: ERROR: 'Close'
2023-06-01 20:33:56,451: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,453: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,454: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,454: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,455: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,455: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,456: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,456: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,456: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,456: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,457: root: ERROR: 'Close'
2023-06-01 20:33:56,457: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,457: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,458: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,458: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,459: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,459: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,459: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,459: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,460: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,460: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,461: root: ERROR: 'Close'
2023-06-01 20:33:56,461: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,461: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,462: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,462: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,462: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,463: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,463: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,463: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,463: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,464: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,464: root: ERROR: 'Close'
2023-06-01 20:33:56,464: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,464: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,465: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,465: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,465: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,466: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,466: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,466: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,467: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,467: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,467: root: ERROR: 'Close'
2023-06-01 20:33:56,467: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,468: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,468: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,468: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,469: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,469: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,470: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,470: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,470: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,470: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,471: root: ERROR: 'Close'
2023-06-01 20:33:56,471: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,471: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,472: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,472: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,474: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,474: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,478: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,478: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,478: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,478: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,479: root: ERROR: 'Close'
2023-06-01 20:33:56,479: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,479: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,479: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,479: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,480: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,480: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,480: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,480: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,481: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,481: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,482: root: ERROR: 'Close'
2023-06-01 20:33:56,482: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,482: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,482: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,482: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,483: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,483: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,483: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,483: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,484: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,484: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,484: root: ERROR: 'Close'
2023-06-01 20:33:56,485: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,485: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,485: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,485: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,486: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,486: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,487: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,487: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,487: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,488: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,488: root: ERROR: 'Close'
2023-06-01 20:33:56,488: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,489: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,489: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,489: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,489: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,490: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,490: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,490: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,491: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,491: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,491: root: ERROR: 'Close'
2023-06-01 20:33:56,491: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,491: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,492: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,492: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,492: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,493: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,493: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,493: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,493: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,493: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,494: root: ERROR: 'Close'
2023-06-01 20:33:56,494: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,494: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,495: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,495: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,495: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,495: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,496: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,496: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,496: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,496: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,497: root: ERROR: 'Close'
2023-06-01 20:33:56,497: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,497: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,498: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,498: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,498: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,498: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,499: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,499: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,499: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,499: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,500: root: ERROR: 'Close'
2023-06-01 20:33:56,500: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,501: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,501: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,501: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,502: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,502: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,503: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,503: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,503: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,503: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,504: root: ERROR: 'Close'
2023-06-01 20:33:56,504: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,504: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,505: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,505: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,505: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,505: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,506: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,506: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,506: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,506: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,507: root: ERROR: 'Close'
2023-06-01 20:33:56,507: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,507: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,508: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,508: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,508: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,508: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,509: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,509: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,509: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,509: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,510: root: ERROR: 'Close'
2023-06-01 20:33:56,510: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,510: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,511: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,511: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,511: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,511: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,512: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,512: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,512: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,512: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,513: root: ERROR: 'Close'
2023-06-01 20:33:56,513: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,513: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,513: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,513: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,514: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,514: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,514: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,514: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,515: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,515: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,515: root: ERROR: 'Close'
2023-06-01 20:33:56,515: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,515: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,516: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,516: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,517: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,517: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,517: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,517: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,518: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,518: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,518: root: ERROR: 'Close'
2023-06-01 20:33:56,519: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,519: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,520: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,520: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,520: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,521: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,521: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,521: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,522: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,522: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,522: root: ERROR: 'Close'
2023-06-01 20:33:56,522: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,523: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,523: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,523: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,524: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,524: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,524: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,524: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,525: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,525: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,525: root: ERROR: 'Close'
2023-06-01 20:33:56,525: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,526: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,526: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,526: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,526: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,527: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,527: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,527: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,527: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,527: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,528: root: ERROR: 'Close'
2023-06-01 20:33:56,528: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,528: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,529: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,529: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,529: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,529: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,530: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,530: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,530: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,530: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,531: root: ERROR: 'Close'
2023-06-01 20:33:56,531: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,531: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,531: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,532: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,532: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,532: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,533: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,533: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,533: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,533: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,534: root: ERROR: 'Close'
2023-06-01 20:33:56,534: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,534: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,535: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,535: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,535: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,535: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,536: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,536: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,537: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,537: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,537: root: ERROR: 'Close'
2023-06-01 20:33:56,538: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,538: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,538: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,538: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,539: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,539: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,539: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,539: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,540: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,540: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,540: root: ERROR: 'Close'
2023-06-01 20:33:56,541: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,541: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,541: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,541: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,542: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,542: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,542: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,542: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,543: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,543: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,543: root: ERROR: 'Close'
2023-06-01 20:33:56,543: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,544: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,544: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,544: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,544: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,545: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,545: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,545: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,545: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,546: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,546: root: ERROR: 'Close'
2023-06-01 20:33:56,546: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,546: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,547: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,547: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,547: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,548: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,548: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,548: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,548: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,548: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,549: root: ERROR: 'Close'
2023-06-01 20:33:56,549: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,549: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,550: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,550: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,550: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,550: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,551: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,551: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,551: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,551: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,552: root: ERROR: 'Close'
2023-06-01 20:33:56,552: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,553: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,553: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,553: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,554: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,554: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,555: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,555: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,555: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,555: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,556: root: ERROR: 'Close'
2023-06-01 20:33:56,556: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,556: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,556: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,556: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,557: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,557: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,558: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,558: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,558: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,558: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,559: root: ERROR: 'Close'
2023-06-01 20:33:56,559: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,559: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,559: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,559: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,560: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,560: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,560: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,560: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,561: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,561: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,561: root: ERROR: 'Close'
2023-06-01 20:33:56,562: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,562: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,562: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,562: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,562: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,563: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,563: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,563: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,563: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,563: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,564: root: ERROR: 'Close'
2023-06-01 20:33:56,564: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,564: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,565: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,565: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,565: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,566: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,566: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,566: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,566: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,567: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,567: root: ERROR: 'Close'
2023-06-01 20:33:56,567: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,567: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,568: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,568: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,569: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,569: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,570: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,570: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,570: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,570: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,571: root: ERROR: 'Close'
2023-06-01 20:33:56,571: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,571: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,572: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,572: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,572: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,572: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,573: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,573: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,573: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,573: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,574: root: ERROR: 'Close'
2023-06-01 20:33:56,574: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,574: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,574: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,574: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,575: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,575: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,575: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,576: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,576: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,576: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,576: root: ERROR: 'Close'
2023-06-01 20:33:56,577: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,577: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,577: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,577: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,578: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,578: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,578: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,578: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,579: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,579: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,579: root: ERROR: 'Close'
2023-06-01 20:33:56,579: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,579: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,580: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,580: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,580: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,581: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,581: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,581: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,581: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,581: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,582: root: ERROR: 'Close'
2023-06-01 20:33:56,582: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,582: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,583: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,583: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,583: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,584: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,584: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,584: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,584: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,585: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,585: root: ERROR: 'Close'
2023-06-01 20:33:56,586: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,586: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,586: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,586: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,587: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,587: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,588: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,588: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,588: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,588: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,589: root: ERROR: 'Close'
2023-06-01 20:33:56,589: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,589: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,589: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,589: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,590: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,590: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,590: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,590: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,591: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,591: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,591: root: ERROR: 'Close'
2023-06-01 20:33:56,592: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,592: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,592: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,592: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,593: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,593: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,593: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,593: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,594: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,594: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,594: root: ERROR: 'Close'
2023-06-01 20:33:56,594: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,595: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,595: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,595: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,596: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,596: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,596: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,596: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,597: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,597: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,597: root: ERROR: 'Close'
2023-06-01 20:33:56,597: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,597: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,598: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,598: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,598: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,599: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,599: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,599: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,599: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,600: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,600: root: ERROR: 'Close'
2023-06-01 20:33:56,600: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,600: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,601: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,601: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,601: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,602: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,602: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,602: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,603: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,603: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,604: root: ERROR: 'Close'
2023-06-01 20:33:56,604: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,604: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,604: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,604: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,605: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,605: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,605: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,605: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,606: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,606: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,606: root: ERROR: 'Close'
2023-06-01 20:33:56,607: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,607: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,607: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,607: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,608: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,608: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,608: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,608: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,609: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,609: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,609: root: ERROR: 'Close'
2023-06-01 20:33:56,610: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,610: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,610: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,610: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,610: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,611: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,611: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,611: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,611: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,612: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,612: root: ERROR: 'Close'
2023-06-01 20:33:56,612: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,612: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,613: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,613: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,613: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,613: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,614: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,614: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,614: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,614: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,615: root: ERROR: 'Close'
2023-06-01 20:33:56,615: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,615: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,616: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,616: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,616: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,616: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,617: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,617: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,617: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,618: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,618: root: ERROR: 'Close'
2023-06-01 20:33:56,619: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,619: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,619: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,619: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,620: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,620: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,621: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,621: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,621: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,621: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,622: root: ERROR: 'Close'
2023-06-01 20:33:56,622: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,622: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,622: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,622: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,623: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,623: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,623: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,623: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,624: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,624: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,624: root: ERROR: 'Close'
2023-06-01 20:33:56,625: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,625: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,625: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,625: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,625: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,626: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,626: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,626: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,626: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,627: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,627: root: ERROR: 'Close'
2023-06-01 20:33:56,627: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,627: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,628: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,628: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,628: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,628: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,629: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,629: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,629: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,629: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,630: root: ERROR: 'Close'
2023-06-01 20:33:56,630: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,630: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,630: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,630: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,631: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,631: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,632: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,632: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,632: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,632: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,633: root: ERROR: 'Close'
2023-06-01 20:33:56,633: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,633: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,634: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,634: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,634: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,635: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,635: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,635: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,635: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,636: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,636: root: ERROR: 'Close'
2023-06-01 20:33:56,636: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,636: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,637: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,637: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,637: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,638: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,638: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,638: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,638: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,638: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,639: root: ERROR: 'Close'
2023-06-01 20:33:56,639: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,639: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,640: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,640: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,640: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,640: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,641: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,641: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,641: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,641: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,642: root: ERROR: 'Close'
2023-06-01 20:33:56,642: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,642: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,642: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,643: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,643: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,643: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,644: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,644: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,644: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,644: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,644: root: ERROR: 'Close'
2023-06-01 20:33:56,645: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,645: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,645: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,645: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,646: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,646: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,646: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,646: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,647: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,647: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,647: root: ERROR: 'Close'
2023-06-01 20:33:56,647: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,647: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,648: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,648: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,648: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,649: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,649: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,649: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,649: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,649: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,650: root: ERROR: 'Close'
2023-06-01 20:33:56,650: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,651: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,651: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,651: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,652: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,652: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,653: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,653: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,653: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,653: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,654: root: ERROR: 'Close'
2023-06-01 20:33:56,654: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,654: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,654: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,654: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,655: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,655: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,655: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,655: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,656: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,656: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,656: root: ERROR: 'Close'
2023-06-01 20:33:56,656: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,657: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,657: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,657: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,657: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,658: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,658: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,658: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,658: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,659: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,659: root: ERROR: 'Close'
2023-06-01 20:33:56,659: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,659: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,660: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,660: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,660: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,660: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,661: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,661: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,661: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,661: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,662: root: ERROR: 'Close'
2023-06-01 20:33:56,662: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,662: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,662: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,662: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,663: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,663: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,664: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,664: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,664: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,664: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,665: root: ERROR: 'Close'
2023-06-01 20:33:56,665: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,665: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,665: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,665: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,666: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,666: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,667: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,667: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,667: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,667: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,668: root: ERROR: 'Close'
2023-06-01 20:33:56,668: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,668: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,669: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,669: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,669: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,670: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,670: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,670: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,671: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,671: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,671: root: ERROR: 'Close'
2023-06-01 20:33:56,671: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,671: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,672: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,672: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,672: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,673: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,673: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,673: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,673: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,673: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,674: root: ERROR: 'Close'
2023-06-01 20:33:56,674: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,674: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,675: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,675: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,675: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,676: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,676: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,676: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,676: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,676: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,677: root: ERROR: 'Close'
2023-06-01 20:33:56,677: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,677: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,678: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,678: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,678: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,678: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,679: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,679: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,679: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,679: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,680: root: ERROR: 'Close'
2023-06-01 20:33:56,680: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,680: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,680: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,681: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,681: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,681: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,682: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,682: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,682: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,682: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,683: root: ERROR: 'Close'
2023-06-01 20:33:56,683: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,683: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,684: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,684: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,685: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,685: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,685: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,685: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,686: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,686: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,686: root: ERROR: 'Close'
2023-06-01 20:33:56,687: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,687: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,687: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,687: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,688: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,688: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,688: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,688: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,689: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,689: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,689: root: ERROR: 'Close'
2023-06-01 20:33:56,689: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,689: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,690: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,690: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,690: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,691: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,691: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,691: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,691: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,691: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,692: root: ERROR: 'Close'
2023-06-01 20:33:56,692: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,692: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,693: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,693: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,693: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,693: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,694: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,694: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,694: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,694: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,695: root: ERROR: 'Close'
2023-06-01 20:33:56,695: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,695: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,695: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,695: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,696: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,696: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,696: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,696: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,697: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,697: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,697: root: ERROR: 'Close'
2023-06-01 20:33:56,697: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,697: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,698: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,698: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,698: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,699: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,699: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,699: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,699: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,700: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,700: root: ERROR: 'Close'
2023-06-01 20:33:56,700: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,700: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,701: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,701: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,702: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,702: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,702: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,702: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,703: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,703: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,704: root: ERROR: 'Close'
2023-06-01 20:33:56,704: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,704: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,704: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,704: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,705: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,705: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,705: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,705: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,706: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,706: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,706: root: ERROR: 'Close'
2023-06-01 20:33:56,706: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,707: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,707: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,707: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,708: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,708: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,708: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,708: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,709: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,709: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,709: root: ERROR: 'Close'
2023-06-01 20:33:56,709: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,709: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,710: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,710: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,710: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,710: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,711: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,711: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,711: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,711: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,712: root: ERROR: 'Close'
2023-06-01 20:33:56,712: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,712: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,713: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,713: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,713: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,713: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,714: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,714: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,714: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,714: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,715: root: ERROR: 'Close'
2023-06-01 20:33:56,715: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,715: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,715: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,716: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,716: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,716: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,717: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,717: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,717: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,717: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,718: root: ERROR: 'Close'
2023-06-01 20:33:56,718: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,718: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,719: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,719: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,720: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,720: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,721: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,721: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,721: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,721: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,722: root: ERROR: 'Close'
2023-06-01 20:33:56,722: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,723: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,724: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,724: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,725: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,725: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,725: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,725: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,726: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,726: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,726: root: ERROR: 'Close'
2023-06-01 20:33:56,727: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,727: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,728: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,728: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,728: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,729: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,729: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,729: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,730: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,730: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,730: root: ERROR: 'Close'
2023-06-01 20:33:56,730: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,731: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,734: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,734: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,736: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,736: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,737: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,737: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,737: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,738: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,738: root: ERROR: 'Close'
2023-06-01 20:33:56,738: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,739: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,740: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,740: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,741: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,741: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,741: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,741: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,742: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,742: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,743: root: ERROR: 'Close'
2023-06-01 20:33:56,743: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,744: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,746: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,746: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,748: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,749: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,749: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,749: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,750: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,750: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,750: root: ERROR: 'Close'
2023-06-01 20:33:56,751: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,753: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,754: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,754: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,754: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,755: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,755: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,755: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,756: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,756: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,757: root: ERROR: 'Close'
2023-06-01 20:33:56,757: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,759: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,760: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,760: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,760: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,761: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,761: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,761: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,762: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,762: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,762: root: ERROR: 'Close'
2023-06-01 20:33:56,763: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,763: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,763: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,763: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,764: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,764: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,765: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,765: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,765: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,765: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,766: root: ERROR: 'Close'
2023-06-01 20:33:56,766: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,766: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,767: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,767: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,767: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,767: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,768: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,768: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,768: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,769: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,769: root: ERROR: 'Close'
2023-06-01 20:33:56,769: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,770: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,771: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,771: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,771: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,772: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,772: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,772: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,773: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,773: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,774: root: ERROR: 'Close'
2023-06-01 20:33:56,774: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,774: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,775: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,775: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,776: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,776: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,777: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,777: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,777: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,777: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,778: root: ERROR: 'Close'
2023-06-01 20:33:56,778: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,778: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,779: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,779: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,779: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,780: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,780: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,780: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,780: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,781: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,781: root: ERROR: 'Close'
2023-06-01 20:33:56,781: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,782: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,782: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,782: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,783: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,783: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,783: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,783: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,784: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,784: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,785: root: ERROR: 'Close'
2023-06-01 20:33:56,785: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,785: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,785: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,786: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,786: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,786: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,787: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,787: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,787: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,787: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,788: root: ERROR: 'Close'
2023-06-01 20:33:56,788: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,788: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,788: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,788: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,789: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,789: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,789: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,789: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,790: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,790: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,790: root: ERROR: 'Close'
2023-06-01 20:33:56,791: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,791: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,791: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,791: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,792: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,792: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,792: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,792: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,793: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,793: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,793: root: ERROR: 'Close'
2023-06-01 20:33:56,794: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,794: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,794: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,794: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,794: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,795: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,795: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,795: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,795: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,796: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,796: root: ERROR: 'Close'
2023-06-01 20:33:56,796: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,796: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,797: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,797: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,797: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,797: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,798: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,798: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,798: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,798: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,799: root: ERROR: 'Close'
2023-06-01 20:33:56,799: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,799: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,800: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,800: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,800: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,801: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,801: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,801: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,802: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,802: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,802: root: ERROR: 'Close'
2023-06-01 20:33:56,803: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,803: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,803: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,803: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,804: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,804: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,804: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,804: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,805: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,805: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,805: root: ERROR: 'Close'
2023-06-01 20:33:56,806: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,806: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,806: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,806: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,806: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,807: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,807: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,807: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,807: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,808: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,808: root: ERROR: 'Close'
2023-06-01 20:33:56,808: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,808: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,809: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,809: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,809: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,809: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,810: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,810: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,810: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,810: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,811: root: ERROR: 'Close'
2023-06-01 20:33:56,811: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,811: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,811: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,812: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,812: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,812: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,813: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,813: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,813: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,813: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,813: root: ERROR: 'Close'
2023-06-01 20:33:56,814: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,814: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,814: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,814: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,815: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,815: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,815: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,815: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,816: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,816: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,816: root: ERROR: 'Close'
2023-06-01 20:33:56,817: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,817: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,817: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,817: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,818: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,818: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,819: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,819: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,819: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,819: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,820: root: ERROR: 'Close'
2023-06-01 20:33:56,820: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,820: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,821: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,821: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,822: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,822: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,822: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,822: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,823: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,823: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,824: root: ERROR: 'Close'
2023-06-01 20:33:56,824: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,824: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,825: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,825: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,825: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,826: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,826: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,826: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,827: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,827: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,828: root: ERROR: 'Close'
2023-06-01 20:33:56,828: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,828: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,829: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,829: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,829: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,829: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,830: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,830: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,830: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,830: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,831: root: ERROR: 'Close'
2023-06-01 20:33:56,831: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,831: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,832: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,832: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,833: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,833: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,834: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,834: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,834: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,834: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,835: root: ERROR: 'Close'
2023-06-01 20:33:56,835: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,835: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,836: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,836: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,837: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,837: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,837: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,837: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,838: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,838: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,838: root: ERROR: 'Close'
2023-06-01 20:33:56,839: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,839: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,839: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,839: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,840: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,840: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,840: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,840: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,841: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,841: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,841: root: ERROR: 'Close'
2023-06-01 20:33:56,842: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,842: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,842: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,842: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,843: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,843: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,843: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,843: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,844: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,844: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,844: root: ERROR: 'Close'
2023-06-01 20:33:56,844: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,844: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,845: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,845: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,845: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,846: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,846: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,846: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,846: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,846: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,847: root: ERROR: 'Close'
2023-06-01 20:33:56,847: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,847: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,848: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,848: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,848: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,848: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,849: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,849: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,849: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,850: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,850: root: ERROR: 'Close'
2023-06-01 20:33:56,851: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,851: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,851: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,851: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,852: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,852: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,852: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,852: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,853: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,853: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,853: root: ERROR: 'Close'
2023-06-01 20:33:56,854: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,854: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,854: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,854: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,855: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,855: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,855: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,855: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,856: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,856: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,856: root: ERROR: 'Close'
2023-06-01 20:33:56,856: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,856: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,857: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,857: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,857: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,858: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,858: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,858: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,858: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,858: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,859: root: ERROR: 'Close'
2023-06-01 20:33:56,859: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,859: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,860: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,860: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,860: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,860: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,861: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,861: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,861: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,861: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,862: root: ERROR: 'Close'
2023-06-01 20:33:56,862: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,862: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,862: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,862: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,863: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,863: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,863: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,863: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,864: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,864: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,864: root: ERROR: 'Close'
2023-06-01 20:33:56,865: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,865: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,865: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,865: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,866: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,866: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,867: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,867: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,867: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,867: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,868: root: ERROR: 'Close'
2023-06-01 20:33:56,868: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,868: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,869: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,869: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,869: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,870: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,870: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,870: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,871: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,871: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,871: root: ERROR: 'Close'
2023-06-01 20:33:56,872: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,872: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,872: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,872: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,873: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,873: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,873: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,873: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,874: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,874: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,874: root: ERROR: 'Close'
2023-06-01 20:33:56,874: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,874: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,875: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,875: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,875: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,875: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,876: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,876: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,876: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,876: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,877: root: ERROR: 'Close'
2023-06-01 20:33:56,877: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,877: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,878: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,878: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,878: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,878: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,879: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,879: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,879: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,879: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,880: root: ERROR: 'Close'
2023-06-01 20:33:56,880: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,880: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,880: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,880: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,881: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,881: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,881: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,881: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,882: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,882: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,883: root: ERROR: 'Close'
2023-06-01 20:33:56,883: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,883: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,884: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,884: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,884: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,884: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,885: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,885: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,885: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,885: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,886: root: ERROR: 'Close'
2023-06-01 20:33:56,886: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,887: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,887: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,887: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,887: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,888: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,888: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,888: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,888: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,889: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,889: root: ERROR: 'Close'
2023-06-01 20:33:56,889: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,889: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,890: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,890: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,890: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,890: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,891: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,891: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,891: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,891: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,892: root: ERROR: 'Close'
2023-06-01 20:33:56,892: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,892: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,892: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,892: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,893: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,893: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,893: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,893: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,894: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,894: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,894: root: ERROR: 'Close'
2023-06-01 20:33:56,895: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,895: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,895: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,895: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,896: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,896: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,896: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,896: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,897: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,897: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,897: root: ERROR: 'Close'
2023-06-01 20:33:56,897: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,897: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,898: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,898: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,898: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,899: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,899: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,899: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,899: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,900: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,900: root: ERROR: 'Close'
2023-06-01 20:33:56,901: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,901: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,901: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,902: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,902: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,902: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,903: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,903: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,903: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,903: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,904: root: ERROR: 'Close'
2023-06-01 20:33:56,904: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,904: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,904: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,905: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,905: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,905: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,906: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,906: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,906: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,906: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,907: root: ERROR: 'Close'
2023-06-01 20:33:56,907: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,907: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,907: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,907: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,908: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,908: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,908: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,908: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,909: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,909: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,909: root: ERROR: 'Close'
2023-06-01 20:33:56,909: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,909: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,910: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,910: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,910: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,910: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,911: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,911: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,911: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,911: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,912: root: ERROR: 'Close'
2023-06-01 20:33:56,912: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,912: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,913: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,913: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,913: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,913: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,914: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,914: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,914: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,914: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,915: root: ERROR: 'Close'
2023-06-01 20:33:56,915: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,915: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,916: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,916: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,916: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,917: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,917: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,917: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,917: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,917: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,918: root: ERROR: 'Close'
2023-06-01 20:33:56,918: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,918: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,919: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,919: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,919: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,920: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,920: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,920: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,920: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,920: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,921: root: ERROR: 'Close'
2023-06-01 20:33:56,921: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,921: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,922: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,922: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,922: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,922: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,923: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,923: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,923: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,923: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,924: root: ERROR: 'Close'
2023-06-01 20:33:56,924: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,924: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,925: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,925: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,925: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,925: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,926: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,926: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,926: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,926: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,927: root: ERROR: 'Close'
2023-06-01 20:33:56,927: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,927: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,927: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,927: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,928: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,928: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,928: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,928: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,929: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,929: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,929: root: ERROR: 'Close'
2023-06-01 20:33:56,929: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,930: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,930: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,930: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,930: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,931: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,931: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,931: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,931: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,931: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,932: root: ERROR: 'Close'
2023-06-01 20:33:56,932: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,932: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,933: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,933: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,934: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,934: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,934: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,934: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,935: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,935: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,935: root: ERROR: 'Close'
2023-06-01 20:33:56,936: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,936: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,936: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,936: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,937: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,937: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,937: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,937: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,938: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,938: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,938: root: ERROR: 'Close'
2023-06-01 20:33:56,938: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,938: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,939: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,939: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,939: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,940: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,940: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,940: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,940: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,940: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,941: root: ERROR: 'Close'
2023-06-01 20:33:56,941: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,941: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,942: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,942: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,942: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,942: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,943: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,943: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,943: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,943: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,944: root: ERROR: 'Close'
2023-06-01 20:33:56,944: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,944: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,944: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,945: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,945: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,945: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,946: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,946: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,946: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,946: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,947: root: ERROR: 'Close'
2023-06-01 20:33:56,947: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,947: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,947: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,947: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,948: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,948: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,948: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,948: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,949: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,949: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,950: root: ERROR: 'Close'
2023-06-01 20:33:56,950: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,950: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,951: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,951: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,951: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,951: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,952: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,952: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,952: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,952: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,953: root: ERROR: 'Close'
2023-06-01 20:33:56,953: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,953: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,953: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,953: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,954: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,954: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,954: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,954: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,955: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,955: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,955: root: ERROR: 'Close'
2023-06-01 20:33:56,956: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,956: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,956: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,956: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,957: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,957: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,957: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,957: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,958: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,958: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,958: root: ERROR: 'Close'
2023-06-01 20:33:56,958: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,958: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,959: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,959: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,959: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,959: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,960: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,960: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,960: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,960: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,961: root: ERROR: 'Close'
2023-06-01 20:33:56,961: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,961: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,962: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,962: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,962: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,962: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,963: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,963: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,963: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,963: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,963: root: ERROR: 'Close'
2023-06-01 20:33:56,964: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,964: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,964: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,964: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,964: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,965: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,965: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,965: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,966: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,966: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,966: root: ERROR: 'Close'
2023-06-01 20:33:56,966: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,967: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,967: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,968: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,968: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,968: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,969: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,969: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,969: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,969: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,970: root: ERROR: 'Close'
2023-06-01 20:33:56,970: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,970: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,970: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,971: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,971: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,971: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,972: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,972: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,972: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,972: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,972: root: ERROR: 'Close'
2023-06-01 20:33:56,973: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,973: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,973: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,973: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,974: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,974: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,974: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,974: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,975: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,975: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,975: root: ERROR: 'Close'
2023-06-01 20:33:56,975: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,976: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,976: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,976: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,976: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,977: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,977: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,977: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,977: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,977: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,978: root: ERROR: 'Close'
2023-06-01 20:33:56,978: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,978: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,979: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,979: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,979: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,979: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,980: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,980: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,980: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,980: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,981: root: ERROR: 'Close'
2023-06-01 20:33:56,981: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,981: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,981: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,981: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,982: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,982: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,982: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,982: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,983: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,983: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,983: root: ERROR: 'Close'
2023-06-01 20:33:56,984: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,984: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,984: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,984: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,985: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,985: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,986: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,986: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,986: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,986: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,987: root: ERROR: 'Close'
2023-06-01 20:33:56,987: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,987: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,988: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,988: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,988: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,988: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,989: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,989: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,989: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,989: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,990: root: ERROR: 'Close'
2023-06-01 20:33:56,990: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,990: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,990: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,991: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,991: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,991: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,992: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,992: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,992: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,992: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,993: root: ERROR: 'Close'
2023-06-01 20:33:56,993: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,993: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,993: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,993: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,994: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,994: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,994: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,994: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,995: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,995: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,995: root: ERROR: 'Close'
2023-06-01 20:33:56,995: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,995: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,996: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,996: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,996: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:56,997: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:56,997: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:56,997: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:56,997: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:56,997: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:56,998: root: ERROR: 'Close'
2023-06-01 20:33:56,998: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:56,998: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:56,999: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:56,999: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:56,999: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,000: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,000: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,000: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,001: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,001: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,002: root: ERROR: 'Close'
2023-06-01 20:33:57,002: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,003: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,004: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,004: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,005: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,005: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,005: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,006: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,006: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,006: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,007: root: ERROR: 'Close'
2023-06-01 20:33:57,007: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,009: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,010: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,010: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,010: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,010: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,011: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,011: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,011: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,011: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,012: root: ERROR: 'Close'
2023-06-01 20:33:57,012: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,013: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,014: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,014: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,014: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,015: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,015: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,015: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,015: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,016: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,016: root: ERROR: 'Close'
2023-06-01 20:33:57,016: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,018: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,020: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,020: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,020: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,021: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,021: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,021: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,022: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,022: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,022: root: ERROR: 'Close'
2023-06-01 20:33:57,023: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,025: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,026: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,026: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,026: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,027: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,027: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,027: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,028: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,028: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,028: root: ERROR: 'Close'
2023-06-01 20:33:57,029: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,029: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,030: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,030: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,030: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,030: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,031: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,031: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,031: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,032: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,032: root: ERROR: 'Close'
2023-06-01 20:33:57,032: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,034: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,035: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,035: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,035: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,035: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,036: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,036: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,036: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,036: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,037: root: ERROR: 'Close'
2023-06-01 20:33:57,037: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,039: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,040: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,040: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,040: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,040: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,041: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,041: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,041: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,041: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,042: root: ERROR: 'Close'
2023-06-01 20:33:57,042: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,043: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,044: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,044: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,045: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,045: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,045: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,045: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,046: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,046: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,047: root: ERROR: 'Close'
2023-06-01 20:33:57,047: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,047: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,048: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,048: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,048: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,048: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,049: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,049: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,049: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,049: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,050: root: ERROR: 'Close'
2023-06-01 20:33:57,050: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,051: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,052: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,052: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,052: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,052: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,053: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,053: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,053: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,054: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,054: root: ERROR: 'Close'
2023-06-01 20:33:57,054: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,055: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,056: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,056: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,057: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,057: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,057: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,057: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,058: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,058: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,059: root: ERROR: 'Close'
2023-06-01 20:33:57,059: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,059: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,060: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,060: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,061: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,061: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,061: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,061: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,062: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,062: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,062: root: ERROR: 'Close'
2023-06-01 20:33:57,063: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,063: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,063: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,064: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,064: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,064: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,065: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,065: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,065: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,065: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,066: root: ERROR: 'Close'
2023-06-01 20:33:57,066: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,066: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,067: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,067: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,067: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,067: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,068: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,068: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,068: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,068: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,069: root: ERROR: 'Close'
2023-06-01 20:33:57,069: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,069: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,070: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,070: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,071: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,071: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,072: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,072: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,072: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,072: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,073: root: ERROR: 'Close'
2023-06-01 20:33:57,073: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,073: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,073: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,073: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,074: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,074: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,074: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,074: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,075: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,075: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,075: root: ERROR: 'Close'
2023-06-01 20:33:57,076: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,076: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,076: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,076: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,076: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,077: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,077: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,077: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,077: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,078: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,078: root: ERROR: 'Close'
2023-06-01 20:33:57,078: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,078: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,079: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,079: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,079: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,079: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,080: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,080: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,080: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,080: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,081: root: ERROR: 'Close'
2023-06-01 20:33:57,081: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,081: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,081: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,081: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,082: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,082: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,083: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,083: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,083: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,083: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,084: root: ERROR: 'Close'
2023-06-01 20:33:57,084: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,084: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,085: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,085: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,086: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,086: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,086: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,086: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,087: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,087: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,088: root: ERROR: 'Close'
2023-06-01 20:33:57,088: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,088: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,088: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,088: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,089: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,089: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,089: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,089: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,090: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,090: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,090: root: ERROR: 'Close'
2023-06-01 20:33:57,091: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,091: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,091: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,091: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,092: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,092: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,092: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,092: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,093: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,093: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,093: root: ERROR: 'Close'
2023-06-01 20:33:57,093: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,093: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,094: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,094: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,094: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,095: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,095: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,095: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,095: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,095: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,096: root: ERROR: 'Close'
2023-06-01 20:33:57,096: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,096: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,097: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,097: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,097: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,098: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,098: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,098: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,098: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,098: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,099: root: ERROR: 'Close'
2023-06-01 20:33:57,099: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,099: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,100: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,100: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,100: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,101: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,101: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,101: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,102: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,102: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,103: root: ERROR: 'Close'
2023-06-01 20:33:57,103: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,103: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,104: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,104: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,104: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,104: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,105: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,105: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,105: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,105: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,106: root: ERROR: 'Close'
2023-06-01 20:33:57,106: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,106: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,107: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,107: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,107: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,107: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,108: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,108: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,108: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,108: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,109: root: ERROR: 'Close'
2023-06-01 20:33:57,109: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,109: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,109: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,109: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,110: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,110: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,110: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,110: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,111: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,111: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,111: root: ERROR: 'Close'
2023-06-01 20:33:57,111: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,111: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,112: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,112: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,112: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,113: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,113: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,113: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,113: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,113: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,114: root: ERROR: 'Close'
2023-06-01 20:33:57,114: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,114: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,115: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,115: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,115: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,116: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,116: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,116: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,117: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,117: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,117: root: ERROR: 'Close'
2023-06-01 20:33:57,117: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,118: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,118: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,118: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,119: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,119: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,119: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,119: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,120: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,120: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,120: root: ERROR: 'Close'
2023-06-01 20:33:57,120: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,121: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,121: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,121: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,121: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,122: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,122: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,122: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,122: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,122: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,123: root: ERROR: 'Close'
2023-06-01 20:33:57,123: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,123: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,124: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,124: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,124: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,124: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,125: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,125: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,125: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,125: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,126: root: ERROR: 'Close'
2023-06-01 20:33:57,126: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,126: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,126: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,127: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,127: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,127: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,128: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,128: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,128: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,128: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,128: root: ERROR: 'Close'
2023-06-01 20:33:57,129: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,129: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,129: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,129: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,130: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,130: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,130: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,130: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,131: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,131: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,131: root: ERROR: 'Close'
2023-06-01 20:33:57,132: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,132: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,132: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,132: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,133: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,133: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,134: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,134: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,134: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,134: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,135: root: ERROR: 'Close'
2023-06-01 20:33:57,135: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,135: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,136: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,136: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,136: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,136: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,137: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,137: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,137: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,137: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,138: root: ERROR: 'Close'
2023-06-01 20:33:57,138: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,138: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,138: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,138: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,139: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,139: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,139: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,139: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,140: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,140: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,140: root: ERROR: 'Close'
2023-06-01 20:33:57,141: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,141: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,141: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,141: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,142: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,142: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,142: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,142: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,143: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,143: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,143: root: ERROR: 'Close'
2023-06-01 20:33:57,143: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,143: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,144: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,144: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,144: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,144: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,145: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,145: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,145: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,145: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,146: root: ERROR: 'Close'
2023-06-01 20:33:57,146: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,146: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,146: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,146: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,147: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,147: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,148: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,148: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,148: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,148: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,149: root: ERROR: 'Close'
2023-06-01 20:33:57,149: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,149: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,150: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,150: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,150: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,151: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,151: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,151: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,152: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,152: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,152: root: ERROR: 'Close'
2023-06-01 20:33:57,152: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,153: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,153: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,153: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,154: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,154: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,155: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,155: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,155: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,155: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,156: root: ERROR: 'Close'
2023-06-01 20:33:57,156: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,156: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,156: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,157: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,157: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,157: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,158: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,158: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,158: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,158: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,159: root: ERROR: 'Close'
2023-06-01 20:33:57,159: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,159: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,160: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,160: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,160: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,160: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,161: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,161: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,161: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,161: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,162: root: ERROR: 'Close'
2023-06-01 20:33:57,162: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,162: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,163: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,163: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,163: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,163: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,164: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,164: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,164: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,164: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,165: root: ERROR: 'Close'
2023-06-01 20:33:57,165: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,165: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,166: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,166: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,166: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,167: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,167: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,167: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,168: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,168: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,168: root: ERROR: 'Close'
2023-06-01 20:33:57,169: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,169: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,169: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,169: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,170: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,170: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,171: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,171: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,171: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,171: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,172: root: ERROR: 'Close'
2023-06-01 20:33:57,172: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,172: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,173: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,173: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,173: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,173: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,174: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,174: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,174: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,174: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,175: root: ERROR: 'Close'
2023-06-01 20:33:57,175: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,175: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,176: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,176: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,176: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,177: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,177: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,177: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,177: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,177: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,178: root: ERROR: 'Close'
2023-06-01 20:33:57,178: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,178: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,179: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,179: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,179: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,179: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,180: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,180: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,180: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,180: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,181: root: ERROR: 'Close'
2023-06-01 20:33:57,181: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,181: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,181: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,182: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,182: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,182: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,183: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,183: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,183: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,184: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,184: root: ERROR: 'Close'
2023-06-01 20:33:57,184: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,185: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,185: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,185: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,186: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,186: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,186: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,186: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,187: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,187: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,187: root: ERROR: 'Close'
2023-06-01 20:33:57,188: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,188: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,188: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,188: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,189: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,189: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,189: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,189: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,190: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,190: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,190: root: ERROR: 'Close'
2023-06-01 20:33:57,190: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,191: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,191: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,191: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,191: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,192: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,192: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,192: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,192: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,193: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,193: root: ERROR: 'Close'
2023-06-01 20:33:57,193: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,193: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,194: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,194: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,194: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,194: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,195: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,195: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,195: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,195: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,196: root: ERROR: 'Close'
2023-06-01 20:33:57,196: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,196: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,196: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,196: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,197: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,197: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,197: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,197: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,198: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,198: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,198: root: ERROR: 'Close'
2023-06-01 20:33:57,199: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,199: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,199: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,200: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,200: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,200: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,201: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,201: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,201: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,201: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,202: root: ERROR: 'Close'
2023-06-01 20:33:57,202: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,202: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,203: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,203: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,203: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,204: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,204: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,204: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,204: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,204: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,205: root: ERROR: 'Close'
2023-06-01 20:33:57,205: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,205: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,206: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,206: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,206: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,206: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,207: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,207: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,207: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,207: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,208: root: ERROR: 'Close'
2023-06-01 20:33:57,208: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,208: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,208: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,208: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,209: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,209: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,209: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,209: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,210: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,210: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,210: root: ERROR: 'Close'
2023-06-01 20:33:57,211: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,211: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,211: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,211: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,212: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,212: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,212: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,212: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,213: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,213: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,213: root: ERROR: 'Close'
2023-06-01 20:33:57,213: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,213: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,214: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,214: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,214: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,215: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,215: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,215: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,215: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,216: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,216: root: ERROR: 'Close'
2023-06-01 20:33:57,216: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,216: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,217: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,217: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,217: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,218: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,218: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,218: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,219: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,219: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,219: root: ERROR: 'Close'
2023-06-01 20:33:57,220: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,220: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,220: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,220: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,221: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,221: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,221: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,221: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,222: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,222: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,222: root: ERROR: 'Close'
2023-06-01 20:33:57,223: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,223: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,223: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,223: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,224: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,224: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,224: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,224: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,225: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,225: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,225: root: ERROR: 'Close'
2023-06-01 20:33:57,225: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,226: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,226: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,226: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,226: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,227: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,227: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,227: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,227: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,227: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,228: root: ERROR: 'Close'
2023-06-01 20:33:57,228: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,228: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,229: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,229: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,229: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,229: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,230: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,230: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,230: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,230: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,231: root: ERROR: 'Close'
2023-06-01 20:33:57,231: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,231: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,231: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,231: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,232: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,232: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,232: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,232: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,233: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,233: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,234: root: ERROR: 'Close'
2023-06-01 20:33:57,234: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,234: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,235: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,235: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,235: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,235: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,236: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,236: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,236: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,236: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,237: root: ERROR: 'Close'
2023-06-01 20:33:57,237: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,237: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,237: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,238: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,238: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,238: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,239: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,239: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,239: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,239: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,240: root: ERROR: 'Close'
2023-06-01 20:33:57,240: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,240: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,240: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,240: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,241: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,241: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,241: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,241: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,242: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,242: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,242: root: ERROR: 'Close'
2023-06-01 20:33:57,242: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,243: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,243: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,243: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,243: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,244: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,244: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,244: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,244: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,245: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,245: root: ERROR: 'Close'
2023-06-01 20:33:57,245: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,245: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,246: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,246: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,246: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,246: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,247: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,247: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,247: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,247: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,248: root: ERROR: 'Close'
2023-06-01 20:33:57,248: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,248: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,249: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,249: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,249: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,249: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,250: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,250: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,250: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,250: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,251: root: ERROR: 'Close'
2023-06-01 20:33:57,251: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,251: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,252: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,252: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,253: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,253: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,254: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,254: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,254: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,254: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,255: root: ERROR: 'Close'
2023-06-01 20:33:57,255: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,255: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,256: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,256: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,256: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,256: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,257: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,257: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,257: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,257: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,258: root: ERROR: 'Close'
2023-06-01 20:33:57,258: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,258: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,258: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,258: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,259: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,259: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,259: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,259: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,260: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,260: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,260: root: ERROR: 'Close'
2023-06-01 20:33:57,261: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,261: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,261: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,261: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,261: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,262: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,262: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,262: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,262: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,263: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,263: root: ERROR: 'Close'
2023-06-01 20:33:57,263: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,263: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,264: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,264: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,264: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,265: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,265: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,265: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,266: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,266: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,266: root: ERROR: 'Close'
2023-06-01 20:33:57,266: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,267: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,268: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,268: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,268: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,269: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,269: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,269: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,270: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,270: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,270: root: ERROR: 'Close'
2023-06-01 20:33:57,270: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,271: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,271: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,271: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,271: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,272: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,272: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,272: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,272: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,273: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,273: root: ERROR: 'Close'
2023-06-01 20:33:57,273: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,273: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,274: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,274: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,274: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,274: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,275: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,275: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,275: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,275: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,276: root: ERROR: 'Close'
2023-06-01 20:33:57,276: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,276: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,276: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,276: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,277: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,277: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,277: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,277: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,278: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,278: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,278: root: ERROR: 'Close'
2023-06-01 20:33:57,279: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,279: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,279: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,279: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,280: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,280: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,280: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,280: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,281: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,281: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,281: root: ERROR: 'Close'
2023-06-01 20:33:57,281: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,281: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,282: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,282: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,282: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,283: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,283: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,283: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,284: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,284: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,284: root: ERROR: 'Close'
2023-06-01 20:33:57,285: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,285: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,286: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,286: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,286: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,286: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,287: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,287: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,287: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,287: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,288: root: ERROR: 'Close'
2023-06-01 20:33:57,288: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,288: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,289: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,289: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,289: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,289: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,290: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,290: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,290: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,290: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,291: root: ERROR: 'Close'
2023-06-01 20:33:57,291: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,291: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,291: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,291: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,292: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,292: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,292: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,292: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,293: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,293: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,293: root: ERROR: 'Close'
2023-06-01 20:33:57,294: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,294: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,294: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,294: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,294: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,295: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,295: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,295: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,295: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,296: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,296: root: ERROR: 'Close'
2023-06-01 20:33:57,296: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,296: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,297: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,297: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,297: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,298: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,298: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,298: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,298: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,299: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,299: root: ERROR: 'Close'
2023-06-01 20:33:57,299: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,300: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,300: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,300: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,300: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,301: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,301: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,302: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,302: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,302: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,303: root: ERROR: 'Close'
2023-06-01 20:33:57,303: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,303: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,304: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,304: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,304: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,304: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,305: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,305: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,305: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,305: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,306: root: ERROR: 'Close'
2023-06-01 20:33:57,306: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,306: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,307: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,307: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,307: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,307: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,308: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,308: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,308: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,308: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,309: root: ERROR: 'Close'
2023-06-01 20:33:57,309: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,309: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,309: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,309: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,310: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,310: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,310: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,310: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,311: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,311: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,311: root: ERROR: 'Close'
2023-06-01 20:33:57,312: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,312: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,312: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,312: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,313: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,313: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,313: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,313: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,314: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,314: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,314: root: ERROR: 'Close'
2023-06-01 20:33:57,314: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,314: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,315: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,315: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,316: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,316: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,316: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,316: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,317: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,317: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,317: root: ERROR: 'Close'
2023-06-01 20:33:57,318: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,318: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,318: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,318: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,319: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,319: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,320: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,320: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,321: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,321: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,321: root: ERROR: 'Close'
2023-06-01 20:33:57,322: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,324: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,325: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,325: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,325: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,326: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,326: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,326: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,327: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,327: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,327: root: ERROR: 'Close'
2023-06-01 20:33:57,328: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,328: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,329: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,329: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,330: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,330: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,330: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,331: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,331: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,331: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,332: root: ERROR: 'Close'
2023-06-01 20:33:57,332: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,335: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,336: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,336: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,337: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,337: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,337: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,337: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,338: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,338: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,339: root: ERROR: 'Close'
2023-06-01 20:33:57,339: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,341: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,341: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,342: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,342: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,342: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,343: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,343: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,343: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,343: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,344: root: ERROR: 'Close'
2023-06-01 20:33:57,344: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,345: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,346: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,346: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,346: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,346: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,347: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,347: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,347: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,347: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,348: root: ERROR: 'Close'
2023-06-01 20:33:57,349: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,351: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,352: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,352: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,352: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,353: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,353: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,353: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,354: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,354: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,354: root: ERROR: 'Close'
2023-06-01 20:33:57,355: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,357: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,358: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,358: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,358: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,359: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,359: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,359: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,360: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,360: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,361: root: ERROR: 'Close'
2023-06-01 20:33:57,361: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,362: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,363: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,363: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,363: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,363: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,364: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,364: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,364: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,364: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,365: root: ERROR: 'Close'
2023-06-01 20:33:57,365: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,365: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,366: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,366: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,367: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,367: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,367: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,367: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,368: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,368: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,369: root: ERROR: 'Close'
2023-06-01 20:33:57,369: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,369: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,370: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,370: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,370: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,371: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,372: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,372: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,373: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,373: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,374: root: ERROR: 'Close'
2023-06-01 20:33:57,374: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,374: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,376: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,376: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,376: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,377: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,377: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,377: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,377: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,378: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,378: root: ERROR: 'Close'
2023-06-01 20:33:57,379: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,379: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,379: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,380: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,380: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,380: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,381: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,381: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,381: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,381: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,382: root: ERROR: 'Close'
2023-06-01 20:33:57,382: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,383: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,383: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,384: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,384: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,384: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,385: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,385: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,385: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,386: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,386: root: ERROR: 'Close'
2023-06-01 20:33:57,386: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,386: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,387: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,387: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,387: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,388: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,388: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,388: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,389: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,389: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,389: root: ERROR: 'Close'
2023-06-01 20:33:57,389: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,390: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,390: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,390: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,390: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,391: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,391: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,391: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,391: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,392: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,392: root: ERROR: 'Close'
2023-06-01 20:33:57,392: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,392: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,393: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,393: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,393: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,393: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,394: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,394: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,394: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,394: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,395: root: ERROR: 'Close'
2023-06-01 20:33:57,395: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,395: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,396: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,396: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,396: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,396: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,397: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,397: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,397: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,397: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,398: root: ERROR: 'Close'
2023-06-01 20:33:57,398: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,398: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,398: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,398: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,399: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,399: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,399: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,400: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,400: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,400: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,401: root: ERROR: 'Close'
2023-06-01 20:33:57,401: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,401: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,401: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,401: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,402: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,402: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,403: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,403: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,403: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,403: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,404: root: ERROR: 'Close'
2023-06-01 20:33:57,404: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,404: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,405: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,405: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,405: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,405: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,406: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,406: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,406: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,406: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,407: root: ERROR: 'Close'
2023-06-01 20:33:57,407: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,407: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,408: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,408: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,408: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,408: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,409: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,409: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,409: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,409: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,410: root: ERROR: 'Close'
2023-06-01 20:33:57,410: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,410: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,410: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,410: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,411: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,411: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,411: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,412: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,412: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,412: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,412: root: ERROR: 'Close'
2023-06-01 20:33:57,413: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,413: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,413: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,413: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,414: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,414: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,414: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,414: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,415: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,415: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,415: root: ERROR: 'Close'
2023-06-01 20:33:57,416: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,416: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,416: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,416: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,417: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,417: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,417: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,418: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,418: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,418: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,419: root: ERROR: 'Close'
2023-06-01 20:33:57,419: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,419: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,420: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,420: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,421: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,421: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,422: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,422: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,422: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,422: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,423: root: ERROR: 'Close'
2023-06-01 20:33:57,423: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,423: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,423: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,423: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,424: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,424: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,424: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,424: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,425: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,425: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,425: root: ERROR: 'Close'
2023-06-01 20:33:57,426: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,426: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,426: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,426: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,427: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,427: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,427: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,427: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,428: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,428: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,428: root: ERROR: 'Close'
2023-06-01 20:33:57,428: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,428: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,429: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,429: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,429: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,430: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,430: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,430: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,430: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,430: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,431: root: ERROR: 'Close'
2023-06-01 20:33:57,431: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,431: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,432: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,432: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,432: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,433: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,433: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,433: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,433: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,433: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,434: root: ERROR: 'Close'
2023-06-01 20:33:57,434: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,434: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,435: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,435: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,436: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,436: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,437: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,437: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,437: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,437: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,438: root: ERROR: 'Close'
2023-06-01 20:33:57,438: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,438: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,439: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,439: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,439: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,439: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,440: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,440: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,440: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,440: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,441: root: ERROR: 'Close'
2023-06-01 20:33:57,441: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,441: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,441: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,442: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,442: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,442: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,443: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,443: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,443: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,443: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,444: root: ERROR: 'Close'
2023-06-01 20:33:57,444: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,444: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,444: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,444: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,445: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,445: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,445: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,445: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,446: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,446: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,446: root: ERROR: 'Close'
2023-06-01 20:33:57,446: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,447: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,447: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,447: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,448: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,448: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,448: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,448: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,449: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,449: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,450: root: ERROR: 'Close'
2023-06-01 20:33:57,450: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,450: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,450: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,451: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,451: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,451: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,452: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,452: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,452: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,452: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,453: root: ERROR: 'Close'
2023-06-01 20:33:57,453: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,453: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,454: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,454: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,454: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,454: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,455: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,455: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,455: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,455: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,456: root: ERROR: 'Close'
2023-06-01 20:33:57,456: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,456: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,456: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,456: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,457: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,457: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,457: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,457: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,458: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,458: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,458: root: ERROR: 'Close'
2023-06-01 20:33:57,459: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,459: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,459: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,459: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,460: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,460: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,460: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,460: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,461: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,461: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,461: root: ERROR: 'Close'
2023-06-01 20:33:57,461: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,461: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,462: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,462: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,462: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,463: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,463: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,463: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,463: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,463: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,464: root: ERROR: 'Close'
2023-06-01 20:33:57,464: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,464: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,465: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,465: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,465: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,466: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,466: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,466: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,466: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,467: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,467: root: ERROR: 'Close'
2023-06-01 20:33:57,467: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,467: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,468: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,468: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,468: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,469: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,469: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,469: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,470: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,470: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,471: root: ERROR: 'Close'
2023-06-01 20:33:57,471: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,471: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,472: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,472: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,472: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,472: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,473: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,473: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,473: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,473: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,474: root: ERROR: 'Close'
2023-06-01 20:33:57,474: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,474: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,474: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,474: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,475: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,475: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,475: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,475: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,476: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,476: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,476: root: ERROR: 'Close'
2023-06-01 20:33:57,477: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,477: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,477: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,477: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,478: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,478: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,478: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,478: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,479: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,479: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,479: root: ERROR: 'Close'
2023-06-01 20:33:57,480: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,480: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,480: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,480: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,480: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,481: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,481: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,481: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,482: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,482: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,482: root: ERROR: 'Close'
2023-06-01 20:33:57,482: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,483: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,483: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,483: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,483: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,484: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,484: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,484: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,485: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,485: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,486: root: ERROR: 'Close'
2023-06-01 20:33:57,486: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,486: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,487: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,487: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,487: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,487: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,488: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,488: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,488: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,488: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,489: root: ERROR: 'Close'
2023-06-01 20:33:57,489: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,489: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,490: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,490: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,490: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,490: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,491: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,491: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,491: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,491: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,492: root: ERROR: 'Close'
2023-06-01 20:33:57,492: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,492: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,492: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,493: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,493: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,493: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,494: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,494: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,494: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,494: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,495: root: ERROR: 'Close'
2023-06-01 20:33:57,495: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,495: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,495: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,495: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,496: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,496: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,496: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,496: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,497: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,497: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,497: root: ERROR: 'Close'
2023-06-01 20:33:57,497: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,497: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,498: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,498: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,498: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,499: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,499: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,499: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,499: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,500: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,500: root: ERROR: 'Close'
2023-06-01 20:33:57,500: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,500: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,501: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,501: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,501: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,502: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,502: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,502: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,503: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,503: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,504: root: ERROR: 'Close'
2023-06-01 20:33:57,504: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,504: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,505: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,505: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,505: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,505: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,506: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,506: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,506: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,506: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,507: root: ERROR: 'Close'
2023-06-01 20:33:57,507: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,507: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,507: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,507: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,508: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,508: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,508: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,508: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,509: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,509: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,509: root: ERROR: 'Close'
2023-06-01 20:33:57,510: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,510: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,510: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,510: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,511: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,511: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,511: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,511: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,512: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,512: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,512: root: ERROR: 'Close'
2023-06-01 20:33:57,512: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,512: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,513: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,513: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,513: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,514: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,514: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,514: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,514: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,514: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,515: root: ERROR: 'Close'
2023-06-01 20:33:57,515: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,515: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,516: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,516: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,516: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,517: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,517: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,517: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,517: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,518: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,518: root: ERROR: 'Close'
2023-06-01 20:33:57,519: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,519: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,520: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,520: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,520: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,520: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,521: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,521: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,521: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,521: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,522: root: ERROR: 'Close'
2023-06-01 20:33:57,522: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,522: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,523: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,523: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,523: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,523: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,524: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,524: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,524: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,524: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,525: root: ERROR: 'Close'
2023-06-01 20:33:57,525: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,525: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,525: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,525: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,526: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,526: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,526: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,526: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,527: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,527: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,528: root: ERROR: 'Close'
2023-06-01 20:33:57,528: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,528: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,528: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,528: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,529: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,529: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,529: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,529: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,530: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,530: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,530: root: ERROR: 'Close'
2023-06-01 20:33:57,531: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,531: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,531: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,531: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,532: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,532: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,532: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,532: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,533: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,533: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,534: root: ERROR: 'Close'
2023-06-01 20:33:57,534: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,534: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,534: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,534: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,535: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,535: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,535: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,535: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,536: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,536: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,536: root: ERROR: 'Close'
2023-06-01 20:33:57,537: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,537: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,537: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,537: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,538: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,538: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,538: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,538: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,539: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,539: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,539: root: ERROR: 'Close'
2023-06-01 20:33:57,539: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,540: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,540: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,540: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,540: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,541: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,541: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,541: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,542: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,542: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,542: root: ERROR: 'Close'
2023-06-01 20:33:57,542: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,542: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,543: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,543: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,543: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,544: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,544: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,544: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,544: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,544: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,545: root: ERROR: 'Close'
2023-06-01 20:33:57,545: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,545: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,546: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,546: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,546: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,546: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,547: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,547: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,547: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,547: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,548: root: ERROR: 'Close'
2023-06-01 20:33:57,548: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,548: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,548: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,548: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,549: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,549: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,550: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,550: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,550: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,550: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,551: root: ERROR: 'Close'
2023-06-01 20:33:57,551: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,551: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,551: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,552: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,552: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,552: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,553: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,553: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,554: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,554: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,554: root: ERROR: 'Close'
2023-06-01 20:33:57,555: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,555: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,555: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,555: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,556: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,556: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,556: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,556: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,557: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,557: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,557: root: ERROR: 'Close'
2023-06-01 20:33:57,558: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,558: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,558: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,558: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,558: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,559: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,559: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,559: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,559: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,560: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,560: root: ERROR: 'Close'
2023-06-01 20:33:57,560: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,560: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,561: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,561: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,561: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,561: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,562: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,562: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,562: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,562: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,563: root: ERROR: 'Close'
2023-06-01 20:33:57,563: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,563: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,563: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,563: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,564: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,564: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,565: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,565: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,565: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,565: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,566: root: ERROR: 'Close'
2023-06-01 20:33:57,566: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,566: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,567: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,567: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,567: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,567: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,568: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,568: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,568: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,569: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,569: root: ERROR: 'Close'
2023-06-01 20:33:57,569: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,569: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,570: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,570: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,571: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,571: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,571: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,571: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,572: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,572: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,572: root: ERROR: 'Close'
2023-06-01 20:33:57,573: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,573: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,573: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,573: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,573: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,574: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,574: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,574: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,574: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,575: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,575: root: ERROR: 'Close'
2023-06-01 20:33:57,575: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,575: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,576: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,576: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,576: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,577: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,577: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,577: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,577: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,577: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,578: root: ERROR: 'Close'
2023-06-01 20:33:57,578: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,578: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,579: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,579: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,579: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,579: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,580: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,580: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,580: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,580: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,581: root: ERROR: 'Close'
2023-06-01 20:33:57,581: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,581: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,581: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,581: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,582: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,582: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,583: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,583: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,583: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,583: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,584: root: ERROR: 'Close'
2023-06-01 20:33:57,584: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,584: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,584: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,585: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,585: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,585: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,586: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,586: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,586: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,587: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,587: root: ERROR: 'Close'
2023-06-01 20:33:57,587: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,588: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,588: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,588: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,589: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,589: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,589: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,589: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,590: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,590: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,590: root: ERROR: 'Close'
2023-06-01 20:33:57,590: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,590: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,591: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,591: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,591: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,592: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,592: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,592: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,593: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,593: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,593: root: ERROR: 'Close'
2023-06-01 20:33:57,593: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,593: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,594: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,594: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,594: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,595: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,595: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,595: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,595: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,595: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,596: root: ERROR: 'Close'
2023-06-01 20:33:57,596: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,596: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,597: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,597: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,597: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,597: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,598: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,598: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,598: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,598: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,599: root: ERROR: 'Close'
2023-06-01 20:33:57,599: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,599: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,600: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,600: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,600: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,600: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,601: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,601: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,601: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,601: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,602: root: ERROR: 'Close'
2023-06-01 20:33:57,602: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,603: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,604: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,604: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,604: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,604: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,605: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,605: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,605: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,605: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,606: root: ERROR: 'Close'
2023-06-01 20:33:57,606: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,606: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,607: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,607: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,607: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,607: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,608: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,608: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,608: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,608: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,609: root: ERROR: 'Close'
2023-06-01 20:33:57,609: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,609: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,609: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,610: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,610: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,610: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,611: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,611: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,611: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,611: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,612: root: ERROR: 'Close'
2023-06-01 20:33:57,612: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,612: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,612: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,612: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,613: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,613: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,613: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,613: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,614: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,614: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,614: root: ERROR: 'Close'
2023-06-01 20:33:57,614: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,614: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,615: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,615: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,615: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,616: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,616: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,616: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,617: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,617: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,618: root: ERROR: 'Close'
2023-06-01 20:33:57,618: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,618: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,619: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,619: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,619: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,619: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,620: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,620: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,620: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,620: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,621: root: ERROR: 'Close'
2023-06-01 20:33:57,621: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,621: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,622: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,622: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,622: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,622: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,623: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,623: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,623: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,623: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,624: root: ERROR: 'Close'
2023-06-01 20:33:57,624: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,624: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,624: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,625: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,625: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,625: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,626: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,626: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,626: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,626: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,626: root: ERROR: 'Close'
2023-06-01 20:33:57,627: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,627: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,627: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,627: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,628: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,628: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,628: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,628: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,629: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,629: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,629: root: ERROR: 'Close'
2023-06-01 20:33:57,629: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,629: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,630: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,630: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,630: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,631: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,631: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,631: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,631: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,631: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,632: root: ERROR: 'Close'
2023-06-01 20:33:57,632: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,633: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,634: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,634: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,634: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,635: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,635: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,635: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,636: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,636: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,637: root: ERROR: 'Close'
2023-06-01 20:33:57,637: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,638: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,640: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,640: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,640: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,641: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,641: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,641: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,642: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,642: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,642: root: ERROR: 'Close'
2023-06-01 20:33:57,643: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,644: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,645: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,645: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,646: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,646: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,646: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,646: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,647: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,647: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,647: root: ERROR: 'Close'
2023-06-01 20:33:57,648: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,649: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,650: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,650: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,651: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,651: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,652: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,652: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,652: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,652: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,653: root: ERROR: 'Close'
2023-06-01 20:33:57,653: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,654: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,656: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,656: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,656: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,656: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,657: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,657: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,659: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,659: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,660: root: ERROR: 'Close'
2023-06-01 20:33:57,660: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,661: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,662: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,663: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,663: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,663: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,664: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,664: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,664: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,664: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,673: root: ERROR: 'Close'
2023-06-01 20:33:57,673: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,675: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,675: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,675: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,676: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,676: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,677: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,677: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,677: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,677: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,678: root: ERROR: 'Close'
2023-06-01 20:33:57,678: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,678: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,679: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,679: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,679: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,680: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,680: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,680: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,681: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,681: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,681: root: ERROR: 'Close'
2023-06-01 20:33:57,682: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,684: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,684: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,685: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,685: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,685: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,686: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,686: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,686: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,686: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,687: root: ERROR: 'Close'
2023-06-01 20:33:57,687: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,688: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,689: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,690: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,690: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,690: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,691: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,691: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,691: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,691: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,692: root: ERROR: 'Close'
2023-06-01 20:33:57,692: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,693: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,693: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,693: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,694: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,694: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,694: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,694: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,695: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,695: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,695: root: ERROR: 'Close'
2023-06-01 20:33:57,696: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,696: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,696: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,696: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,697: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,697: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,697: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,697: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,698: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,698: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,698: root: ERROR: 'Close'
2023-06-01 20:33:57,699: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,699: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,699: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,699: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,700: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,700: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,701: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,701: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,701: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,701: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,702: root: ERROR: 'Close'
2023-06-01 20:33:57,702: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,702: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,702: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,703: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,703: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,703: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,704: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,704: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,704: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,704: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,705: root: ERROR: 'Close'
2023-06-01 20:33:57,705: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,705: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,705: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,705: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,706: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,706: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,706: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,706: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,707: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,707: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,707: root: ERROR: 'Close'
2023-06-01 20:33:57,708: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,708: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,708: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,708: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,709: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,709: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,709: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,709: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,709: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,710: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,710: root: ERROR: 'Close'
2023-06-01 20:33:57,710: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,710: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,711: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,711: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,711: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,711: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,712: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,712: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,712: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,713: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,713: root: ERROR: 'Close'
2023-06-01 20:33:57,713: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,714: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,714: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,714: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,715: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,715: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,715: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,716: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,716: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,716: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,717: root: ERROR: 'Close'
2023-06-01 20:33:57,717: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,717: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,718: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,718: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,718: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,718: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,719: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,719: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,719: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,720: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,720: root: ERROR: 'Close'
2023-06-01 20:33:57,721: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,721: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,721: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,721: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,722: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,722: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,722: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,722: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,723: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,723: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,723: root: ERROR: 'Close'
2023-06-01 20:33:57,724: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,724: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,724: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,724: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,725: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,725: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,725: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,725: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,726: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,726: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,726: root: ERROR: 'Close'
2023-06-01 20:33:57,726: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,727: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,727: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,727: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,727: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,728: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,728: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,728: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,728: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,729: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,729: root: ERROR: 'Close'
2023-06-01 20:33:57,729: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,729: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,730: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,730: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,730: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,731: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,731: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,731: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,731: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,732: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,732: root: ERROR: 'Close'
2023-06-01 20:33:57,732: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,732: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,733: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,733: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,733: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,734: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,734: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,734: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,735: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,735: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,736: root: ERROR: 'Close'
2023-06-01 20:33:57,736: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,736: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,736: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,737: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,737: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,737: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,738: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,738: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,738: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,738: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,739: root: ERROR: 'Close'
2023-06-01 20:33:57,739: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,739: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,739: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,739: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,740: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,740: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,740: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,741: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,741: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,741: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,741: root: ERROR: 'Close'
2023-06-01 20:33:57,742: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,742: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,742: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,742: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,743: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,743: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,743: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,743: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,744: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,744: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,744: root: ERROR: 'Close'
2023-06-01 20:33:57,744: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,744: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,745: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,745: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,745: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,745: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,746: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,746: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,746: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,746: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,747: root: ERROR: 'Close'
2023-06-01 20:33:57,747: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,747: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,748: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,748: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,748: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,749: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,749: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,749: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,749: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,750: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,750: root: ERROR: 'Close'
2023-06-01 20:33:57,750: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,750: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,751: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,751: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,752: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,752: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,753: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,753: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,753: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,753: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,754: root: ERROR: 'Close'
2023-06-01 20:33:57,754: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,754: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,755: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,755: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,755: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,755: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,756: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,756: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,756: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,756: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,757: root: ERROR: 'Close'
2023-06-01 20:33:57,757: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,757: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,757: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,757: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,758: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,758: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,759: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,759: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,759: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,759: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,760: root: ERROR: 'Close'
2023-06-01 20:33:57,760: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,760: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,760: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,760: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,761: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,761: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,761: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,761: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,762: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,762: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,762: root: ERROR: 'Close'
2023-06-01 20:33:57,762: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,763: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,763: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,763: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,764: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,764: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,764: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,764: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,765: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,765: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,765: root: ERROR: 'Close'
2023-06-01 20:33:57,765: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,766: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,766: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,766: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,767: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,767: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,767: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,767: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,768: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,768: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,768: root: ERROR: 'Close'
2023-06-01 20:33:57,769: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,769: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,770: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,770: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,770: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,770: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,771: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,771: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,771: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,771: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,772: root: ERROR: 'Close'
2023-06-01 20:33:57,772: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,772: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,773: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,773: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,773: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,773: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,774: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,774: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,774: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,774: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,775: root: ERROR: 'Close'
2023-06-01 20:33:57,775: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,775: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,775: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,776: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,776: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,776: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,776: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,777: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,777: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,777: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,777: root: ERROR: 'Close'
2023-06-01 20:33:57,778: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,778: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,778: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,778: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,779: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,779: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,779: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,779: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,780: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,780: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,780: root: ERROR: 'Close'
2023-06-01 20:33:57,780: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,781: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,781: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,781: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,781: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,782: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,782: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,782: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,782: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,783: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,783: root: ERROR: 'Close'
2023-06-01 20:33:57,783: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,784: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,784: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,784: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,785: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,785: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,785: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,785: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,786: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,786: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,786: root: ERROR: 'Close'
2023-06-01 20:33:57,787: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,787: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,787: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,787: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,788: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,788: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,788: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,788: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,789: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,789: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,789: root: ERROR: 'Close'
2023-06-01 20:33:57,789: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,789: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,790: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,790: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,790: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,790: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,791: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,791: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,791: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,791: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,792: root: ERROR: 'Close'
2023-06-01 20:33:57,792: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,792: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,793: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,793: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,793: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,793: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,794: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,794: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,794: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,794: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,795: root: ERROR: 'Close'
2023-06-01 20:33:57,795: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,795: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,795: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,796: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,796: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,796: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,797: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,797: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,797: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,797: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,797: root: ERROR: 'Close'
2023-06-01 20:33:57,798: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,798: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,798: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,798: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,799: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,799: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,799: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,799: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,800: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,800: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,800: root: ERROR: 'Close'
2023-06-01 20:33:57,801: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,801: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,801: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,801: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,802: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,802: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,803: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,803: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,803: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,803: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,804: root: ERROR: 'Close'
2023-06-01 20:33:57,804: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,804: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,805: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,805: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,805: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,805: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,806: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,806: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,806: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,806: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,807: root: ERROR: 'Close'
2023-06-01 20:33:57,807: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,807: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,807: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,808: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,808: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,808: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,809: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,809: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,809: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,809: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,809: root: ERROR: 'Close'
2023-06-01 20:33:57,810: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,810: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,810: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,810: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,811: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,811: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,811: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,811: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,812: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,812: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,812: root: ERROR: 'Close'
2023-06-01 20:33:57,812: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,813: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,813: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,813: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,813: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,814: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,814: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,814: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,814: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,815: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,815: root: ERROR: 'Close'
2023-06-01 20:33:57,815: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,815: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,816: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,816: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,816: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,817: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,817: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,817: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,817: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,818: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,818: root: ERROR: 'Close'
2023-06-01 20:33:57,819: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,820: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,821: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,821: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,822: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,822: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,823: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,823: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,823: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,823: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,824: root: ERROR: 'Close'
2023-06-01 20:33:57,824: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,824: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,825: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,825: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,826: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,826: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,827: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,827: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,827: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,827: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,828: root: ERROR: 'Close'
2023-06-01 20:33:57,828: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,828: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,829: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,829: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,830: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,830: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,830: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,830: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,831: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,831: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,831: root: ERROR: 'Close'
2023-06-01 20:33:57,832: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,832: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,832: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,833: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,833: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,833: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,835: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,835: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,835: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,835: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,836: root: ERROR: 'Close'
2023-06-01 20:33:57,836: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,836: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,837: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,837: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,837: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,837: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,838: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,838: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,838: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,838: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,839: root: ERROR: 'Close'
2023-06-01 20:33:57,839: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,839: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,840: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,840: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,840: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,840: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,841: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,841: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,841: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,841: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,842: root: ERROR: 'Close'
2023-06-01 20:33:57,842: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,842: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,842: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,842: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,843: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,843: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,843: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,843: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,844: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,844: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,844: root: ERROR: 'Close'
2023-06-01 20:33:57,844: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,845: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,845: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,845: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,845: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,846: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,846: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,846: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,847: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,847: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,847: root: ERROR: 'Close'
2023-06-01 20:33:57,847: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,847: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,848: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,848: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,848: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,849: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,849: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,849: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,849: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,850: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,850: root: ERROR: 'Close'
2023-06-01 20:33:57,850: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,850: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,851: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,851: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,851: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,852: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,852: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,852: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,853: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,853: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,853: root: ERROR: 'Close'
2023-06-01 20:33:57,854: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,854: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,854: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,854: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,855: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,855: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,855: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,856: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,856: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,856: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,856: root: ERROR: 'Close'
2023-06-01 20:33:57,857: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,857: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,857: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,857: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,858: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,858: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,858: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,858: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,859: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,859: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,859: root: ERROR: 'Close'
2023-06-01 20:33:57,859: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,859: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,860: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,860: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,860: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,861: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,861: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,861: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,861: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,861: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,862: root: ERROR: 'Close'
2023-06-01 20:33:57,862: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,862: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,863: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,863: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,863: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,863: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,864: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,864: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,864: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,864: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,865: root: ERROR: 'Close'
2023-06-01 20:33:57,865: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,865: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,866: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,866: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,866: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,866: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,867: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,867: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,867: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,867: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,868: root: ERROR: 'Close'
2023-06-01 20:33:57,868: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,868: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,869: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,869: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,870: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,870: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,870: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,871: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,871: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,871: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,872: root: ERROR: 'Close'
2023-06-01 20:33:57,872: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,872: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,872: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,872: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,873: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,873: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,873: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,873: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,874: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,874: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,874: root: ERROR: 'Close'
2023-06-01 20:33:57,874: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,875: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,875: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,875: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,875: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,876: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,876: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,876: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,876: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,877: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,877: root: ERROR: 'Close'
2023-06-01 20:33:57,877: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,877: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,878: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,878: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,878: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,878: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,879: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,879: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,879: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,879: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,880: root: ERROR: 'Close'
2023-06-01 20:33:57,880: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,880: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,881: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,881: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,881: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,881: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,882: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,882: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,882: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,882: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,883: root: ERROR: 'Close'
2023-06-01 20:33:57,883: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,883: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,883: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,884: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,884: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,884: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,885: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,885: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,885: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,886: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,886: root: ERROR: 'Close'
2023-06-01 20:33:57,886: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,886: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,887: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,887: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,887: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,888: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,888: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,888: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,888: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,889: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,889: root: ERROR: 'Close'
2023-06-01 20:33:57,889: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,889: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,890: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,890: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,890: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,890: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,891: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,891: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,891: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,891: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,892: root: ERROR: 'Close'
2023-06-01 20:33:57,892: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,892: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,893: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,893: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,893: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,893: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,894: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,894: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,894: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,894: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,895: root: ERROR: 'Close'
2023-06-01 20:33:57,895: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,895: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,895: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,895: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,896: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,896: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,896: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,896: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,897: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,897: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,897: root: ERROR: 'Close'
2023-06-01 20:33:57,897: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,897: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,898: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,898: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,898: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,899: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,899: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,899: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,900: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,900: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,900: root: ERROR: 'Close'
2023-06-01 20:33:57,901: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,901: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,901: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,901: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,902: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,902: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,902: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,902: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,903: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,903: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,903: root: ERROR: 'Close'
2023-06-01 20:33:57,903: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,904: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,904: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,904: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,904: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,905: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,905: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,905: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,905: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,906: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,906: root: ERROR: 'Close'
2023-06-01 20:33:57,906: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,906: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,907: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,907: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,907: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,907: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,908: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,908: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,908: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,908: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,909: root: ERROR: 'Close'
2023-06-01 20:33:57,909: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,909: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,909: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,910: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,910: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,910: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,910: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,911: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,911: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,911: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,911: root: ERROR: 'Close'
2023-06-01 20:33:57,912: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,912: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,912: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,912: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,912: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,913: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,913: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,913: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,913: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,914: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,914: root: ERROR: 'Close'
2023-06-01 20:33:57,914: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,914: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,915: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,915: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,915: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,915: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,916: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,916: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,916: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,917: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,917: root: ERROR: 'Close'
2023-06-01 20:33:57,917: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,917: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,918: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,918: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,919: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,919: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,919: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,919: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,920: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,920: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,920: root: ERROR: 'Close'
2023-06-01 20:33:57,920: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,921: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,921: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,921: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,921: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,922: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,922: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,922: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,922: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,922: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,923: root: ERROR: 'Close'
2023-06-01 20:33:57,923: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,923: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,924: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,924: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,924: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,924: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,925: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,925: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,925: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,925: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,926: root: ERROR: 'Close'
2023-06-01 20:33:57,926: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,926: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,926: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,926: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,927: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,927: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,927: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,927: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,928: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,928: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,928: root: ERROR: 'Close'
2023-06-01 20:33:57,928: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,929: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,929: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,929: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,929: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,930: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,930: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,930: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,930: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,931: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,931: root: ERROR: 'Close'
2023-06-01 20:33:57,931: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,931: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,932: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,932: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,932: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,932: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,933: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,933: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,933: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,934: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,934: root: ERROR: 'Close'
2023-06-01 20:33:57,934: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,935: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,935: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,935: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,936: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,936: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,936: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,936: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,937: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,937: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,937: root: ERROR: 'Close'
2023-06-01 20:33:57,937: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,938: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,938: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,938: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,938: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,939: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,939: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,939: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,939: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,940: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,940: root: ERROR: 'Close'
2023-06-01 20:33:57,940: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,940: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,941: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,941: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,941: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,941: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,942: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,942: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,942: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,942: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,943: root: ERROR: 'Close'
2023-06-01 20:33:57,943: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,943: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,944: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,944: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,944: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,944: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,945: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,945: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,945: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,945: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,946: root: ERROR: 'Close'
2023-06-01 20:33:57,946: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,946: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,946: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,946: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,947: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,947: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,947: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,947: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,948: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,948: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,948: root: ERROR: 'Close'
2023-06-01 20:33:57,949: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,949: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,949: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,949: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,950: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,950: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,950: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,950: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,951: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,951: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,952: root: ERROR: 'Close'
2023-06-01 20:33:57,952: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,952: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,954: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,955: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,955: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,955: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,956: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,956: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,956: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,957: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,957: root: ERROR: 'Close'
2023-06-01 20:33:57,957: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,959: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,960: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,960: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,961: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,961: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,962: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,962: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,962: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,962: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,963: root: ERROR: 'Close'
2023-06-01 20:33:57,964: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,964: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,965: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,966: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,966: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,966: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,967: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,967: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,967: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,967: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,968: root: ERROR: 'Close'
2023-06-01 20:33:57,968: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,969: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,972: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,972: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,973: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,973: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,974: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,974: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,974: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,974: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,975: root: ERROR: 'Close'
2023-06-01 20:33:57,975: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,976: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,977: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,977: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,977: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,978: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,978: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,978: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,978: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,978: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,979: root: ERROR: 'Close'
2023-06-01 20:33:57,979: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,980: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,980: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,981: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,981: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,981: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,982: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,982: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,982: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,982: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,983: root: ERROR: 'Close'
2023-06-01 20:33:57,983: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,985: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,987: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,987: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,989: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,989: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,990: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,990: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,990: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,990: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,991: root: ERROR: 'Close'
2023-06-01 20:33:57,991: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,993: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,994: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,994: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,995: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,995: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,996: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,996: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:57,996: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:57,996: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:57,997: root: ERROR: 'Close'
2023-06-01 20:33:57,997: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:57,997: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:57,998: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:57,998: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:57,998: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:57,999: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:57,999: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:57,999: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,000: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,000: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,000: root: ERROR: 'Close'
2023-06-01 20:33:58,001: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,002: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,004: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,004: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,006: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,006: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,007: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,007: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,008: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,008: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,008: root: ERROR: 'Close'
2023-06-01 20:33:58,009: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,009: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,009: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,009: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,010: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,010: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,010: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,010: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,011: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,011: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,012: root: ERROR: 'Close'
2023-06-01 20:33:58,012: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,012: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,013: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,013: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,013: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,014: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,014: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,014: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,015: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,015: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,015: root: ERROR: 'Close'
2023-06-01 20:33:58,015: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,016: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,016: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,016: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,016: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,017: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,017: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,017: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,018: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,018: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,018: root: ERROR: 'Close'
2023-06-01 20:33:58,019: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,019: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,019: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,019: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,020: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,020: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,021: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,021: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,021: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,021: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,022: root: ERROR: 'Close'
2023-06-01 20:33:58,022: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,022: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,022: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,022: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,023: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,023: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,023: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,023: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,024: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,024: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,024: root: ERROR: 'Close'
2023-06-01 20:33:58,024: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,025: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,025: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,025: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,025: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,026: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,026: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,026: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,026: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,026: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,027: root: ERROR: 'Close'
2023-06-01 20:33:58,027: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,027: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,028: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,028: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,028: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,028: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,029: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,029: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,029: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,029: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,030: root: ERROR: 'Close'
2023-06-01 20:33:58,030: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,030: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,030: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,030: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,031: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,031: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,032: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,032: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,032: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,032: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,033: root: ERROR: 'Close'
2023-06-01 20:33:58,033: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,033: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,033: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,034: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,034: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,034: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,035: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,035: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,035: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,035: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,036: root: ERROR: 'Close'
2023-06-01 20:33:58,036: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,036: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,037: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,037: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,037: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,038: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,038: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,038: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,038: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,038: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,039: root: ERROR: 'Close'
2023-06-01 20:33:58,039: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,039: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,040: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,040: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,040: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,040: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,041: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,041: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,041: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,041: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,042: root: ERROR: 'Close'
2023-06-01 20:33:58,042: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,042: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,042: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,042: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,043: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,043: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,043: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,043: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,044: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,044: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,044: root: ERROR: 'Close'
2023-06-01 20:33:58,045: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,045: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,045: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,045: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,045: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,046: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,046: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,046: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,046: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,047: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,047: root: ERROR: 'Close'
2023-06-01 20:33:58,047: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,047: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,048: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,048: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,048: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,048: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,049: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,049: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,050: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,050: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,050: root: ERROR: 'Close'
2023-06-01 20:33:58,050: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,051: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,051: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,051: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,052: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,052: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,052: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,052: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,053: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,053: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,053: root: ERROR: 'Close'
2023-06-01 20:33:58,053: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,054: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,054: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,054: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,054: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,055: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,055: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,055: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,055: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,056: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,056: root: ERROR: 'Close'
2023-06-01 20:33:58,056: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,056: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,057: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,057: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,057: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,057: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,058: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,058: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,058: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,058: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,059: root: ERROR: 'Close'
2023-06-01 20:33:58,059: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,059: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,060: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,060: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,060: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,060: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,061: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,061: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,061: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,061: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,062: root: ERROR: 'Close'
2023-06-01 20:33:58,062: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,062: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,062: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,062: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,063: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,063: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,063: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,063: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,064: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,064: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,065: root: ERROR: 'Close'
2023-06-01 20:33:58,065: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,065: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,065: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,065: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,066: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,066: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,066: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,066: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,067: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,067: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,067: root: ERROR: 'Close'
2023-06-01 20:33:58,068: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,068: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,068: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,068: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,069: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,069: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,070: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,070: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,070: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,070: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,071: root: ERROR: 'Close'
2023-06-01 20:33:58,071: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,071: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,072: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,072: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,072: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,073: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,073: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,073: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,073: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,074: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,074: root: ERROR: 'Close'
2023-06-01 20:33:58,074: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,074: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,075: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,075: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,075: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,075: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,076: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,076: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,076: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,076: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,077: root: ERROR: 'Close'
2023-06-01 20:33:58,077: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,077: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,077: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,077: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,078: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,078: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,078: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,078: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,079: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,079: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,079: root: ERROR: 'Close'
2023-06-01 20:33:58,080: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,080: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,080: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,080: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,081: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,081: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,081: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,081: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,082: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,082: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,082: root: ERROR: 'Close'
2023-06-01 20:33:58,082: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,083: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,083: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,083: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,084: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,084: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,084: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,084: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,085: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,085: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,086: root: ERROR: 'Close'
2023-06-01 20:33:58,086: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,086: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,087: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,087: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,087: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,087: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,088: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,088: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,088: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,088: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,089: root: ERROR: 'Close'
2023-06-01 20:33:58,089: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,089: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,090: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,090: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,090: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,090: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,091: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,091: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,091: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,091: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,092: root: ERROR: 'Close'
2023-06-01 20:33:58,092: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,092: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,092: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,092: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,093: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,093: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,093: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,093: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,094: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,094: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,094: root: ERROR: 'Close'
2023-06-01 20:33:58,095: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,095: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,095: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,095: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,095: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,096: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,096: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,096: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,097: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,097: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,097: root: ERROR: 'Close'
2023-06-01 20:33:58,097: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,097: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,098: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,098: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,098: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,099: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,099: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,099: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,100: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,100: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,100: root: ERROR: 'Close'
2023-06-01 20:33:58,100: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,100: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,101: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,101: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,102: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,102: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,102: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,102: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,103: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,103: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,104: root: ERROR: 'Close'
2023-06-01 20:33:58,104: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,104: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,104: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,104: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,105: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,105: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,105: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,105: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,106: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,106: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,106: root: ERROR: 'Close'
2023-06-01 20:33:58,107: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,107: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,107: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,107: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,108: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,108: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,108: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,108: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,109: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,109: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,109: root: ERROR: 'Close'
2023-06-01 20:33:58,109: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,109: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,110: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,110: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,110: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,111: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,111: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,111: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,111: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,111: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,112: root: ERROR: 'Close'
2023-06-01 20:33:58,112: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,112: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,113: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,113: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,113: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,113: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,114: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,114: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,114: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,114: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,115: root: ERROR: 'Close'
2023-06-01 20:33:58,115: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,115: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,116: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,116: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,116: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,116: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,117: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,117: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,117: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,118: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,118: root: ERROR: 'Close'
2023-06-01 20:33:58,119: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,119: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,120: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,120: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,120: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,120: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,121: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,121: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,121: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,121: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,122: root: ERROR: 'Close'
2023-06-01 20:33:58,122: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,122: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,122: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,123: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,123: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,123: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,124: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,124: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,124: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,124: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,125: root: ERROR: 'Close'
2023-06-01 20:33:58,125: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,125: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,125: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,125: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,126: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,126: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,126: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,126: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,127: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,127: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,127: root: ERROR: 'Close'
2023-06-01 20:33:58,128: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,128: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,128: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,128: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,129: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,129: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,129: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,129: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,129: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,130: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,130: root: ERROR: 'Close'
2023-06-01 20:33:58,130: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,130: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,131: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,131: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,131: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,132: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,132: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,132: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,132: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,133: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,133: root: ERROR: 'Close'
2023-06-01 20:33:58,133: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,133: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,134: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,134: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,134: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,135: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,135: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,135: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,136: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,136: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,137: root: ERROR: 'Close'
2023-06-01 20:33:58,137: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,137: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,137: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,137: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,138: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,138: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,138: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,138: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,139: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,139: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,139: root: ERROR: 'Close'
2023-06-01 20:33:58,140: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,140: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,140: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,140: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,141: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,141: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,141: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,141: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,142: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,142: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,142: root: ERROR: 'Close'
2023-06-01 20:33:58,142: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,142: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,143: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,143: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,143: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,144: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,144: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,144: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,144: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,144: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,145: root: ERROR: 'Close'
2023-06-01 20:33:58,145: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,145: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,146: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,146: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,146: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,146: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,147: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,147: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,147: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,147: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,148: root: ERROR: 'Close'
2023-06-01 20:33:58,148: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,148: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,148: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,148: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,149: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,149: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,149: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,150: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,150: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,150: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,151: root: ERROR: 'Close'
2023-06-01 20:33:58,151: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,151: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,152: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,152: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,152: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,152: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,153: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,153: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,153: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,153: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,154: root: ERROR: 'Close'
2023-06-01 20:33:58,154: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,154: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,155: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,155: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,155: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,155: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,156: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,156: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,156: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,156: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,157: root: ERROR: 'Close'
2023-06-01 20:33:58,157: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,157: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,157: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,157: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,158: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,158: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,158: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,158: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,159: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,159: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,159: root: ERROR: 'Close'
2023-06-01 20:33:58,159: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,159: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,160: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,160: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,160: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,161: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,161: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,161: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,161: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,161: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,162: root: ERROR: 'Close'
2023-06-01 20:33:58,162: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,162: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,163: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,163: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,163: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,163: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,164: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,164: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,164: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,164: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,165: root: ERROR: 'Close'
2023-06-01 20:33:58,165: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,165: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,165: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,166: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,166: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,166: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,167: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,167: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,167: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,167: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,168: root: ERROR: 'Close'
2023-06-01 20:33:58,168: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,168: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,169: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,169: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,170: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,170: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,171: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,171: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,171: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,171: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,172: root: ERROR: 'Close'
2023-06-01 20:33:58,172: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,172: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,172: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,173: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,173: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,173: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,174: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,174: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,174: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,174: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,175: root: ERROR: 'Close'
2023-06-01 20:33:58,175: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,175: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,175: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,175: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,176: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,176: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,176: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,176: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,177: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,177: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,177: root: ERROR: 'Close'
2023-06-01 20:33:58,177: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,177: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,178: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,178: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,178: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,178: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,179: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,179: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,179: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,179: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,180: root: ERROR: 'Close'
2023-06-01 20:33:58,180: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,180: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,180: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,180: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,181: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,181: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,181: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,181: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,182: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,182: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,183: root: ERROR: 'Close'
2023-06-01 20:33:58,183: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,183: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,184: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,184: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,184: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,185: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,185: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,185: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,185: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,185: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,186: root: ERROR: 'Close'
2023-06-01 20:33:58,186: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,186: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,187: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,187: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,187: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,188: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,188: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,188: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,188: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,188: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,189: root: ERROR: 'Close'
2023-06-01 20:33:58,189: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,189: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,190: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,190: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,190: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,190: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,191: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,191: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,191: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,191: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,192: root: ERROR: 'Close'
2023-06-01 20:33:58,192: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,192: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,192: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,192: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,193: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,193: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,193: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,193: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,194: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,194: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,194: root: ERROR: 'Close'
2023-06-01 20:33:58,195: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,195: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,195: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,195: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,195: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,196: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,196: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,196: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,196: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,197: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,197: root: ERROR: 'Close'
2023-06-01 20:33:58,197: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,197: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,198: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,198: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,198: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,198: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,199: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,199: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,199: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,199: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,200: root: ERROR: 'Close'
2023-06-01 20:33:58,200: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,200: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,200: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,201: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,201: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,201: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,202: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,202: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,202: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,202: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,203: root: ERROR: 'Close'
2023-06-01 20:33:58,203: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,203: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,204: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,204: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,205: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,205: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,205: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,205: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,206: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,206: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,206: root: ERROR: 'Close'
2023-06-01 20:33:58,206: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,207: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,207: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,207: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,207: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,208: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,208: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,208: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,208: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,209: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,209: root: ERROR: 'Close'
2023-06-01 20:33:58,209: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,209: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,210: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,210: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,210: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,211: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,211: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,211: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,211: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,211: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,212: root: ERROR: 'Close'
2023-06-01 20:33:58,212: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,212: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,213: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,213: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,213: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,213: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,213: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,214: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,214: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,214: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,214: root: ERROR: 'Close'
2023-06-01 20:33:58,215: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,215: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,215: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,215: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,216: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,216: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,216: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,216: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,217: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,217: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,218: root: ERROR: 'Close'
2023-06-01 20:33:58,218: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,218: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,219: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,219: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,219: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,219: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,220: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,220: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,220: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,220: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,221: root: ERROR: 'Close'
2023-06-01 20:33:58,221: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,221: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,222: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,222: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,222: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,222: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,223: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,223: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,223: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,223: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,224: root: ERROR: 'Close'
2023-06-01 20:33:58,224: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,224: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,224: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,224: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,225: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,225: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,225: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,225: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,226: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,226: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,226: root: ERROR: 'Close'
2023-06-01 20:33:58,226: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,227: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,227: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,227: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,227: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,228: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,228: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,228: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,228: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,228: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,229: root: ERROR: 'Close'
2023-06-01 20:33:58,229: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,229: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,230: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,230: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,230: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,230: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,231: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,231: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,231: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,231: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,232: root: ERROR: 'Close'
2023-06-01 20:33:58,232: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,232: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,233: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,233: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,233: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,233: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,234: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,234: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,234: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,234: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,235: root: ERROR: 'Close'
2023-06-01 20:33:58,235: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,235: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,236: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,236: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,237: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,237: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,237: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,237: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,238: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,238: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,238: root: ERROR: 'Close'
2023-06-01 20:33:58,239: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,239: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,239: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,239: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,240: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,240: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,240: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,240: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,241: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,241: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,241: root: ERROR: 'Close'
2023-06-01 20:33:58,241: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,242: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,242: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,242: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,242: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,243: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,243: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,243: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,243: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,243: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,244: root: ERROR: 'Close'
2023-06-01 20:33:58,244: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,244: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,245: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,245: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,245: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,245: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,246: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,246: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,246: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,246: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,247: root: ERROR: 'Close'
2023-06-01 20:33:58,247: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,247: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,247: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,247: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,248: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,248: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,248: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,248: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,249: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,249: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,249: root: ERROR: 'Close'
2023-06-01 20:33:58,250: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,250: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,251: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,251: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,252: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,252: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,252: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,252: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,253: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,253: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,253: root: ERROR: 'Close'
2023-06-01 20:33:58,253: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,254: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,254: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,254: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,255: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,255: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,255: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,256: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,256: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,256: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,257: root: ERROR: 'Close'
2023-06-01 20:33:58,257: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,258: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,258: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,258: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,260: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,260: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,261: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,261: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,261: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,261: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,262: root: ERROR: 'Close'
2023-06-01 20:33:58,262: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,264: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,264: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,264: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,265: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,265: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,266: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,266: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,266: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,266: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,267: root: ERROR: 'Close'
2023-06-01 20:33:58,267: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,269: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,270: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,270: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,271: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,271: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,271: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,271: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,272: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,272: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,273: root: ERROR: 'Close'
2023-06-01 20:33:58,273: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,273: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,274: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,274: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,275: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,275: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,276: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,276: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,276: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,276: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,277: root: ERROR: 'Close'
2023-06-01 20:33:58,277: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,278: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,278: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,279: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,279: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,279: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,280: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,280: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,280: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,280: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,281: root: ERROR: 'Close'
2023-06-01 20:33:58,281: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,282: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,284: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,284: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,285: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,285: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,285: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,285: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,286: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,286: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,287: root: ERROR: 'Close'
2023-06-01 20:33:58,287: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,293: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,293: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,293: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,294: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,294: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,295: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,295: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,295: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,295: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,296: root: ERROR: 'Close'
2023-06-01 20:33:58,296: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,298: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,299: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,299: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,299: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,300: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,300: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,300: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,301: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,301: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,301: root: ERROR: 'Close'
2023-06-01 20:33:58,302: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,302: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,303: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,303: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,304: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,304: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,305: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,305: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,305: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,305: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,306: root: ERROR: 'Close'
2023-06-01 20:33:58,306: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,306: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,307: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,307: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,307: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,308: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,308: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,308: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,309: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,309: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,309: root: ERROR: 'Close'
2023-06-01 20:33:58,310: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,310: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,311: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,312: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,312: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,312: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,313: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,313: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,313: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,313: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,314: root: ERROR: 'Close'
2023-06-01 20:33:58,314: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,315: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,316: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,316: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,318: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,319: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,319: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,319: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,320: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,320: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,321: root: ERROR: 'Close'
2023-06-01 20:33:58,321: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,321: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,322: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,322: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,323: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,323: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,323: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,323: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,324: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,324: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,324: root: ERROR: 'Close'
2023-06-01 20:33:58,324: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,325: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,325: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,325: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,325: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,326: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,326: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,326: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,326: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,327: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,327: root: ERROR: 'Close'
2023-06-01 20:33:58,327: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,327: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,328: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,328: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,328: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,328: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,329: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,329: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,329: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,329: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,330: root: ERROR: 'Close'
2023-06-01 20:33:58,330: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,330: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,330: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,331: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,331: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,331: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,332: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,332: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,332: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,332: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,333: root: ERROR: 'Close'
2023-06-01 20:33:58,333: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,333: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,334: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,334: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,334: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,335: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,335: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,335: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,336: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,336: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,336: root: ERROR: 'Close'
2023-06-01 20:33:58,336: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,337: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,337: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,337: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,337: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,338: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,338: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,338: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,339: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,339: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,339: root: ERROR: 'Close'
2023-06-01 20:33:58,339: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,339: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,340: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,340: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,340: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,341: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,341: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,341: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,341: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,341: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,342: root: ERROR: 'Close'
2023-06-01 20:33:58,342: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,342: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,343: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,343: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,343: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,343: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,344: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,344: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,344: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,344: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,345: root: ERROR: 'Close'
2023-06-01 20:33:58,345: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,345: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,345: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,346: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,346: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,346: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,346: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,347: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,347: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,347: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,348: root: ERROR: 'Close'
2023-06-01 20:33:58,348: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,348: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,349: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,349: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,349: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,349: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,350: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,350: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,350: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,350: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,351: root: ERROR: 'Close'
2023-06-01 20:33:58,351: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,352: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,352: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,352: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,353: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,353: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,353: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,353: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,354: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,354: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,354: root: ERROR: 'Close'
2023-06-01 20:33:58,355: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,355: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,355: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,355: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,356: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,356: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,356: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,356: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,357: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,357: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,357: root: ERROR: 'Close'
2023-06-01 20:33:58,357: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,358: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,358: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,358: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,358: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,359: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,359: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,359: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,359: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,359: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,360: root: ERROR: 'Close'
2023-06-01 20:33:58,360: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,360: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,361: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,361: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,361: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,361: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,362: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,362: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,362: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,362: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,363: root: ERROR: 'Close'
2023-06-01 20:33:58,363: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,363: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,363: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,363: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,364: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,364: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,364: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,364: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,365: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,365: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,365: root: ERROR: 'Close'
2023-06-01 20:33:58,366: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,366: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,367: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,367: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,367: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,367: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,368: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,368: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,368: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,368: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,369: root: ERROR: 'Close'
2023-06-01 20:33:58,369: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,369: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,370: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,370: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,370: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,370: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,371: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,371: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,371: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,371: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,372: root: ERROR: 'Close'
2023-06-01 20:33:58,372: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,372: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,372: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,373: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,373: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,373: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,374: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,374: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,374: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,374: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,375: root: ERROR: 'Close'
2023-06-01 20:33:58,375: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,375: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,375: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,375: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,376: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,376: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,376: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,377: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,377: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,377: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,377: root: ERROR: 'Close'
2023-06-01 20:33:58,378: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,378: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,378: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,378: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,379: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,379: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,379: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,379: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,380: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,380: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,380: root: ERROR: 'Close'
2023-06-01 20:33:58,380: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,380: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,381: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,381: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,381: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,382: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,382: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,382: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,383: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,383: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,383: root: ERROR: 'Close'
2023-06-01 20:33:58,383: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,383: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,384: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,384: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,384: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,385: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,385: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,385: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,386: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,386: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,386: root: ERROR: 'Close'
2023-06-01 20:33:58,387: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,387: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,387: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,387: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,388: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,388: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,388: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,389: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,389: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,389: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,389: root: ERROR: 'Close'
2023-06-01 20:33:58,390: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,390: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,390: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,390: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,391: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,391: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,391: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,391: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,392: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,392: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,392: root: ERROR: 'Close'
2023-06-01 20:33:58,392: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,393: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,393: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,393: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,393: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,394: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,394: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,394: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,394: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,394: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,395: root: ERROR: 'Close'
2023-06-01 20:33:58,395: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,395: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,396: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,396: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,396: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,396: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,397: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,397: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,397: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,397: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,398: root: ERROR: 'Close'
2023-06-01 20:33:58,398: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,398: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,399: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,399: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,399: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,399: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,400: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,400: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,400: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,401: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,401: root: ERROR: 'Close'
2023-06-01 20:33:58,401: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,402: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,402: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,402: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,403: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,403: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,403: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,404: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,404: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,404: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,404: root: ERROR: 'Close'
2023-06-01 20:33:58,405: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,405: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,405: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,405: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,406: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,406: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,406: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,406: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,407: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,407: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,407: root: ERROR: 'Close'
2023-06-01 20:33:58,408: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,408: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,408: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,408: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,409: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,409: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,409: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,409: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,410: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,410: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,410: root: ERROR: 'Close'
2023-06-01 20:33:58,410: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,410: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,411: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,411: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,411: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,412: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,412: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,412: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,412: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,412: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,413: root: ERROR: 'Close'
2023-06-01 20:33:58,413: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,413: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,414: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,414: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,414: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,414: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,415: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,415: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,415: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,415: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,416: root: ERROR: 'Close'
2023-06-01 20:33:58,416: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,416: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,417: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,417: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,418: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,418: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,418: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,418: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,419: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,419: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,419: root: ERROR: 'Close'
2023-06-01 20:33:58,419: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,420: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,420: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,420: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,421: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,421: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,421: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,421: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,422: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,422: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,422: root: ERROR: 'Close'
2023-06-01 20:33:58,422: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,422: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,423: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,423: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,423: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,423: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,424: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,424: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,424: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,424: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,425: root: ERROR: 'Close'
2023-06-01 20:33:58,425: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,425: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,426: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,426: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,426: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,426: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,427: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,427: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,427: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,427: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,428: root: ERROR: 'Close'
2023-06-01 20:33:58,428: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,428: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,428: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,428: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,429: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,429: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,429: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,429: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,430: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,430: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,430: root: ERROR: 'Close'
2023-06-01 20:33:58,431: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,431: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,431: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,431: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,432: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,432: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,432: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,432: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,433: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,433: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,433: root: ERROR: 'Close'
2023-06-01 20:33:58,434: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,434: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,434: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,434: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,435: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,435: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,436: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,436: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,436: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,436: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,437: root: ERROR: 'Close'
2023-06-01 20:33:58,437: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,437: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,438: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,438: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,438: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,438: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,439: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,439: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,439: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,439: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,440: root: ERROR: 'Close'
2023-06-01 20:33:58,440: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,440: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,441: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,441: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,441: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,441: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,442: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,442: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,442: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,442: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,443: root: ERROR: 'Close'
2023-06-01 20:33:58,443: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,443: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,443: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,443: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,444: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,444: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,444: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,445: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,445: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,445: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,445: root: ERROR: 'Close'
2023-06-01 20:33:58,446: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,446: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,446: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,446: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,447: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,447: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,447: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,447: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,448: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,448: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,448: root: ERROR: 'Close'
2023-06-01 20:33:58,448: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,448: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,449: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,449: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,449: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,450: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,450: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,450: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,451: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,451: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,451: root: ERROR: 'Close'
2023-06-01 20:33:58,451: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,452: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,452: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,452: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,453: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,454: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,454: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,454: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,455: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,455: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,455: root: ERROR: 'Close'
2023-06-01 20:33:58,456: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,456: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,456: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,456: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,457: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,457: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,457: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,457: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,458: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,458: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,458: root: ERROR: 'Close'
2023-06-01 20:33:58,459: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,459: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,459: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,459: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,459: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,460: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,460: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,460: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,460: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,461: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,461: root: ERROR: 'Close'
2023-06-01 20:33:58,461: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,461: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,462: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,462: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,462: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,462: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,463: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,463: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,463: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,463: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,464: root: ERROR: 'Close'
2023-06-01 20:33:58,464: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,464: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,465: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,465: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,465: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,465: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,466: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,466: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,466: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,466: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,467: root: ERROR: 'Close'
2023-06-01 20:33:58,467: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,467: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,468: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,468: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,468: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,468: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,469: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,469: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,470: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,470: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,471: root: ERROR: 'Close'
2023-06-01 20:33:58,471: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,471: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,472: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,472: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,472: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,473: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,473: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,473: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,474: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,474: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,474: root: ERROR: 'Close'
2023-06-01 20:33:58,475: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,475: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,475: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,475: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,476: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,476: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,476: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,476: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,477: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,477: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,477: root: ERROR: 'Close'
2023-06-01 20:33:58,478: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,478: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,478: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,478: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,478: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,479: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,479: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,479: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,479: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,480: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,480: root: ERROR: 'Close'
2023-06-01 20:33:58,480: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,480: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,481: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,481: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,481: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,482: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,482: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,482: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,482: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,483: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,483: root: ERROR: 'Close'
2023-06-01 20:33:58,483: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,483: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,484: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,484: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,485: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,485: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,485: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,485: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,486: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,486: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,487: root: ERROR: 'Close'
2023-06-01 20:33:58,487: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,487: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,487: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,488: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,488: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,488: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,489: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,489: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,489: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,489: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,490: root: ERROR: 'Close'
2023-06-01 20:33:58,490: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,490: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,490: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,491: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,491: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,491: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,492: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,492: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,492: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,492: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,492: root: ERROR: 'Close'
2023-06-01 20:33:58,493: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,493: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,493: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,493: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,494: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,494: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,494: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,494: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,495: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,495: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,495: root: ERROR: 'Close'
2023-06-01 20:33:58,495: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,495: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,496: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,496: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,496: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,497: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,497: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,497: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,497: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,497: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,498: root: ERROR: 'Close'
2023-06-01 20:33:58,498: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,498: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,499: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,499: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,499: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,499: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,500: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,500: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,500: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,500: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,501: root: ERROR: 'Close'
2023-06-01 20:33:58,501: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,501: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,502: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,502: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,502: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,503: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,503: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,503: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,504: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,504: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,505: root: ERROR: 'Close'
2023-06-01 20:33:58,505: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,506: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,507: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,507: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,508: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,508: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,509: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,509: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,509: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,509: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,510: root: ERROR: 'Close'
2023-06-01 20:33:58,510: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,510: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,512: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,512: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,513: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,513: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,514: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,514: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,514: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,514: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,515: root: ERROR: 'Close'
2023-06-01 20:33:58,515: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,520: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,521: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,521: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,521: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,522: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,522: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,522: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,523: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,523: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,523: root: ERROR: 'Close'
2023-06-01 20:33:58,524: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,524: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,525: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,525: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,525: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,526: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,526: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,526: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,526: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,526: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,527: root: ERROR: 'Close'
2023-06-01 20:33:58,527: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,530: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,532: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,532: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,532: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,533: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,533: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,533: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,533: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,534: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,534: root: ERROR: 'Close'
2023-06-01 20:33:58,534: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,537: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,539: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,539: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,540: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,540: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,541: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,541: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,541: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,541: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,542: root: ERROR: 'Close'
2023-06-01 20:33:58,542: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,547: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,548: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,548: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,548: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,548: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,549: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,549: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,549: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,549: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,550: root: ERROR: 'Close'
2023-06-01 20:33:58,550: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,550: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,551: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,551: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,552: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,552: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,553: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,553: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,553: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,553: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,554: root: ERROR: 'Close'
2023-06-01 20:33:58,554: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,554: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,555: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,555: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,556: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,556: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,556: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,556: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,557: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,557: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,558: root: ERROR: 'Close'
2023-06-01 20:33:58,558: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,558: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,561: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,561: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,561: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,561: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,562: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,562: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,562: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,563: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,563: root: ERROR: 'Close'
2023-06-01 20:33:58,563: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,564: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,564: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,564: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,565: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,565: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,565: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,565: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,566: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,566: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,567: root: ERROR: 'Close'
2023-06-01 20:33:58,567: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,567: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,568: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,568: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,568: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,569: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,569: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,569: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,570: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,570: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,570: root: ERROR: 'Close'
2023-06-01 20:33:58,571: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,571: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,571: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,571: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,572: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,572: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,573: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,573: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,573: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,573: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,574: root: ERROR: 'Close'
2023-06-01 20:33:58,574: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,574: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,575: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,575: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,575: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,576: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,576: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,576: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,577: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,577: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,577: root: ERROR: 'Close'
2023-06-01 20:33:58,577: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,577: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,578: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,578: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,578: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,579: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,579: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,579: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,579: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,580: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,580: root: ERROR: 'Close'
2023-06-01 20:33:58,580: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,580: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,581: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,581: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,581: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,582: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,582: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,582: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,583: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,583: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,583: root: ERROR: 'Close'
2023-06-01 20:33:58,584: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,584: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,584: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,584: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,585: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,585: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,586: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,586: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,586: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,586: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,587: root: ERROR: 'Close'
2023-06-01 20:33:58,587: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,587: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,588: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,588: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,588: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,588: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,589: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,589: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,589: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,589: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,590: root: ERROR: 'Close'
2023-06-01 20:33:58,590: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,590: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,590: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,590: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,591: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,591: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,592: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,592: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,592: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,592: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,593: root: ERROR: 'Close'
2023-06-01 20:33:58,593: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,593: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,593: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,593: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,594: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,594: root: INFO: FreshTrading : Executing the before_market_opens lifecycle method
2023-06-01 20:33:58,594: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,594: root: INFO: FreshTrading : Executing the before_starting_trading lifecycle method
2023-06-01 20:33:58,595: root: INFO: FreshTrading : Executing the on_trading_iteration lifecycle method
2023-06-01 20:33:58,595: root: INFO: Getting historical prices for AAPL, 100 bars, day
2023-06-01 20:33:58,595: root: ERROR: 'Close'
2023-06-01 20:33:58,596: root: ERROR: Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 570, in run
    self._run_trading_session()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 538, in _run_trading_session
    self._on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 261, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 285, in func_output
    result = func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 69, in func_output
    return func_input(self, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/strategies/strategy_executor.py", line 339, in _on_trading_iteration
    on_trading_iteration()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 62, in func_output
    frame, result = call_function_get_frame(func_input, *args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/lumibot/tools/decorators.py", line 30, in call_function_get_frame
    result = func(*args, **kwargs)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 126, in on_trading_iteration
    self.FreshStrategy()
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/trading/trading_algo.py", line 163, in FreshStrategy
    current_price = df['Close'][-1:].tolist()[0]
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/frame.py", line 3807, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/MattyFresh/Documents/FreshProjects/FreshBot/venv/lib/python3.9/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
    raise KeyError(key) from err
KeyError: 'Close'

2023-06-01 20:33:58,596: root: INFO: FreshTrading : Executing the on_bot_crash event method
2023-06-01 20:33:58,596: root: INFO: FreshTrading : [34mSleeping for 60 seconds[0m
2023-06-01 20:33:58,596: root: INFO: Current backtesting datetime 2020-01-02 09:31:00-05:00
2023-06-01 20:33:58,597: root: INFO: Current backtesting datetime 2020-01-02 08:31:00-05:00
2023-06-01 20:33:58,597: root: INFO: FreshTrading : Executing the on_abrupt_closing event method
2023-06-01 20:33:58,597: root: INFO: Trading finished
2023-06-01 20:33:58,598: root: INFO: Current backtesting datetime 2020-01-02 09:30:00-05:00
2023-06-01 20:33:58,599: root: INFO: Current backtesting datetime 2020-01-02 15:55:00-05:00
2023-06-01 20:33:58,599: root: INFO: Current backtesting datetime 2020-01-02 16:00:00-05:00
2023-06-01 20:33:58,599: backtest_stats: INFO: Backtest took 0:00:03.063643 for a speed of 0.000
2023-06-01 20:33:58,600: root: WARNING: Cannot plot returns because the strategy returns are missing
2023-06-01 20:33:58,600: root: WARNING: Cannot create a tearsheet because the strategy returns are missing
